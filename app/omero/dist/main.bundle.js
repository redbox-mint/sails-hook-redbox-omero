webpackJsonp(["main"],{

/***/ "./node_modules/moment/locale recursive ^\\.\\/.*$":
/***/ (function(module, exports, __webpack_require__) {

var map = {
	"./af": "./node_modules/moment/locale/af.js",
	"./af.js": "./node_modules/moment/locale/af.js",
	"./ar": "./node_modules/moment/locale/ar.js",
	"./ar-dz": "./node_modules/moment/locale/ar-dz.js",
	"./ar-dz.js": "./node_modules/moment/locale/ar-dz.js",
	"./ar-kw": "./node_modules/moment/locale/ar-kw.js",
	"./ar-kw.js": "./node_modules/moment/locale/ar-kw.js",
	"./ar-ly": "./node_modules/moment/locale/ar-ly.js",
	"./ar-ly.js": "./node_modules/moment/locale/ar-ly.js",
	"./ar-ma": "./node_modules/moment/locale/ar-ma.js",
	"./ar-ma.js": "./node_modules/moment/locale/ar-ma.js",
	"./ar-sa": "./node_modules/moment/locale/ar-sa.js",
	"./ar-sa.js": "./node_modules/moment/locale/ar-sa.js",
	"./ar-tn": "./node_modules/moment/locale/ar-tn.js",
	"./ar-tn.js": "./node_modules/moment/locale/ar-tn.js",
	"./ar.js": "./node_modules/moment/locale/ar.js",
	"./az": "./node_modules/moment/locale/az.js",
	"./az.js": "./node_modules/moment/locale/az.js",
	"./be": "./node_modules/moment/locale/be.js",
	"./be.js": "./node_modules/moment/locale/be.js",
	"./bg": "./node_modules/moment/locale/bg.js",
	"./bg.js": "./node_modules/moment/locale/bg.js",
	"./bm": "./node_modules/moment/locale/bm.js",
	"./bm.js": "./node_modules/moment/locale/bm.js",
	"./bn": "./node_modules/moment/locale/bn.js",
	"./bn.js": "./node_modules/moment/locale/bn.js",
	"./bo": "./node_modules/moment/locale/bo.js",
	"./bo.js": "./node_modules/moment/locale/bo.js",
	"./br": "./node_modules/moment/locale/br.js",
	"./br.js": "./node_modules/moment/locale/br.js",
	"./bs": "./node_modules/moment/locale/bs.js",
	"./bs.js": "./node_modules/moment/locale/bs.js",
	"./ca": "./node_modules/moment/locale/ca.js",
	"./ca.js": "./node_modules/moment/locale/ca.js",
	"./cs": "./node_modules/moment/locale/cs.js",
	"./cs.js": "./node_modules/moment/locale/cs.js",
	"./cv": "./node_modules/moment/locale/cv.js",
	"./cv.js": "./node_modules/moment/locale/cv.js",
	"./cy": "./node_modules/moment/locale/cy.js",
	"./cy.js": "./node_modules/moment/locale/cy.js",
	"./da": "./node_modules/moment/locale/da.js",
	"./da.js": "./node_modules/moment/locale/da.js",
	"./de": "./node_modules/moment/locale/de.js",
	"./de-at": "./node_modules/moment/locale/de-at.js",
	"./de-at.js": "./node_modules/moment/locale/de-at.js",
	"./de-ch": "./node_modules/moment/locale/de-ch.js",
	"./de-ch.js": "./node_modules/moment/locale/de-ch.js",
	"./de.js": "./node_modules/moment/locale/de.js",
	"./dv": "./node_modules/moment/locale/dv.js",
	"./dv.js": "./node_modules/moment/locale/dv.js",
	"./el": "./node_modules/moment/locale/el.js",
	"./el.js": "./node_modules/moment/locale/el.js",
	"./en-au": "./node_modules/moment/locale/en-au.js",
	"./en-au.js": "./node_modules/moment/locale/en-au.js",
	"./en-ca": "./node_modules/moment/locale/en-ca.js",
	"./en-ca.js": "./node_modules/moment/locale/en-ca.js",
	"./en-gb": "./node_modules/moment/locale/en-gb.js",
	"./en-gb.js": "./node_modules/moment/locale/en-gb.js",
	"./en-ie": "./node_modules/moment/locale/en-ie.js",
	"./en-ie.js": "./node_modules/moment/locale/en-ie.js",
	"./en-il": "./node_modules/moment/locale/en-il.js",
	"./en-il.js": "./node_modules/moment/locale/en-il.js",
	"./en-nz": "./node_modules/moment/locale/en-nz.js",
	"./en-nz.js": "./node_modules/moment/locale/en-nz.js",
	"./eo": "./node_modules/moment/locale/eo.js",
	"./eo.js": "./node_modules/moment/locale/eo.js",
	"./es": "./node_modules/moment/locale/es.js",
	"./es-do": "./node_modules/moment/locale/es-do.js",
	"./es-do.js": "./node_modules/moment/locale/es-do.js",
	"./es-us": "./node_modules/moment/locale/es-us.js",
	"./es-us.js": "./node_modules/moment/locale/es-us.js",
	"./es.js": "./node_modules/moment/locale/es.js",
	"./et": "./node_modules/moment/locale/et.js",
	"./et.js": "./node_modules/moment/locale/et.js",
	"./eu": "./node_modules/moment/locale/eu.js",
	"./eu.js": "./node_modules/moment/locale/eu.js",
	"./fa": "./node_modules/moment/locale/fa.js",
	"./fa.js": "./node_modules/moment/locale/fa.js",
	"./fi": "./node_modules/moment/locale/fi.js",
	"./fi.js": "./node_modules/moment/locale/fi.js",
	"./fo": "./node_modules/moment/locale/fo.js",
	"./fo.js": "./node_modules/moment/locale/fo.js",
	"./fr": "./node_modules/moment/locale/fr.js",
	"./fr-ca": "./node_modules/moment/locale/fr-ca.js",
	"./fr-ca.js": "./node_modules/moment/locale/fr-ca.js",
	"./fr-ch": "./node_modules/moment/locale/fr-ch.js",
	"./fr-ch.js": "./node_modules/moment/locale/fr-ch.js",
	"./fr.js": "./node_modules/moment/locale/fr.js",
	"./fy": "./node_modules/moment/locale/fy.js",
	"./fy.js": "./node_modules/moment/locale/fy.js",
	"./gd": "./node_modules/moment/locale/gd.js",
	"./gd.js": "./node_modules/moment/locale/gd.js",
	"./gl": "./node_modules/moment/locale/gl.js",
	"./gl.js": "./node_modules/moment/locale/gl.js",
	"./gom-latn": "./node_modules/moment/locale/gom-latn.js",
	"./gom-latn.js": "./node_modules/moment/locale/gom-latn.js",
	"./gu": "./node_modules/moment/locale/gu.js",
	"./gu.js": "./node_modules/moment/locale/gu.js",
	"./he": "./node_modules/moment/locale/he.js",
	"./he.js": "./node_modules/moment/locale/he.js",
	"./hi": "./node_modules/moment/locale/hi.js",
	"./hi.js": "./node_modules/moment/locale/hi.js",
	"./hr": "./node_modules/moment/locale/hr.js",
	"./hr.js": "./node_modules/moment/locale/hr.js",
	"./hu": "./node_modules/moment/locale/hu.js",
	"./hu.js": "./node_modules/moment/locale/hu.js",
	"./hy-am": "./node_modules/moment/locale/hy-am.js",
	"./hy-am.js": "./node_modules/moment/locale/hy-am.js",
	"./id": "./node_modules/moment/locale/id.js",
	"./id.js": "./node_modules/moment/locale/id.js",
	"./is": "./node_modules/moment/locale/is.js",
	"./is.js": "./node_modules/moment/locale/is.js",
	"./it": "./node_modules/moment/locale/it.js",
	"./it.js": "./node_modules/moment/locale/it.js",
	"./ja": "./node_modules/moment/locale/ja.js",
	"./ja.js": "./node_modules/moment/locale/ja.js",
	"./jv": "./node_modules/moment/locale/jv.js",
	"./jv.js": "./node_modules/moment/locale/jv.js",
	"./ka": "./node_modules/moment/locale/ka.js",
	"./ka.js": "./node_modules/moment/locale/ka.js",
	"./kk": "./node_modules/moment/locale/kk.js",
	"./kk.js": "./node_modules/moment/locale/kk.js",
	"./km": "./node_modules/moment/locale/km.js",
	"./km.js": "./node_modules/moment/locale/km.js",
	"./kn": "./node_modules/moment/locale/kn.js",
	"./kn.js": "./node_modules/moment/locale/kn.js",
	"./ko": "./node_modules/moment/locale/ko.js",
	"./ko.js": "./node_modules/moment/locale/ko.js",
	"./ky": "./node_modules/moment/locale/ky.js",
	"./ky.js": "./node_modules/moment/locale/ky.js",
	"./lb": "./node_modules/moment/locale/lb.js",
	"./lb.js": "./node_modules/moment/locale/lb.js",
	"./lo": "./node_modules/moment/locale/lo.js",
	"./lo.js": "./node_modules/moment/locale/lo.js",
	"./lt": "./node_modules/moment/locale/lt.js",
	"./lt.js": "./node_modules/moment/locale/lt.js",
	"./lv": "./node_modules/moment/locale/lv.js",
	"./lv.js": "./node_modules/moment/locale/lv.js",
	"./me": "./node_modules/moment/locale/me.js",
	"./me.js": "./node_modules/moment/locale/me.js",
	"./mi": "./node_modules/moment/locale/mi.js",
	"./mi.js": "./node_modules/moment/locale/mi.js",
	"./mk": "./node_modules/moment/locale/mk.js",
	"./mk.js": "./node_modules/moment/locale/mk.js",
	"./ml": "./node_modules/moment/locale/ml.js",
	"./ml.js": "./node_modules/moment/locale/ml.js",
	"./mn": "./node_modules/moment/locale/mn.js",
	"./mn.js": "./node_modules/moment/locale/mn.js",
	"./mr": "./node_modules/moment/locale/mr.js",
	"./mr.js": "./node_modules/moment/locale/mr.js",
	"./ms": "./node_modules/moment/locale/ms.js",
	"./ms-my": "./node_modules/moment/locale/ms-my.js",
	"./ms-my.js": "./node_modules/moment/locale/ms-my.js",
	"./ms.js": "./node_modules/moment/locale/ms.js",
	"./mt": "./node_modules/moment/locale/mt.js",
	"./mt.js": "./node_modules/moment/locale/mt.js",
	"./my": "./node_modules/moment/locale/my.js",
	"./my.js": "./node_modules/moment/locale/my.js",
	"./nb": "./node_modules/moment/locale/nb.js",
	"./nb.js": "./node_modules/moment/locale/nb.js",
	"./ne": "./node_modules/moment/locale/ne.js",
	"./ne.js": "./node_modules/moment/locale/ne.js",
	"./nl": "./node_modules/moment/locale/nl.js",
	"./nl-be": "./node_modules/moment/locale/nl-be.js",
	"./nl-be.js": "./node_modules/moment/locale/nl-be.js",
	"./nl.js": "./node_modules/moment/locale/nl.js",
	"./nn": "./node_modules/moment/locale/nn.js",
	"./nn.js": "./node_modules/moment/locale/nn.js",
	"./pa-in": "./node_modules/moment/locale/pa-in.js",
	"./pa-in.js": "./node_modules/moment/locale/pa-in.js",
	"./pl": "./node_modules/moment/locale/pl.js",
	"./pl.js": "./node_modules/moment/locale/pl.js",
	"./pt": "./node_modules/moment/locale/pt.js",
	"./pt-br": "./node_modules/moment/locale/pt-br.js",
	"./pt-br.js": "./node_modules/moment/locale/pt-br.js",
	"./pt.js": "./node_modules/moment/locale/pt.js",
	"./ro": "./node_modules/moment/locale/ro.js",
	"./ro.js": "./node_modules/moment/locale/ro.js",
	"./ru": "./node_modules/moment/locale/ru.js",
	"./ru.js": "./node_modules/moment/locale/ru.js",
	"./sd": "./node_modules/moment/locale/sd.js",
	"./sd.js": "./node_modules/moment/locale/sd.js",
	"./se": "./node_modules/moment/locale/se.js",
	"./se.js": "./node_modules/moment/locale/se.js",
	"./si": "./node_modules/moment/locale/si.js",
	"./si.js": "./node_modules/moment/locale/si.js",
	"./sk": "./node_modules/moment/locale/sk.js",
	"./sk.js": "./node_modules/moment/locale/sk.js",
	"./sl": "./node_modules/moment/locale/sl.js",
	"./sl.js": "./node_modules/moment/locale/sl.js",
	"./sq": "./node_modules/moment/locale/sq.js",
	"./sq.js": "./node_modules/moment/locale/sq.js",
	"./sr": "./node_modules/moment/locale/sr.js",
	"./sr-cyrl": "./node_modules/moment/locale/sr-cyrl.js",
	"./sr-cyrl.js": "./node_modules/moment/locale/sr-cyrl.js",
	"./sr.js": "./node_modules/moment/locale/sr.js",
	"./ss": "./node_modules/moment/locale/ss.js",
	"./ss.js": "./node_modules/moment/locale/ss.js",
	"./sv": "./node_modules/moment/locale/sv.js",
	"./sv.js": "./node_modules/moment/locale/sv.js",
	"./sw": "./node_modules/moment/locale/sw.js",
	"./sw.js": "./node_modules/moment/locale/sw.js",
	"./ta": "./node_modules/moment/locale/ta.js",
	"./ta.js": "./node_modules/moment/locale/ta.js",
	"./te": "./node_modules/moment/locale/te.js",
	"./te.js": "./node_modules/moment/locale/te.js",
	"./tet": "./node_modules/moment/locale/tet.js",
	"./tet.js": "./node_modules/moment/locale/tet.js",
	"./tg": "./node_modules/moment/locale/tg.js",
	"./tg.js": "./node_modules/moment/locale/tg.js",
	"./th": "./node_modules/moment/locale/th.js",
	"./th.js": "./node_modules/moment/locale/th.js",
	"./tl-ph": "./node_modules/moment/locale/tl-ph.js",
	"./tl-ph.js": "./node_modules/moment/locale/tl-ph.js",
	"./tlh": "./node_modules/moment/locale/tlh.js",
	"./tlh.js": "./node_modules/moment/locale/tlh.js",
	"./tr": "./node_modules/moment/locale/tr.js",
	"./tr.js": "./node_modules/moment/locale/tr.js",
	"./tzl": "./node_modules/moment/locale/tzl.js",
	"./tzl.js": "./node_modules/moment/locale/tzl.js",
	"./tzm": "./node_modules/moment/locale/tzm.js",
	"./tzm-latn": "./node_modules/moment/locale/tzm-latn.js",
	"./tzm-latn.js": "./node_modules/moment/locale/tzm-latn.js",
	"./tzm.js": "./node_modules/moment/locale/tzm.js",
	"./ug-cn": "./node_modules/moment/locale/ug-cn.js",
	"./ug-cn.js": "./node_modules/moment/locale/ug-cn.js",
	"./uk": "./node_modules/moment/locale/uk.js",
	"./uk.js": "./node_modules/moment/locale/uk.js",
	"./ur": "./node_modules/moment/locale/ur.js",
	"./ur.js": "./node_modules/moment/locale/ur.js",
	"./uz": "./node_modules/moment/locale/uz.js",
	"./uz-latn": "./node_modules/moment/locale/uz-latn.js",
	"./uz-latn.js": "./node_modules/moment/locale/uz-latn.js",
	"./uz.js": "./node_modules/moment/locale/uz.js",
	"./vi": "./node_modules/moment/locale/vi.js",
	"./vi.js": "./node_modules/moment/locale/vi.js",
	"./x-pseudo": "./node_modules/moment/locale/x-pseudo.js",
	"./x-pseudo.js": "./node_modules/moment/locale/x-pseudo.js",
	"./yo": "./node_modules/moment/locale/yo.js",
	"./yo.js": "./node_modules/moment/locale/yo.js",
	"./zh-cn": "./node_modules/moment/locale/zh-cn.js",
	"./zh-cn.js": "./node_modules/moment/locale/zh-cn.js",
	"./zh-hk": "./node_modules/moment/locale/zh-hk.js",
	"./zh-hk.js": "./node_modules/moment/locale/zh-hk.js",
	"./zh-tw": "./node_modules/moment/locale/zh-tw.js",
	"./zh-tw.js": "./node_modules/moment/locale/zh-tw.js"
};
function webpackContext(req) {
	return __webpack_require__(webpackContextResolve(req));
};
function webpackContextResolve(req) {
	var id = map[req];
	if(!(id + 1)) // check for number or string
		throw new Error("Cannot find module '" + req + "'.");
	return id;
};
webpackContext.keys = function webpackContextKeys() {
	return Object.keys(map);
};
webpackContext.resolve = webpackContextResolve;
module.exports = webpackContext;
webpackContext.id = "./node_modules/moment/locale recursive ^\\.\\/.*$";

/***/ }),

/***/ "./redbox-portal/angular/shared/StringTemplatePipe.ts":
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "a", function() { return StringTemplatePipe; });
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__angular_core__ = __webpack_require__("./node_modules/@angular/core/esm5/core.js");
var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {
    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
    if (typeof Reflect === "object" && typeof Reflect.decorate === "function") r = Reflect.decorate(decorators, target, key, desc);
    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;
    return c > 3 && r && Object.defineProperty(target, key, r), r;
};

var StringTemplatePipe = /** @class */ (function () {
    function StringTemplatePipe() {
        this.generateTemplateString = (function () {
            var cache = {};
            function generateTemplate(template) {
                var fn = cache[template];
                if (!fn) {
                    // Replace ${expressions} (etc) with ${map.expressions}.
                    var sanitized = template
                        .replace(/\$\{([\s]*[^;\s\{]+[\s]*)\}/g, function (_, match) {
                        return "${map." + match.trim() + "}";
                    })
                        .replace(/(\$\{(?!map\.)[^}]+\})/g, '');
                    fn = Function('map', "return `" + sanitized + "`");
                }
                return fn;
            }
            ;
            return generateTemplate;
        })();
    }
    StringTemplatePipe.prototype.transform = function (templateString, args) {
        if (args != null) {
            var template = this.generateTemplateString(templateString);
            return template(args);
        }
        return templateString;
    };
    StringTemplatePipe = __decorate([
        Object(__WEBPACK_IMPORTED_MODULE_0__angular_core__["Pipe"])({
            name: 'stringTemplate'
        })
    ], StringTemplatePipe);
    return StringTemplatePipe;
}());



/***/ }),

/***/ "./redbox-portal/angular/shared/ands-service.ts":
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "a", function() { return ANDSService; });
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__angular_core__ = __webpack_require__("./node_modules/@angular/core/esm5/core.js");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1__angular_http__ = __webpack_require__("./node_modules/@angular/http/esm5/http.js");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_rxjs_add_operator_map__ = __webpack_require__("./node_modules/rxjs/_esm5/add/operator/map.js");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_rxjs_add_operator_toPromise__ = __webpack_require__("./node_modules/rxjs/_esm5/add/operator/toPromise.js");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_rxjs_add_operator_toPromise___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_3_rxjs_add_operator_toPromise__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4__shared_base_service__ = __webpack_require__("./redbox-portal/angular/shared/base-service.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5__config_service__ = __webpack_require__("./redbox-portal/angular/shared/config-service.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_6__translation_service__ = __webpack_require__("./redbox-portal/angular/shared/translation-service.ts");
var __extends = (this && this.__extends) || (function () {
    var extendStatics = Object.setPrototypeOf ||
        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||
        function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };
    return function (d, b) {
        extendStatics(d, b);
        function __() { this.constructor = d; }
        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
    };
})();
var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {
    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
    if (typeof Reflect === "object" && typeof Reflect.decorate === "function") r = Reflect.decorate(decorators, target, key, desc);
    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;
    return c > 3 && r && Object.defineProperty(target, key, r), r;
};
var __metadata = (this && this.__metadata) || function (k, v) {
    if (typeof Reflect === "object" && typeof Reflect.metadata === "function") return Reflect.metadata(k, v);
};
var __param = (this && this.__param) || function (paramIndex, decorator) {
    return function (target, key) { decorator(target, key, paramIndex); }
};







var ANDSService = /** @class */ (function (_super) {
    __extends(ANDSService, _super);
    function ANDSService(http, configService, translator) {
        var _this = _super.call(this, http, configService) || this;
        _this.configService = configService;
        _this.translator = translator;
        return _this;
    }
    ANDSService.prototype.getResourceDetails = function (uri, vocab) {
        var _this = this;
        return this.http.get(this.brandingAndPortalUrl + "/ands/vocab/resourceDetails?uri=" + uri + "&vocab=" + vocab, this.options)
            .toPromise()
            .then(function (res) { return _this.extractData(res); });
    };
    ANDSService = __decorate([
        Object(__WEBPACK_IMPORTED_MODULE_0__angular_core__["Injectable"])(),
        __param(0, Object(__WEBPACK_IMPORTED_MODULE_0__angular_core__["Inject"])(__WEBPACK_IMPORTED_MODULE_1__angular_http__["b" /* Http */])),
        __param(1, Object(__WEBPACK_IMPORTED_MODULE_0__angular_core__["Inject"])(__WEBPACK_IMPORTED_MODULE_5__config_service__["a" /* ConfigService */])),
        __param(2, Object(__WEBPACK_IMPORTED_MODULE_0__angular_core__["Inject"])(__WEBPACK_IMPORTED_MODULE_6__translation_service__["a" /* TranslationService */])),
        __metadata("design:paramtypes", [__WEBPACK_IMPORTED_MODULE_1__angular_http__["b" /* Http */],
            __WEBPACK_IMPORTED_MODULE_5__config_service__["a" /* ConfigService */],
            __WEBPACK_IMPORTED_MODULE_6__translation_service__["a" /* TranslationService */]])
    ], ANDSService);
    return ANDSService;
}(__WEBPACK_IMPORTED_MODULE_4__shared_base_service__["a" /* BaseService */]));



/***/ }),

/***/ "./redbox-portal/angular/shared/base-service.ts":
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "a", function() { return BaseService; });
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__angular_http__ = __webpack_require__("./node_modules/@angular/http/esm5/http.js");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_rxjs_add_observable_interval__ = __webpack_require__("./node_modules/rxjs/_esm5/add/observable/interval.js");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_rxjs_add_observable_of__ = __webpack_require__("./node_modules/rxjs/_esm5/add/observable/of.js");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_rxjs_add_operator_mergeMap__ = __webpack_require__("./node_modules/rxjs/_esm5/add/operator/mergeMap.js");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_rxjs_Subject__ = __webpack_require__("./node_modules/rxjs/_esm5/Subject.js");
// Copyright (c) 2017 Queensland Cyber Infrastructure Foundation (http://www.qcif.edu.au/)
//
// GNU GENERAL PUBLIC LICENSE
//    Version 2, June 1991
//
// This program is free software; you can redistribute it and/or modify
// it under the terms of the GNU General Public License as published by
// the Free Software Foundation; either version 2 of the License, or
// (at your option) any later version.
//
// This program is distributed in the hope that it will be useful,
// but WITHOUT ANY WARRANTY; without even the implied warranty of
// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
// GNU General Public License for more details.
//
// You should have received a copy of the GNU General Public License along
// with this program; if not, write to the Free Software Foundation, Inc.,
// 51 Franklin Street, Fifth Floor, Boston, MA 02110-1301 USA.





/**
 * Base class for all client-side services...
 *
 * Author: <a href='https://github.com/shilob' target='_blank'>Shilo Banihit</a>
 *
 */
var BaseService = /** @class */ (function () {
    function BaseService(http, configService) {
        var _this = this;
        this.http = http;
        this.configService = configService;
        this.initSubject = new __WEBPACK_IMPORTED_MODULE_4_rxjs_Subject__["a" /* Subject */]();
        this.configService.getConfig(function (config) {
            _this.config = config;
            _this.baseUrl = _this.config.baseUrl;
            _this.brandingAndPortalUrl = _this.baseUrl + "/" + _this.config.branding + "/" + _this.config.portal;
            _this.options = _this.getOptionsClient();
            _this.emitInit();
        });
    }
    Object.defineProperty(BaseService.prototype, "getBrandingAndPortalUrl", {
        get: function () {
            return this.brandingAndPortalUrl;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(BaseService.prototype, "getBaseUrl", {
        get: function () {
            return this.baseUrl;
        },
        enumerable: true,
        configurable: true
    });
    BaseService.prototype.waitForInit = function (handler) {
        var subs = this.initSubject.subscribe(handler);
        this.emitInit();
        return subs;
    };
    BaseService.prototype.emitInit = function () {
        if (this.config) {
            this.initSubject.next('');
        }
    };
    BaseService.prototype.getConfig = function () {
        return this.config;
    };
    BaseService.prototype.extractData = function (res, parentField) {
        if (parentField === void 0) { parentField = null; }
        var body = res.json();
        if (parentField) {
            return body[parentField] || {};
        }
        else {
            return body || {};
        }
    };
    BaseService.prototype.getOptions = function (headersObj) {
        var headers = new __WEBPACK_IMPORTED_MODULE_0__angular_http__["a" /* Headers */](headersObj);
        return new __WEBPACK_IMPORTED_MODULE_0__angular_http__["d" /* RequestOptions */]({ headers: headers });
    };
    BaseService.prototype.getOptionsClient = function (headersObj) {
        if (headersObj === void 0) { headersObj = {}; }
        headersObj['X-Source'] = 'jsclient';
        headersObj['Content-Type'] = 'application/json;charset=utf-8';
        return this.getOptions(headersObj);
    };
    return BaseService;
}());



/***/ }),

/***/ "./redbox-portal/angular/shared/config-service.ts":
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "a", function() { return ConfigService; });
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__angular_core__ = __webpack_require__("./node_modules/@angular/core/esm5/core.js");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1__angular_http__ = __webpack_require__("./node_modules/@angular/http/esm5/http.js");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_rxjs_Subject__ = __webpack_require__("./node_modules/rxjs/_esm5/Subject.js");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_rxjs_add_observable_interval__ = __webpack_require__("./node_modules/rxjs/_esm5/add/observable/interval.js");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_rxjs_add_observable_of__ = __webpack_require__("./node_modules/rxjs/_esm5/add/observable/of.js");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5_rxjs_add_operator_mergeMap__ = __webpack_require__("./node_modules/rxjs/_esm5/add/operator/mergeMap.js");
// Copyright (c) 2017 Queensland Cyber Infrastructure Foundation (http://www.qcif.edu.au/)
//
// GNU GENERAL PUBLIC LICENSE
//    Version 2, June 1991
//
// This program is free software; you can redistribute it and/or modify
// it under the terms of the GNU General Public License as published by
// the Free Software Foundation; either version 2 of the License, or
// (at your option) any later version.
//
// This program is distributed in the hope that it will be useful,
// but WITHOUT ANY WARRANTY; without even the implied warranty of
// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
// GNU General Public License for more details.
//
// You should have received a copy of the GNU General Public License along
// with this program; if not, write to the Free Software Foundation, Inc.,
// 51 Franklin Street, Fifth Floor, Boston, MA 02110-1301 USA.
var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {
    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
    if (typeof Reflect === "object" && typeof Reflect.decorate === "function") r = Reflect.decorate(decorators, target, key, desc);
    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;
    return c > 3 && r && Object.defineProperty(target, key, r), r;
};
var __metadata = (this && this.__metadata) || function (k, v) {
    if (typeof Reflect === "object" && typeof Reflect.metadata === "function") return Reflect.metadata(k, v);
};
var __param = (this && this.__param) || function (paramIndex, decorator) {
    return function (target, key) { decorator(target, key, paramIndex); }
};






/**
 * Handles client-side global configuration
 *
 * Author: <a href='https://github.com/shilob' target='_blank'>Shilo Banihit</a>
 *
 */
var ConfigService = /** @class */ (function () {
    function ConfigService(http) {
        this.http = http;
        this.subjects = {};
        this.subjects['get'] = new __WEBPACK_IMPORTED_MODULE_2_rxjs_Subject__["a" /* Subject */]();
        this.initConfig();
    }
    ConfigService.prototype.getConfig = function (handler) {
        var subs = this.subjects['get'].subscribe(handler);
        this.emitConfig();
        return subs;
    };
    ConfigService.prototype.emitConfig = function () {
        if (this.config) {
            this.subjects['get'].next(this.config);
        }
    };
    ConfigService.prototype.initConfig = function () {
        var _this = this;
        this.http.get("/dynamic/apiClientConfig?v=" + new Date().getTime()).subscribe(function (res) {
            _this.config = _this.extractData(res);
            console.log("ConfigService, initialized. ");
            _this.emitConfig();
        });
    };
    ConfigService.prototype.extractData = function (res, parentField) {
        if (parentField === void 0) { parentField = null; }
        var body = res.json();
        if (parentField) {
            return body[parentField] || {};
        }
        else {
            return body || {};
        }
    };
    ConfigService = __decorate([
        Object(__WEBPACK_IMPORTED_MODULE_0__angular_core__["Injectable"])(),
        __param(0, Object(__WEBPACK_IMPORTED_MODULE_0__angular_core__["Inject"])(__WEBPACK_IMPORTED_MODULE_1__angular_http__["b" /* Http */])),
        __metadata("design:paramtypes", [Object])
    ], ConfigService);
    return ConfigService;
}());



/***/ }),

/***/ "./redbox-portal/angular/shared/dashboard-service.ts":
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "a", function() { return DashboardService; });
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__angular_core__ = __webpack_require__("./node_modules/@angular/core/esm5/core.js");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1__angular_http__ = __webpack_require__("./node_modules/@angular/http/esm5/http.js");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_rxjs_add_operator_map__ = __webpack_require__("./node_modules/rxjs/_esm5/add/operator/map.js");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_rxjs_add_operator_toPromise__ = __webpack_require__("./node_modules/rxjs/_esm5/add/operator/toPromise.js");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_rxjs_add_operator_toPromise___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_3_rxjs_add_operator_toPromise__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_moment_es6__ = __webpack_require__("./node_modules/moment-es6/index.js");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_moment_es6___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_4_moment_es6__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5__shared_base_service__ = __webpack_require__("./redbox-portal/angular/shared/base-service.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_6__config_service__ = __webpack_require__("./redbox-portal/angular/shared/config-service.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_7__translation_service__ = __webpack_require__("./redbox-portal/angular/shared/translation-service.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_8_lodash_es__ = __webpack_require__("./node_modules/lodash-es/lodash.js");
var __extends = (this && this.__extends) || (function () {
    var extendStatics = Object.setPrototypeOf ||
        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||
        function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };
    return function (d, b) {
        extendStatics(d, b);
        function __() { this.constructor = d; }
        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
    };
})();
var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {
    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
    if (typeof Reflect === "object" && typeof Reflect.decorate === "function") r = Reflect.decorate(decorators, target, key, desc);
    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;
    return c > 3 && r && Object.defineProperty(target, key, r), r;
};
var __metadata = (this && this.__metadata) || function (k, v) {
    if (typeof Reflect === "object" && typeof Reflect.metadata === "function") return Reflect.metadata(k, v);
};
var __param = (this && this.__param) || function (paramIndex, decorator) {
    return function (target, key) { decorator(target, key, paramIndex); }
};









var DashboardService = /** @class */ (function (_super) {
    __extends(DashboardService, _super);
    function DashboardService(http, configService, translator) {
        var _this = _super.call(this, http, configService) || this;
        _this.configService = configService;
        _this.translator = translator;
        return _this;
    }
    DashboardService.prototype.getAllDraftPlansCanEdit = function () {
        var _this = this;
        var rows = this.config.maxTransferRowsPerPage;
        var start = 0;
        return this.http.get(this.brandingAndPortalUrl + "/listRecords?recordType=rdmp&state=draft&editOnly=true&start=" + start + "&rows=" + rows, this.options)
            .toPromise()
            .then(function (res) { return _this.formatDates(_this.extractData(res)); });
    };
    DashboardService.prototype.getAllRecordsCanEdit = function (recordType, state) {
        var _this = this;
        var rows = this.config.maxTransferRowsPerPage;
        var start = 0;
        var url = this.brandingAndPortalUrl + "/listRecords?recordType=" + recordType + "&editOnly=true&start=" + start + "&rows=" + rows;
        if (state != '') {
            url += "&state=" + state;
        }
        return this.http.get(url, this.options)
            .toPromise()
            .then(function (res) { return _this.formatDates(_this.extractData(res)); });
    };
    DashboardService.prototype.getActivePlans = function (pageNumber) {
        var _this = this;
        var rows = 10;
        var start = (pageNumber - 1) * rows;
        return this.http.get(this.brandingAndPortalUrl + "/listRecords?state=active&start=" + start + "&rows=" + rows, this.options)
            .toPromise()
            .then(function (res) { return _this.formatDates(_this.extractData(res)); });
    };
    DashboardService.prototype.getDraftPlans = function (pageNumber) {
        var _this = this;
        var rows = 10;
        var start = (pageNumber - 1) * rows;
        return this.http.get(this.brandingAndPortalUrl + "/listRecords?recordType=rdmp&state=draft&start=" + start + "&rows=" + rows, this.options)
            .toPromise()
            .then(function (res) { return _this.formatDates(_this.extractData(res)); });
    };
    DashboardService.prototype.getRecords = function (recordType, state, pageNumber) {
        var _this = this;
        var rows = 10;
        var start = (pageNumber - 1) * rows;
        return this.http.get(this.brandingAndPortalUrl + "/listRecords?recordType=" + recordType + "&state=" + state + "&start=" + start + "&rows=" + rows, this.options)
            .toPromise()
            .then(function (res) { return _this.formatDates(_this.extractData(res)); });
    };
    DashboardService.prototype.formatDates = function (response) {
        var items = response["items"];
        for (var i = 0; i < items.length; i++) {
            items[i]["dateCreated"] = __WEBPACK_IMPORTED_MODULE_4_moment_es6___default()(items[i]["dateCreated"]).local().format('LLL');
            items[i]["dateModified"] = __WEBPACK_IMPORTED_MODULE_4_moment_es6___default()(items[i]["dateModified"]).local().format('LLL');
        }
        return response;
    };
    DashboardService.prototype.setDashboardTitle = function (planTable, plans) {
        var _this = this;
        if (plans === void 0) { plans = null; }
        __WEBPACK_IMPORTED_MODULE_8_lodash_es__["forEach"](planTable ? planTable.items : plans, function (plan) {
            plan.dashboardTitle = (__WEBPACK_IMPORTED_MODULE_8_lodash_es__["isUndefined"](plan.title) || __WEBPACK_IMPORTED_MODULE_8_lodash_es__["isEmpty"](plan.title) || __WEBPACK_IMPORTED_MODULE_8_lodash_es__["isEmpty"](plan.title[0])) ? _this.translator.t('plan-with-no-title') : plan.title;
        });
    };
    DashboardService.prototype.searchRecords = function (pageNumber, basicSearch, facets) {
        var _this = this;
        if (facets === void 0) { facets = null; }
        var rows = this.config.maxSearchRowsPerPage;
        var start = (pageNumber - 1) * rows;
        return this.http.get(this.brandingAndPortalUrl + "/searchPlans?start=" + start + "&rows=" + rows + "&query=" + basicSearch + "&facets=" + facets, this.options)
            .toPromise()
            .then(function (res) { return _this.formatDates(_this.extractData(res)); });
    };
    DashboardService = __decorate([
        Object(__WEBPACK_IMPORTED_MODULE_0__angular_core__["Injectable"])(),
        __param(0, Object(__WEBPACK_IMPORTED_MODULE_0__angular_core__["Inject"])(__WEBPACK_IMPORTED_MODULE_1__angular_http__["b" /* Http */])),
        __param(1, Object(__WEBPACK_IMPORTED_MODULE_0__angular_core__["Inject"])(__WEBPACK_IMPORTED_MODULE_6__config_service__["a" /* ConfigService */])),
        __param(2, Object(__WEBPACK_IMPORTED_MODULE_0__angular_core__["Inject"])(__WEBPACK_IMPORTED_MODULE_7__translation_service__["a" /* TranslationService */])),
        __metadata("design:paramtypes", [__WEBPACK_IMPORTED_MODULE_1__angular_http__["b" /* Http */],
            __WEBPACK_IMPORTED_MODULE_6__config_service__["a" /* ConfigService */],
            __WEBPACK_IMPORTED_MODULE_7__translation_service__["a" /* TranslationService */]])
    ], DashboardService);
    return DashboardService;
}(__WEBPACK_IMPORTED_MODULE_5__shared_base_service__["a" /* BaseService */]));



/***/ }),

/***/ "./redbox-portal/angular/shared/email-service.ts":
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "a", function() { return EmailNotificationService; });
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__angular_core__ = __webpack_require__("./node_modules/@angular/core/esm5/core.js");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1__angular_http__ = __webpack_require__("./node_modules/@angular/http/esm5/http.js");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_rxjs_add_operator_map__ = __webpack_require__("./node_modules/rxjs/_esm5/add/operator/map.js");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_rxjs_add_operator_toPromise__ = __webpack_require__("./node_modules/rxjs/_esm5/add/operator/toPromise.js");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_rxjs_add_operator_toPromise___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_3_rxjs_add_operator_toPromise__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4__shared_base_service__ = __webpack_require__("./redbox-portal/angular/shared/base-service.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5__shared_config_service__ = __webpack_require__("./redbox-portal/angular/shared/config-service.ts");
// Copyright (c) 2017 Queensland Cyber Infrastructure Foundation (http://www.qcif.edu.au/)
//
// GNU GENERAL PUBLIC LICENSE
//    Version 2, June 1991
//
// This program is free software; you can redistribute it and/or modify
// it under the terms of the GNU General Public License as published by
// the Free Software Foundation; either version 2 of the License, or
// (at your option) any later version.
//
// This program is distributed in the hope that it will be useful,
// but WITHOUT ANY WARRANTY; without even the implied warranty of
// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
// GNU General Public License for more details.
//
// You should have received a copy of the GNU General Public License along
// with this program; if not, write to the Free Software Foundation, Inc.,
// 51 Franklin Street, Fifth Floor, Boston, MA 02110-1301 USA.
var __extends = (this && this.__extends) || (function () {
    var extendStatics = Object.setPrototypeOf ||
        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||
        function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };
    return function (d, b) {
        extendStatics(d, b);
        function __() { this.constructor = d; }
        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
    };
})();
var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {
    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
    if (typeof Reflect === "object" && typeof Reflect.decorate === "function") r = Reflect.decorate(decorators, target, key, desc);
    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;
    return c > 3 && r && Object.defineProperty(target, key, r), r;
};
var __metadata = (this && this.__metadata) || function (k, v) {
    if (typeof Reflect === "object" && typeof Reflect.metadata === "function") return Reflect.metadata(k, v);
};
var __param = (this && this.__param) || function (paramIndex, decorator) {
    return function (target, key) { decorator(target, key, paramIndex); }
};






/**
 * User related service...
 *
 * @author <a target='_' href='https://github.com/thomcuddihy'>Thom Cuddihy</a>
 *
 */
var EmailNotificationService = /** @class */ (function (_super) {
    __extends(EmailNotificationService, _super);
    function EmailNotificationService(http, configService) {
        var _this = _super.call(this, http, configService) || this;
        _this.configService = configService;
        return _this;
    }
    EmailNotificationService.prototype.sendNotification = function (to, template, data, subject, from) {
        if (data === void 0) { data = {}; }
        if (subject === void 0) { subject = null; }
        if (from === void 0) { from = null; }
        var payload = { to: to, template: template, data: data };
        if (subject) {
            payload['subject'] = subject;
        }
        if (from) {
            payload['from'] = from;
        }
        return this.http.post(this.brandingAndPortalUrl + "/api/sendNotification", payload, this.getOptionsClient())
            .toPromise()
            .then(this.extractData);
    };
    EmailNotificationService = __decorate([
        Object(__WEBPACK_IMPORTED_MODULE_0__angular_core__["Injectable"])(),
        __param(0, Object(__WEBPACK_IMPORTED_MODULE_0__angular_core__["Inject"])(__WEBPACK_IMPORTED_MODULE_1__angular_http__["b" /* Http */])), __param(1, Object(__WEBPACK_IMPORTED_MODULE_0__angular_core__["Inject"])(__WEBPACK_IMPORTED_MODULE_5__shared_config_service__["a" /* ConfigService */])),
        __metadata("design:paramtypes", [__WEBPACK_IMPORTED_MODULE_1__angular_http__["b" /* Http */], __WEBPACK_IMPORTED_MODULE_5__shared_config_service__["a" /* ConfigService */]])
    ], EmailNotificationService);
    return EmailNotificationService;
}(__WEBPACK_IMPORTED_MODULE_4__shared_base_service__["a" /* BaseService */]));



/***/ }),

/***/ "./redbox-portal/angular/shared/fieldClasses.ts":
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "a", function() { return fieldClasses; });
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__form_field_simple__ = __webpack_require__("./redbox-portal/angular/shared/form/field-simple.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1__form_field_textfield_component__ = __webpack_require__("./redbox-portal/angular/shared/form/field-textfield.component.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2__form_field_simple_component__ = __webpack_require__("./redbox-portal/angular/shared/form/field-simple.component.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3__form_record_meta_component__ = __webpack_require__("./redbox-portal/angular/shared/form/record-meta.component.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4__form_field_vocab_component__ = __webpack_require__("./redbox-portal/angular/shared/form/field-vocab.component.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5__form_field_repeatable_component__ = __webpack_require__("./redbox-portal/angular/shared/form/field-repeatable.component.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_6__form_field_contributor_component__ = __webpack_require__("./redbox-portal/angular/shared/form/field-contributor.component.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_7__form_workflow_button_component__ = __webpack_require__("./redbox-portal/angular/shared/form/workflow-button.component.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_8__form_action_button_component__ = __webpack_require__("./redbox-portal/angular/shared/form/action-button.component.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_9__form_field_relatedobjectdata_component__ = __webpack_require__("./redbox-portal/angular/shared/form/field-relatedobjectdata.component.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_10__form_field_relatedobjectselector_component__ = __webpack_require__("./redbox-portal/angular/shared/form/field-relatedobjectselector.component.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_11__form_field_datalocation_component__ = __webpack_require__("./redbox-portal/angular/shared/form/field-datalocation.component.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_12__form_field_publishdatalocationselector_component__ = __webpack_require__("./redbox-portal/angular/shared/form/field-publishdatalocationselector.component.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_13__form_field_map_component__ = __webpack_require__("./redbox-portal/angular/shared/form/field-map.component.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_14__form_field_group_component__ = __webpack_require__("./redbox-portal/angular/shared/form/field-group.component.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_15__form_workspace_field_component__ = __webpack_require__("./redbox-portal/angular/shared/form/workspace-field.component.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_16__form_workspace_selector_component__ = __webpack_require__("./redbox-portal/angular/shared/form/workspace-selector.component.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_17__form_field_andsvocab_component__ = __webpack_require__("./redbox-portal/angular/shared/form/field-andsvocab.component.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_18__form_field_pdflist_component__ = __webpack_require__("./redbox-portal/angular/shared/form/field-pdflist.component.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_19__form_field_asynch_component__ = __webpack_require__("./redbox-portal/angular/shared/form/field-asynch.component.ts");




















var fieldClasses = {
    'TextField': { 'meta': __WEBPACK_IMPORTED_MODULE_1__form_field_textfield_component__["f" /* TextField */], 'comp': __WEBPACK_IMPORTED_MODULE_1__form_field_textfield_component__["g" /* TextFieldComponent */] },
    'TextArea': { 'meta': __WEBPACK_IMPORTED_MODULE_1__form_field_textfield_component__["d" /* TextArea */], 'comp': __WEBPACK_IMPORTED_MODULE_1__form_field_textfield_component__["e" /* TextAreaComponent */] },
    'MarkdownTextArea': { 'meta': __WEBPACK_IMPORTED_MODULE_1__form_field_textfield_component__["a" /* MarkdownTextArea */], 'comp': __WEBPACK_IMPORTED_MODULE_1__form_field_textfield_component__["b" /* MarkdownTextAreaComponent */] },
    'DateTime': { 'meta': __WEBPACK_IMPORTED_MODULE_0__form_field_simple__["e" /* DateTime */], 'comp': __WEBPACK_IMPORTED_MODULE_2__form_field_simple_component__["d" /* DateTimeComponent */] },
    'Container': { 'meta': __WEBPACK_IMPORTED_MODULE_0__form_field_simple__["d" /* Container */], 'comp': [__WEBPACK_IMPORTED_MODULE_2__form_field_simple_component__["p" /* TextBlockComponent */], __WEBPACK_IMPORTED_MODULE_14__form_field_group_component__["a" /* GenericGroupComponent */]] },
    'TabOrAccordionContainer': { 'meta': __WEBPACK_IMPORTED_MODULE_0__form_field_simple__["o" /* TabOrAccordionContainer */], 'comp': __WEBPACK_IMPORTED_MODULE_2__form_field_simple_component__["o" /* TabOrAccordionContainerComponent */] },
    'ButtonBarContainer': { 'meta': __WEBPACK_IMPORTED_MODULE_0__form_field_simple__["b" /* ButtonBarContainer */], 'comp': __WEBPACK_IMPORTED_MODULE_2__form_field_simple_component__["b" /* ButtonBarContainerComponent */] },
    'AnchorOrButton': { 'meta': __WEBPACK_IMPORTED_MODULE_0__form_field_simple__["a" /* AnchorOrButton */], 'comp': __WEBPACK_IMPORTED_MODULE_2__form_field_simple_component__["a" /* AnchorOrButtonComponent */] },
    'SaveButton': { 'meta': __WEBPACK_IMPORTED_MODULE_0__form_field_simple__["k" /* SaveButton */], 'comp': __WEBPACK_IMPORTED_MODULE_2__form_field_simple_component__["j" /* SaveButtonComponent */] },
    'CancelButton': { 'meta': __WEBPACK_IMPORTED_MODULE_0__form_field_simple__["c" /* CancelButton */], 'comp': __WEBPACK_IMPORTED_MODULE_2__form_field_simple_component__["c" /* CancelButtonComponent */] },
    'VocabField': { 'meta': __WEBPACK_IMPORTED_MODULE_4__form_field_vocab_component__["a" /* VocabField */], 'comp': __WEBPACK_IMPORTED_MODULE_4__form_field_vocab_component__["b" /* VocabFieldComponent */], 'lookupService': 'vocabFieldLookupService' },
    'RepeatableContainer': { 'meta': __WEBPACK_IMPORTED_MODULE_5__form_field_repeatable_component__["c" /* RepeatableContainer */], 'comp': [__WEBPACK_IMPORTED_MODULE_5__form_field_repeatable_component__["g" /* RepeatableVocabComponent */], __WEBPACK_IMPORTED_MODULE_1__form_field_textfield_component__["c" /* RepeatableTextfieldComponent */], __WEBPACK_IMPORTED_MODULE_14__form_field_group_component__["b" /* RepeatableGroupComponent */]] },
    'RepeatableContributor': { 'meta': __WEBPACK_IMPORTED_MODULE_5__form_field_repeatable_component__["d" /* RepeatableContributor */], 'comp': __WEBPACK_IMPORTED_MODULE_5__form_field_repeatable_component__["e" /* RepeatableContributorComponent */] },
    'RepeatableVocab': { 'meta': __WEBPACK_IMPORTED_MODULE_5__form_field_repeatable_component__["f" /* RepeatableVocab */], 'comp': __WEBPACK_IMPORTED_MODULE_5__form_field_repeatable_component__["g" /* RepeatableVocabComponent */] },
    'ContributorField': { 'meta': __WEBPACK_IMPORTED_MODULE_6__form_field_contributor_component__["b" /* ContributorField */], 'comp': __WEBPACK_IMPORTED_MODULE_6__form_field_contributor_component__["a" /* ContributorComponent */], 'lookupService': 'vocabFieldLookupService' },
    'HiddenValue': { 'meta': __WEBPACK_IMPORTED_MODULE_0__form_field_simple__["f" /* HiddenValue */], 'comp': __WEBPACK_IMPORTED_MODULE_2__form_field_simple_component__["f" /* HiddenValueComponent */] },
    'WorkflowStepButton': { 'meta': __WEBPACK_IMPORTED_MODULE_7__form_workflow_button_component__["a" /* WorkflowStepButton */], 'comp': __WEBPACK_IMPORTED_MODULE_7__form_workflow_button_component__["b" /* WorkflowStepButtonComponent */] },
    'ActionButton': { 'meta': __WEBPACK_IMPORTED_MODULE_8__form_action_button_component__["a" /* ActionButton */], 'comp': __WEBPACK_IMPORTED_MODULE_8__form_action_button_component__["b" /* ActionButtonComponent */] },
    'LinkValueComponent': { 'meta': __WEBPACK_IMPORTED_MODULE_0__form_field_simple__["h" /* LinkValue */], 'comp': __WEBPACK_IMPORTED_MODULE_2__form_field_simple_component__["h" /* LinkValueComponent */] },
    'SelectionField': { 'meta': __WEBPACK_IMPORTED_MODULE_0__form_field_simple__["l" /* SelectionField */], 'comp': [__WEBPACK_IMPORTED_MODULE_2__form_field_simple_component__["k" /* SelectionFieldComponent */], __WEBPACK_IMPORTED_MODULE_2__form_field_simple_component__["e" /* DropdownFieldComponent */]] },
    'RelatedObjectDataField': { 'meta': __WEBPACK_IMPORTED_MODULE_9__form_field_relatedobjectdata_component__["b" /* RelatedObjectDataField */], 'comp': __WEBPACK_IMPORTED_MODULE_9__form_field_relatedobjectdata_component__["a" /* RelatedObjectDataComponent */], 'lookupService': 'vocabFieldLookupService' },
    'MapField': { 'meta': __WEBPACK_IMPORTED_MODULE_13__form_field_map_component__["b" /* MapField */], 'comp': __WEBPACK_IMPORTED_MODULE_13__form_field_map_component__["a" /* MapComponent */], 'lookupService': 'vocabFieldLookupService' },
    'ParameterRetriever': { 'meta': __WEBPACK_IMPORTED_MODULE_0__form_field_simple__["j" /* ParameterRetrieverField */], 'comp': __WEBPACK_IMPORTED_MODULE_2__form_field_simple_component__["i" /* ParameterRetrieverComponent */] },
    'RecordMetadataRetriever': { 'meta': __WEBPACK_IMPORTED_MODULE_3__form_record_meta_component__["b" /* RecordMetadataRetrieverField */], 'comp': __WEBPACK_IMPORTED_MODULE_3__form_record_meta_component__["a" /* RecordMetadataRetrieverComponent */] },
    'RelatedObjectSelector': { 'meta': __WEBPACK_IMPORTED_MODULE_10__form_field_relatedobjectselector_component__["b" /* RelatedObjectSelectorField */], 'comp': __WEBPACK_IMPORTED_MODULE_10__form_field_relatedobjectselector_component__["a" /* RelatedObjectSelectorComponent */] },
    'DataLocation': { 'meta': __WEBPACK_IMPORTED_MODULE_11__form_field_datalocation_component__["b" /* DataLocationField */], 'comp': __WEBPACK_IMPORTED_MODULE_11__form_field_datalocation_component__["a" /* DataLocationComponent */] },
    'WorkspaceSelectorField': { 'meta': __WEBPACK_IMPORTED_MODULE_15__form_workspace_field_component__["b" /* WorkspaceSelectorField */], 'comp': [__WEBPACK_IMPORTED_MODULE_16__form_workspace_selector_component__["a" /* WorkspaceSelectorComponent */], __WEBPACK_IMPORTED_MODULE_16__form_workspace_selector_component__["b" /* WorkspaceSelectorFieldComponent */]] },
    'PublishDataLocationSelector': { 'meta': __WEBPACK_IMPORTED_MODULE_12__form_field_publishdatalocationselector_component__["b" /* PublishDataLocationSelectorField */], 'comp': __WEBPACK_IMPORTED_MODULE_12__form_field_publishdatalocationselector_component__["a" /* PublishDataLocationSelectorComponent */] },
    'TabNavButton': { 'meta': __WEBPACK_IMPORTED_MODULE_0__form_field_simple__["n" /* TabNavButton */], 'comp': __WEBPACK_IMPORTED_MODULE_2__form_field_simple_component__["n" /* TabNavButtonComponent */] },
    'Spacer': { 'meta': __WEBPACK_IMPORTED_MODULE_0__form_field_simple__["m" /* Spacer */], 'comp': __WEBPACK_IMPORTED_MODULE_2__form_field_simple_component__["m" /* SpacerComponent */] },
    'ANDSVocab': { 'meta': __WEBPACK_IMPORTED_MODULE_17__form_field_andsvocab_component__["b" /* ANDSVocabField */], 'comp': __WEBPACK_IMPORTED_MODULE_17__form_field_andsvocab_component__["a" /* ANDSVocabComponent */] },
    'PDFList': { 'meta': __WEBPACK_IMPORTED_MODULE_18__form_field_pdflist_component__["b" /* PDFListField */], 'comp': __WEBPACK_IMPORTED_MODULE_18__form_field_pdflist_component__["a" /* PDFListComponent */] },
    'AsynchField': { 'meta': __WEBPACK_IMPORTED_MODULE_19__form_field_asynch_component__["b" /* AsynchField */], 'comp': __WEBPACK_IMPORTED_MODULE_19__form_field_asynch_component__["a" /* AsynchComponent */] },
    'Toggle': { 'meta': __WEBPACK_IMPORTED_MODULE_0__form_field_simple__["p" /* Toggle */], 'comp': __WEBPACK_IMPORTED_MODULE_2__form_field_simple_component__["q" /* ToggleComponent */] },
    'HtmlRaw': { 'meta': __WEBPACK_IMPORTED_MODULE_0__form_field_simple__["g" /* HtmlRaw */], 'comp': __WEBPACK_IMPORTED_MODULE_2__form_field_simple_component__["g" /* HtmlRawComponent */] }
};


/***/ }),

/***/ "./redbox-portal/angular/shared/form/action-button.component.ts":
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "a", function() { return ActionButton; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "b", function() { return ActionButtonComponent; });
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__angular_core__ = __webpack_require__("./node_modules/@angular/core/esm5/core.js");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1__field_simple_component__ = __webpack_require__("./redbox-portal/angular/shared/form/field-simple.component.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2__field_base__ = __webpack_require__("./redbox-portal/angular/shared/form/field-base.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3__records_service__ = __webpack_require__("./redbox-portal/angular/shared/form/records.service.ts");
var __extends = (this && this.__extends) || (function () {
    var extendStatics = Object.setPrototypeOf ||
        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||
        function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };
    return function (d, b) {
        extendStatics(d, b);
        function __() { this.constructor = d; }
        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
    };
})();
var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {
    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
    if (typeof Reflect === "object" && typeof Reflect.decorate === "function") r = Reflect.decorate(decorators, target, key, desc);
    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;
    return c > 3 && r && Object.defineProperty(target, key, r), r;
};




var ActionButton = /** @class */ (function (_super) {
    __extends(ActionButton, _super);
    function ActionButton(options, injector) {
        var _this = _super.call(this, options, injector) || this;
        _this.submitting = false;
        _this.targetAction = options['targetAction'] || null;
        _this.recordService = _this.getFromInjector(__WEBPACK_IMPORTED_MODULE_3__records_service__["a" /* RecordsService */]);
        _this.value = options['value'] || null;
        return _this;
    }
    ActionButton.prototype.setValue = function (value) {
        this.value = value;
        this.formModel.patchValue(value, { emitEvent: true, emitModelToViewChange: true });
        this.formModel.markAsTouched();
    };
    return ActionButton;
}(__WEBPACK_IMPORTED_MODULE_2__field_base__["a" /* FieldBase */]));

// For action buttons
var ActionButtonComponent = /** @class */ (function (_super) {
    __extends(ActionButtonComponent, _super);
    function ActionButtonComponent() {
        return _super !== null && _super.apply(this, arguments) || this;
    }
    ActionButtonComponent.prototype.executeAction = function (event) {
        this.field.submitting = true;
        var that = this;
        this.field.recordService.executeAction(this.field.targetAction, { oid: this.field.fieldMap._rootComp.oid })
            .then(function (response) {
            that.field.submitting = false;
            that.field.setValue("http://203.101.227.135:5000/dataset/" + that.field.fieldMap._rootComp.oid);
            that.fieldMap._rootComp.onSubmit().subscribe();
        });
    };
    ActionButtonComponent.prototype.isDisabled = function () {
        return false;
    };
    ActionButtonComponent = __decorate([
        Object(__WEBPACK_IMPORTED_MODULE_0__angular_core__["Component"])({
            selector: 'action-button',
            template: "\n  <div *ngIf=\"field.editMode\">\n    <div *ngIf=\"field.value\">Record published to CKAN at <a target=\"_blank\" [attr.href]=\"field.value\">{{ field.value }}</a></div>\n    <div *ngIf=\"!field.value\"><button *ngIf=\"!field.submitting\" type=\"{{field.type}}\" [ngClass]=\"field.cssClasses\" (click)=\"executeAction($event)\" [disabled]=\"isDisabled()\">{{field.label}}</button><span *ngIf=\"field.submitting\">Submitting to CKAN</span>\n    </div>\n    <div [formGroup]='form'>\n    <input [formControl]=\"getFormControl()\"  [id]=\"field.name\" name=\"{{field.name}}\" type=\"hidden\" />\n    </div>\n  </div>\n  <div *ngIf=\"!field.editMode\">\n    <div *ngIf=\"field.value\">Record published to CKAN at <a target=\"_blank\" [attr.href]=\"field.value\">{{ field.value }}</a></div>\n    <div *ngIf=\"!field.value\">Record not yet published</div>\n  </div>\n  ",
        })
    ], ActionButtonComponent);
    return ActionButtonComponent;
}(__WEBPACK_IMPORTED_MODULE_1__field_simple_component__["l" /* SimpleComponent */]));



/***/ }),

/***/ "./redbox-portal/angular/shared/form/dmp-field.component.ts":
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "a", function() { return DmpFieldComponent; });
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__angular_core__ = __webpack_require__("./node_modules/@angular/core/esm5/core.js");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1__angular_forms__ = __webpack_require__("./node_modules/@angular/forms/esm5/forms.js");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2__field_base__ = __webpack_require__("./redbox-portal/angular/shared/form/field-base.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_lodash_es__ = __webpack_require__("./node_modules/lodash-es/lodash.js");
// Copyright (c) 2017 Queensland Cyber Infrastructure Foundation (http://www.qcif.edu.au/)
//
// GNU GENERAL PUBLIC LICENSE
//    Version 2, June 1991
//
// This program is free software; you can redistribute it and/or modify
// it under the terms of the GNU General Public License as published by
// the Free Software Foundation; either version 2 of the License, or
// (at your option) any later version.
//
// This program is distributed in the hope that it will be useful,
// but WITHOUT ANY WARRANTY; without even the implied warranty of
// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
// GNU General Public License for more details.
//
// You should have received a copy of the GNU General Public License along
// with this program; if not, write to the Free Software Foundation, Inc.,
// 51 Franklin Street, Fifth Floor, Boston, MA 02110-1301 USA.
var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {
    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
    if (typeof Reflect === "object" && typeof Reflect.decorate === "function") r = Reflect.decorate(decorators, target, key, desc);
    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;
    return c > 3 && r && Object.defineProperty(target, key, r), r;
};
var __metadata = (this && this.__metadata) || function (k, v) {
    if (typeof Reflect === "object" && typeof Reflect.metadata === "function") return Reflect.metadata(k, v);
};
var __param = (this && this.__param) || function (paramIndex, decorator) {
    return function (target, key) { decorator(target, key, paramIndex); }
};




/**
 * Base component for a DMP field.
 *
 * Author: <a href='https://github.com/shilob' target='_blank'>Shilo Banihit</a>
 *
 */
var DmpFieldComponent = /** @class */ (function () {
    /**
     * For DI'ing...
     */
    function DmpFieldComponent(componentFactoryResolver, app) {
        this.componentFactoryResolver = componentFactoryResolver;
        this.app = app;
        this.isEmbedded = false;
        this.disabledElements = [];
    }
    Object.defineProperty(DmpFieldComponent.prototype, "isValid", {
        /**
         * If the form is valid.
         */
        get: function () {
            if (this.form && this.form.controls) {
                return this.form.controls[this.field.name].valid;
            }
            return false;
        },
        enumerable: true,
        configurable: true
    });
    /**
     *
     */
    DmpFieldComponent.prototype.isDisabled = function () {
        var disabledExpression = this.field.options['disabledExpression'];
        if (disabledExpression != null) {
            var imports = this.fieldAnchor;
            var variables = {};
            variables['imports'] = this.fieldMap._rootComp;
            var compiled = __WEBPACK_IMPORTED_MODULE_3_lodash_es__["template"](disabledExpression, variables);
            var parentElement = jQuery(this.fieldElement.nativeElement.parentElement);
            if (compiled() == "true") {
                //take note of which elements where already disabled as we dont want to enable them if whole component becomes enabled again
                this.disabledElements = parentElement.find('*:disabled');
                parentElement.find('input').prop("disabled", true);
                return 'disabled';
            }
            else {
                if (jQuery(this.fieldElement.nativeElement).prop('disabled') == 'disabled') {
                    //previously disabled so lets re-enable
                    parentElement.find('input').prop("disabled", false);
                    __WEBPACK_IMPORTED_MODULE_3_lodash_es__["each"](this.disabledElements, function (disabledElement) { return disabledElement.prop("disabled", true); });
                }
                return null;
            }
        }
        return null;
    };
    /**
     * Change handler, instantiates the field component.
     */
    DmpFieldComponent.prototype.ngOnChanges = function () {
        if (!this.field || !this.componentFactoryResolver) {
            return;
        }
        this.fieldAnchor.clear();
        var compFactory = this.componentFactoryResolver.resolveComponentFactory(this.field.compClass);
        var fieldCompRef = this.fieldAnchor.createComponent(compFactory, undefined, this.app['_injector']);
        fieldCompRef.instance.injector = this.app['_injector'];
        fieldCompRef.instance.field = this.field;
        fieldCompRef.instance.form = this.form;
        fieldCompRef.instance.fieldMap = this.fieldMap;
        fieldCompRef.instance.parentId = this.parentId;
        fieldCompRef.instance.isEmbedded = this.isEmbedded;
        fieldCompRef.instance.name = this.name;
        fieldCompRef.instance.index = this.index;
        // flip thi: make the fields responsible for setting the right fieldMap member
        this.field.setFieldMapEntry(this.fieldMap, fieldCompRef);
        //this.fieldMap[this.field.name].instance = fieldCompRef.instance;
    };
    __decorate([
        Object(__WEBPACK_IMPORTED_MODULE_0__angular_core__["Input"])(),
        __metadata("design:type", __WEBPACK_IMPORTED_MODULE_2__field_base__["a" /* FieldBase */])
    ], DmpFieldComponent.prototype, "field", void 0);
    __decorate([
        Object(__WEBPACK_IMPORTED_MODULE_0__angular_core__["Input"])(),
        __metadata("design:type", __WEBPACK_IMPORTED_MODULE_1__angular_forms__["c" /* FormGroup */])
    ], DmpFieldComponent.prototype, "form", void 0);
    __decorate([
        Object(__WEBPACK_IMPORTED_MODULE_0__angular_core__["Input"])(),
        __metadata("design:type", Object)
    ], DmpFieldComponent.prototype, "value", void 0);
    __decorate([
        Object(__WEBPACK_IMPORTED_MODULE_0__angular_core__["Input"])(),
        __metadata("design:type", Object)
    ], DmpFieldComponent.prototype, "fieldMap", void 0);
    __decorate([
        Object(__WEBPACK_IMPORTED_MODULE_0__angular_core__["ViewChild"])('field', { read: __WEBPACK_IMPORTED_MODULE_0__angular_core__["ViewContainerRef"] }),
        __metadata("design:type", __WEBPACK_IMPORTED_MODULE_0__angular_core__["ViewContainerRef"])
    ], DmpFieldComponent.prototype, "fieldAnchor", void 0);
    __decorate([
        Object(__WEBPACK_IMPORTED_MODULE_0__angular_core__["Input"])(),
        __metadata("design:type", String)
    ], DmpFieldComponent.prototype, "parentId", void 0);
    __decorate([
        Object(__WEBPACK_IMPORTED_MODULE_0__angular_core__["Input"])(),
        __metadata("design:type", Boolean)
    ], DmpFieldComponent.prototype, "isEmbedded", void 0);
    __decorate([
        Object(__WEBPACK_IMPORTED_MODULE_0__angular_core__["Input"])(),
        __metadata("design:type", Object)
    ], DmpFieldComponent.prototype, "name", void 0);
    __decorate([
        Object(__WEBPACK_IMPORTED_MODULE_0__angular_core__["Input"])(),
        __metadata("design:type", Number)
    ], DmpFieldComponent.prototype, "index", void 0);
    __decorate([
        Object(__WEBPACK_IMPORTED_MODULE_0__angular_core__["ViewChild"])('field'),
        __metadata("design:type", Object)
    ], DmpFieldComponent.prototype, "fieldElement", void 0);
    DmpFieldComponent = __decorate([
        Object(__WEBPACK_IMPORTED_MODULE_0__angular_core__["Component"])({
            selector: 'dmp-field',
            template: '<span [attr.disabled]="isDisabled()" #field></span>'
        }),
        __param(0, Object(__WEBPACK_IMPORTED_MODULE_0__angular_core__["Inject"])(__WEBPACK_IMPORTED_MODULE_0__angular_core__["ComponentFactoryResolver"])),
        __metadata("design:paramtypes", [__WEBPACK_IMPORTED_MODULE_0__angular_core__["ComponentFactoryResolver"], __WEBPACK_IMPORTED_MODULE_0__angular_core__["ApplicationRef"]])
    ], DmpFieldComponent);
    return DmpFieldComponent;
}());



/***/ }),

/***/ "./redbox-portal/angular/shared/form/field-andsvocab.component.ts":
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "b", function() { return ANDSVocabField; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "a", function() { return ANDSVocabComponent; });
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__angular_core__ = __webpack_require__("./node_modules/@angular/core/esm5/core.js");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1__field_simple_component__ = __webpack_require__("./redbox-portal/angular/shared/form/field-simple.component.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2__field_base__ = __webpack_require__("./redbox-portal/angular/shared/form/field-base.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3__ands_service__ = __webpack_require__("./redbox-portal/angular/shared/ands-service.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_angular_tree_component__ = __webpack_require__("./node_modules/angular-tree-component/dist/angular-tree-component.js");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5_lodash_es__ = __webpack_require__("./node_modules/lodash-es/lodash.js");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_6_rxjs_Observable__ = __webpack_require__("./node_modules/rxjs/_esm5/Observable.js");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_7_rxjs_Subject__ = __webpack_require__("./node_modules/rxjs/_esm5/Subject.js");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_8_rxjs_add_operator_bufferTime__ = __webpack_require__("./node_modules/rxjs/_esm5/add/operator/bufferTime.js");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_9_rxjs_add_operator_filter__ = __webpack_require__("./node_modules/rxjs/_esm5/add/operator/filter.js");
var __extends = (this && this.__extends) || (function () {
    var extendStatics = Object.setPrototypeOf ||
        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||
        function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };
    return function (d, b) {
        extendStatics(d, b);
        function __() { this.constructor = d; }
        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
    };
})();
var __assign = (this && this.__assign) || Object.assign || function(t) {
    for (var s, i = 1, n = arguments.length; i < n; i++) {
        s = arguments[i];
        for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))
            t[p] = s[p];
    }
    return t;
};
var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {
    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
    if (typeof Reflect === "object" && typeof Reflect.decorate === "function") r = Reflect.decorate(decorators, target, key, desc);
    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;
    return c > 3 && r && Object.defineProperty(target, key, r), r;
};
var __metadata = (this && this.__metadata) || function (k, v) {
    if (typeof Reflect === "object" && typeof Reflect.metadata === "function") return Reflect.metadata(k, v);
};
var __param = (this && this.__param) || function (paramIndex, decorator) {
    return function (target, key) { decorator(target, key, paramIndex); }
};
// Copyright (c) 2017 Queensland Cyber Infrastructure Foundation (http://www.qcif.edu.au/)
//
// GNU GENERAL PUBLIC LICENSE
//    Version 2, June 1991
//
// This program is free software; you can redistribute it and/or modify
// it under the terms of the GNU General Public License as published by
// the Free Software Foundation; either version 2 of the License, or
// (at your option) any later version.
//
// This program is distributed in the hope that it will be useful,
// but WITHOUT ANY WARRANTY; without even the implied warranty of
// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
// GNU General Public License for more details.
//
// You should have received a copy of the GNU General Public License along
// with this program; if not, write to the Free Software Foundation, Inc.,
// 51 Franklin Street, Fifth Floor, Boston, MA 02110-1301 USA.










/**
 *  Vocab Model
 *
 *
 * @author <a target='_' href='https://github.com/shilob'>Shilo Banihit</a>
 *
 */
var ANDSVocabField = /** @class */ (function (_super) {
    __extends(ANDSVocabField, _super);
    function ANDSVocabField(options, injector) {
        var _this = _super.call(this, options, injector) || this;
        _this.value = options['value'] || _this.setEmptyValue();
        _this.vocabId = options['vocabId'] || 'anzsrc-for';
        _this.andsService = _this.getFromInjector(__WEBPACK_IMPORTED_MODULE_3__ands_service__["a" /* ANDSService */]);
        return _this;
    }
    ANDSVocabField.prototype.setValue = function (value, emitEvent) {
        if (emitEvent === void 0) { emitEvent = true; }
        this.formModel.setValue(value, { emitEvent: emitEvent, emitModelToViewChange: true });
        this.formModel.markAsTouched();
        this.formModel.markAsDirty();
    };
    ANDSVocabField.prototype.setEmptyValue = function () {
        this.value = [];
        return this.value;
    };
    ANDSVocabField.prototype.setSelected = function (item, flag) {
        var curVal = this.formModel.value;
        if (flag) {
            curVal.push(item);
        }
        else {
            __WEBPACK_IMPORTED_MODULE_5_lodash_es__["remove"](curVal, function (entry) {
                return entry.notation == item.notation;
            });
        }
        this.setValue(curVal);
    };
    return ANDSVocabField;
}(__WEBPACK_IMPORTED_MODULE_2__field_base__["a" /* FieldBase */]));

/**
* Component utilising the ANDS Vocabb selector widget
*
*
*
*
*/
var ANDSVocabComponent = /** @class */ (function (_super) {
    __extends(ANDSVocabComponent, _super);
    function ANDSVocabComponent(elementRef) {
        var _this = _super.call(this) || this;
        _this.treeData = [];
        _this.expandNodeIds = [];
        _this.STATUS_INIT = 0;
        _this.STATUS_LOADING = 1;
        _this.STATUS_LOADED = 2;
        _this.STATUS_EXPANDING = 3;
        _this.STATUS_EXPANDED = 4;
        _this.elementRef = elementRef;
        _this.treeData = [];
        _this.options = {
            useCheckbox: true,
            useTriState: false,
            getChildren: _this.getChildren.bind(_this),
            scrollContainer: document.body.parentElement
        };
        _this.nodeEventSubject = new __WEBPACK_IMPORTED_MODULE_7_rxjs_Subject__["a" /* Subject */]();
        _this.loadState = _this.STATUS_INIT;
        return _this;
    }
    ANDSVocabComponent.prototype.ngOnInit = function () {
        if (this.field.editMode) {
            jQuery(this.elementRef.nativeElement)['vocab_widget']({
                repository: this.field.vocabId,
                endpoint: 'https://vocabs.ands.org.au/apps/vocab_widget/proxy/',
                fields: ["label", "notation", "about"],
                cache: false
            });
            this.field.componentReactors.push(this);
        }
    };
    ANDSVocabComponent.prototype.ngAfterViewInit = function () {
        var _this = this;
        if (this.field.editMode) {
            var that_1 = this;
            if (this.loadState == this.STATUS_INIT) {
                this.loadState = this.STATUS_LOADING;
                jQuery(this.elementRef.nativeElement).on('top.vocab.ands', function (event, data) {
                    if (__WEBPACK_IMPORTED_MODULE_5_lodash_es__["isEmpty"](that_1.treeData)) {
                        that_1.treeData = that_1.mapItemsToChildren(data.items);
                        that_1.loadState = that_1.STATUS_LOADED;
                    }
                });
                jQuery(this.elementRef.nativeElement)['vocab_widget']('top');
                this.nodeEventSubject.bufferTime(1000)
                    .filter(function (eventArr) {
                    return eventArr.length > 0;
                })
                    .subscribe(function (eventArr) {
                    _this.handleNodeEvent(eventArr);
                });
                this.startTreeInit();
            }
        }
    };
    ANDSVocabComponent.prototype.startTreeInit = function () {
        var _this = this;
        this.treeInitListener = __WEBPACK_IMPORTED_MODULE_6_rxjs_Observable__["a" /* Observable */].interval(1000).subscribe(function () {
            if (!__WEBPACK_IMPORTED_MODULE_5_lodash_es__["isEmpty"](_this.expandNodeIds)) {
                _this.expandNodes();
            }
            else if (!__WEBPACK_IMPORTED_MODULE_5_lodash_es__["isEmpty"](_this.andsTree.treeModel.getVisibleRoots()) && _this.loadState == _this.STATUS_LOADED) {
                _this.loadState = _this.STATUS_EXPANDING;
                _this.updateTreeView(_this);
                _this.expandNodes();
            }
            else if (_this.loadState == _this.STATUS_EXPANDING) {
                _this.treeInitListener.unsubscribe();
                _this.loadState = _this.STATUS_EXPANDED;
            }
        });
    };
    ANDSVocabComponent.prototype.onEvent = function (event) {
        switch (event.eventName) {
            case "select":
                this.field.setSelected(this.getValueFromChildData(event.node), true);
                break;
            case "deselect":
                this.field.setSelected(this.getValueFromChildData(event.node), false);
                break;
        }
    };
    ANDSVocabComponent.prototype.handleNodeEvent = function (eventArr) {
        var event = eventArr[0];
        if (eventArr.length >= 2) {
            event = eventArr[1];
        }
        var currentState = this.getNodeSelected(event.node.id);
        switch (event.eventName) {
            case "nodeActivate":
                if (currentState == undefined) {
                    currentState = true;
                }
                else {
                    currentState = false;
                }
                this.updateSingleNodeSelectedState(event.node, currentState);
                break;
            case "nodeDeactivate":
                this.updateSingleNodeSelectedState(event.node, false);
                break;
        }
    };
    ANDSVocabComponent.prototype.updateSingleNodeSelectedState = function (node, state) {
        var nodeId = node.id;
        var curState = this.andsTree.treeModel.getState();
        this.setNodeSelected(curState, nodeId, state);
        this.andsTree.treeModel.setState(curState);
        this.andsTree.treeModel.update();
        this.field.setSelected(this.getValueFromChildData(node), state);
    };
    ANDSVocabComponent.prototype.onNodeActivate = function (event) {
        this.nodeEventSubject.next(event);
    };
    ANDSVocabComponent.prototype.onNodeDeactivate = function (event) {
        this.nodeEventSubject.next(event);
    };
    ANDSVocabComponent.prototype.updateTreeView = function (that) {
        var _this = this;
        var state = that.andsTree.treeModel.getState();
        that.expandNodeIds = [];
        __WEBPACK_IMPORTED_MODULE_5_lodash_es__["each"](that.field.value, function (val) {
            _this.setNodeSelected(state, val.notation, true);
            __WEBPACK_IMPORTED_MODULE_5_lodash_es__["each"](val.geneaology, function (parentId) {
                if (!__WEBPACK_IMPORTED_MODULE_5_lodash_es__["includes"](that.expandNodeIds, parentId)) {
                    that.expandNodeIds.push(parentId);
                }
            });
        });
        that.andsTree.treeModel.setState(state);
        that.andsTree.treeModel.update();
        that.expandNodeIds = __WEBPACK_IMPORTED_MODULE_5_lodash_es__["sortBy"](that.expandNodeIds, function (o) { return __WEBPACK_IMPORTED_MODULE_5_lodash_es__["isString"](o) ? o.length : 0; });
    };
    ANDSVocabComponent.prototype.expandNodes = function () {
        if (!__WEBPACK_IMPORTED_MODULE_5_lodash_es__["isEmpty"](this.expandNodeIds)) {
            var parentId_1 = this.expandNodeIds[0];
            var node = this.andsTree.treeModel.getNodeById(parentId_1);
            if (node) {
                node.expand();
                __WEBPACK_IMPORTED_MODULE_5_lodash_es__["remove"](this.expandNodeIds, function (id) { return id == parentId_1; });
            }
        }
    };
    ANDSVocabComponent.prototype.collapseNodes = function () {
        this.andsTree.treeModel.collapseAll();
    };
    ANDSVocabComponent.prototype.setNodeSelected = function (state, nodeId, flag) {
        if (flag) {
            state.selectedLeafNodeIds[nodeId] = flag;
        }
        else {
            __WEBPACK_IMPORTED_MODULE_5_lodash_es__["unset"](state.selectedLeafNodeIds, nodeId);
        }
    };
    ANDSVocabComponent.prototype.getNodeSelected = function (nodeId) {
        return this.andsTree.treeModel.getState().selectedLeafNodeIds[nodeId];
    };
    ANDSVocabComponent.prototype.getChildren = function (node) {
        var _this = this;
        var that = this;
        var promise = new Promise(function (resolve, reject) {
            jQuery(_this.elementRef.nativeElement).on('narrow.vocab.ands', function (event, data) {
                return resolve(that.mapItemsToChildren(data.items));
            });
        });
        jQuery(this.elementRef.nativeElement)['vocab_widget']('narrow', { uri: node.data.about });
        return promise;
    };
    ANDSVocabComponent.prototype.mapItemsToChildren = function (items) {
        return __WEBPACK_IMPORTED_MODULE_5_lodash_es__["map"](items, function (item) {
            return __assign({ id: item.notation, name: item.notation + " - " + item.label, hasChildren: item.narrower && item.narrower.length > 0 }, item);
        });
    };
    ANDSVocabComponent.prototype.getValueFromChildData = function (childNode) {
        var data = childNode.data;
        var val = { name: data.notation + " - " + data.label, label: data.label, notation: data.notation };
        this.setParentTree(val, childNode);
        return val;
    };
    ANDSVocabComponent.prototype.setParentTree = function (val, childNode) {
        var parentNotation = __WEBPACK_IMPORTED_MODULE_5_lodash_es__["get"](childNode, 'parent.data.notation');
        if (!__WEBPACK_IMPORTED_MODULE_5_lodash_es__["isUndefined"](parentNotation)) {
            if (__WEBPACK_IMPORTED_MODULE_5_lodash_es__["isUndefined"](val['geneaology'])) {
                val['geneaology'] = [];
            }
            val['geneaology'].push(parentNotation);
            if (childNode.parent.parent) {
                this.setParentTree(val, childNode.parent);
            }
        }
        else if (!__WEBPACK_IMPORTED_MODULE_5_lodash_es__["isUndefined"](val['geneaology'])) {
            val['geneaology'] = __WEBPACK_IMPORTED_MODULE_5_lodash_es__["sortBy"](val['geneaology']);
        }
    };
    ANDSVocabComponent.prototype.reactEvent = function (eventName, eventData, origData, elem) {
        this.collapseNodes();
        this.loadState = this.STATUS_LOADED;
        this.startTreeInit();
    };
    __decorate([
        Object(__WEBPACK_IMPORTED_MODULE_0__angular_core__["ViewChild"])('andsTree'),
        __metadata("design:type", __WEBPACK_IMPORTED_MODULE_4_angular_tree_component__["a" /* TreeComponent */])
    ], ANDSVocabComponent.prototype, "andsTree", void 0);
    ANDSVocabComponent = __decorate([
        Object(__WEBPACK_IMPORTED_MODULE_0__angular_core__["Component"])({
            selector: 'ands-vocab-selector',
            template: __webpack_require__("./redbox-portal/angular/shared/form/field-andsvocab.html"),
            styles: ['span.node-name { font-size: 300%; }']
        }),
        __param(0, Object(__WEBPACK_IMPORTED_MODULE_0__angular_core__["Inject"])(__WEBPACK_IMPORTED_MODULE_0__angular_core__["ElementRef"])),
        __metadata("design:paramtypes", [__WEBPACK_IMPORTED_MODULE_0__angular_core__["ElementRef"]])
    ], ANDSVocabComponent);
    return ANDSVocabComponent;
}(__WEBPACK_IMPORTED_MODULE_1__field_simple_component__["l" /* SimpleComponent */]));



/***/ }),

/***/ "./redbox-portal/angular/shared/form/field-andsvocab.html":
/***/ (function(module, exports) {

module.exports = "<div *ngIf=\"!field.editMode\" class=\"key-value-pair\">\n  <span *ngIf=\"field.label\" class=\"key\">{{field.label}}</span>\n  <ul>\n    <li *ngFor=\"let value of field.value\">{{ value.notation }} - {{ value.label }}</li>\n  </ul>\n</div>\n<div *ngIf=\"field.editMode\" [formGroup]='form' [ngClass]=\"getGroupClass()\">\n  <label>\n    {{field.label}} {{getRequiredLabelStr()}}\n    <button type=\"button\" class=\"btn btn-default\" *ngIf=\"field.help\" (click)=\"toggleHelp()\"><span class=\"glyphicon glyphicon-question-sign\" aria-hidden=\"true\"></span></button>\n  </label>\n  <span id=\"{{ 'helpBlock_' + field.name }}\" class=\"help-block\" *ngIf=\"this.helpShow\" >{{field.help}}</span>\n  <tree-root *ngIf=\"field.editMode\"\n      #andsTree\n      class=\"reverse\"\n      id=\"andsTree\"\n      [nodes]=\"treeData\"\n      [options]=\"options\"\n      (nodeActivate)=\"onNodeActivate($event)\"\n      (nodeDeactivate)=\"onNodeDeactivate($event)\"\n      (event)=\"onEvent($event)\"\n      >\n  </tree-root>\n  <div class=\"text-danger\" *ngIf=\"hasRequiredError()\">{{field.validationMessages.required}}</div>\n</div>\n"

/***/ }),

/***/ "./redbox-portal/angular/shared/form/field-asynch.component.html":
/***/ (function(module, exports) {

module.exports = "<div *ngIf=\"isListening\">\n  <div>&nbsp;</div>\n  <h4> {{ field.label }} </h4>\n  <table class='table table-striped'>\n    <thead>\n      <tr>\n        <th>{{ field.nameLabel }} </th>\n        <th>{{ field.statusLabel }} </th>\n        <th>{{ field.completionLabel }} </th>\n        <th>{{ field.messageLabel }} </th>\n        <th>{{ field.dateStartedLabel }} </th>\n        <th>{{ field.startedByLabel }} </th>\n        <th>{{ field.lastUpdateLabel }} </th>\n        <th>{{ field.dateCompletedLabel }} </th>\n      </tr>\n    </thead>\n    <tbody>\n      <tr *ngFor=\"let progress of field.progressArr\">\n        <td>{{ progress.name }}</td>\n        <td>{{ field.getStatusLabel(progress.status) }}</td>\n        <td *ngIf=\"field.completionRateType == 'percentage'\">{{ progress.completionRate | percent:'1.0-0':locale }}</td>\n        <td>{{ progress.message }}</td>\n        <td>{{ formatDateForDisplay(progress.date_started) }}</td>\n        <td>{{ progress.started_by }}</td>\n        <td>{{ formatDateForDisplay(progress.updatedAt) }}</td>\n        <td>{{ formatDateForDisplay(progress.date_completed) }}</td>\n      </tr>\n    </tbody>\n  </table>\n</div>\n"

/***/ }),

/***/ "./redbox-portal/angular/shared/form/field-asynch.component.ts":
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "b", function() { return AsynchField; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "a", function() { return AsynchComponent; });
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__angular_core__ = __webpack_require__("./node_modules/@angular/core/esm5/core.js");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1__field_simple_component__ = __webpack_require__("./redbox-portal/angular/shared/form/field-simple.component.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2__field_simple__ = __webpack_require__("./redbox-portal/angular/shared/form/field-simple.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3__records_service__ = __webpack_require__("./redbox-portal/angular/shared/form/records.service.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_lodash_es__ = __webpack_require__("./node_modules/lodash-es/lodash.js");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5_rxjs_add_operator_bufferTime__ = __webpack_require__("./node_modules/rxjs/_esm5/add/operator/bufferTime.js");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_6_rxjs_add_operator_filter__ = __webpack_require__("./node_modules/rxjs/_esm5/add/operator/filter.js");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_7_moment_es6__ = __webpack_require__("./node_modules/moment-es6/index.js");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_7_moment_es6___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_7_moment_es6__);
var __extends = (this && this.__extends) || (function () {
    var extendStatics = Object.setPrototypeOf ||
        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||
        function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };
    return function (d, b) {
        extendStatics(d, b);
        function __() { this.constructor = d; }
        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
    };
})();
var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {
    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
    if (typeof Reflect === "object" && typeof Reflect.decorate === "function") r = Reflect.decorate(decorators, target, key, desc);
    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;
    return c > 3 && r && Object.defineProperty(target, key, r), r;
};
var __metadata = (this && this.__metadata) || function (k, v) {
    if (typeof Reflect === "object" && typeof Reflect.metadata === "function") return Reflect.metadata(k, v);
};
// Copyright (c) 2017 Queensland Cyber Infrastructure Foundation (http://www.qcif.edu.au/)
//
// GNU GENERAL PUBLIC LICENSE
//    Version 2, June 1991
//
// This program is free software; you can redistribute it and/or modify
// it under the terms of the GNU General Public License as published by
// the Free Software Foundation; either version 2 of the License, or
// (at your option) any later version.
//
// This program is distributed in the hope that it will be useful,
// but WITHOUT ANY WARRANTY; without even the implied warranty of
// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
// GNU General Public License for more details.
//
// You should have received a copy of the GNU General Public License along
// with this program; if not, write to the Free Software Foundation, Inc.,
// 51 Franklin Street, Fifth Floor, Boston, MA 02110-1301 USA.








/**
 * Async / background tasks field
 *
 * @author <a target='_' href='https://github.com/shilob'>Shilo Banihit</a>
 *
 */
var AsynchField = /** @class */ (function (_super) {
    __extends(AsynchField, _super);
    function AsynchField(options, injector) {
        var _this = _super.call(this, options, injector) || this;
        _this.relatedRecordId = options['relatedRecordId'] || undefined;
        _this.completionRateType = options['completionRateType'] || 'percentage';
        _this.nameLabel = options['nameLabel'] ? _this.getTranslated(options['nameLabel'], options['nameLabel']) : 'Name';
        _this.statusLabel = options['statusLabel'] ? _this.getTranslated(options['statusLabel'], options['statusLabel']) : 'Status';
        _this.dateStartedLabel = options['dateStartedLabel'] ? _this.getTranslated(options['dateStartedLabel'], options['dateStartedLabel']) : 'Date Started';
        _this.dateCompletedLabel = options['dateCompletedLabel'] ? _this.getTranslated(options['dateCompletedLabel'], options['dateCompletedLabel']) : 'Date Completed';
        _this.startedByLabel = options['startedByLabel'] ? _this.getTranslated(options['startedByLabel'], options['startedByLabel']) : 'Started By';
        _this.messageLabel = options['messageLabel'] ? _this.getTranslated(options['messageLabel'], options['messageLabel']) : 'Message';
        _this.completionLabel = options['completionLabel'] ? _this.getTranslated(options['completionLabel'], options['completionLabel']) : 'Completion';
        _this.lastUpdateLabel = options['lastUpdateLabel'] ? _this.getTranslated(options['lastUpdateLabel'], options['lastUpdateLabel']) : 'Last Updated';
        _this.dateFormat = options['dateFormat'] || 'L LT';
        _this.listenType = options['listenType'] || "record"; // listens to record wide
        _this.taskType = options['taskType'] || '';
        _this.criteria = options['criteria'] || { where: { relatedRecordId: '@oid' } }; // defaults to all happenings for this oid
        _this.RecordsService = _this.getFromInjector(__WEBPACK_IMPORTED_MODULE_3__records_service__["a" /* RecordsService */]);
        return _this;
    }
    AsynchField.prototype.getStatusLabel = function (status) {
        return this.getTranslated(this.options.statusLabel + "-" + status, status);
    };
    return AsynchField;
}(__WEBPACK_IMPORTED_MODULE_2__field_simple__["i" /* NotInFormField */]));

/**
*
* Component to display asynchronous processes
*
*
*/
var AsynchComponent = /** @class */ (function (_super) {
    __extends(AsynchComponent, _super);
    function AsynchComponent(changeRef) {
        var _this = _super.call(this) || this;
        _this.changeRef = changeRef;
        _this.locale = window.navigator.language;
        return _this;
    }
    AsynchComponent.prototype.ngOnInit = function () {
        var oid = this.field.relatedRecordId || this.field.fieldMap._rootComp.oid;
        var that = this;
        if (__WEBPACK_IMPORTED_MODULE_4_lodash_es__["isNull"](oid) || __WEBPACK_IMPORTED_MODULE_4_lodash_es__["isUndefined"](oid) || __WEBPACK_IMPORTED_MODULE_4_lodash_es__["isEmpty"](oid)) {
            // wait for the OID to be set when record is created
            if (!this.field.fieldMap._rootComp.getSubscription('recordCreated')) {
                console.log("Subscribing to record creation..... " + this.field.name);
                this.field.fieldMap._rootComp.subscribe('recordCreated', this.field.name, function (createdInfo) {
                    that.field.relatedRecordId = createdInfo.oid;
                    that.startListen();
                });
            }
        }
        if (oid) {
            this.field.relatedRecordId = this.field.fieldMap._rootComp.oid;
            this.startListen();
        }
    };
    AsynchComponent.prototype.startListen = function () {
        var _this = this;
        if (!this.isListening && (!__WEBPACK_IMPORTED_MODULE_4_lodash_es__["isUndefined"](this.field.relatedRecordId) && !__WEBPACK_IMPORTED_MODULE_4_lodash_es__["isEmpty"](this.field.relatedRecordId))) {
            var fq = JSON.stringify(this.field.criteria).replace(/@oid/g, this.field.relatedRecordId);
            this.field.RecordsService.getAsyncProgress(fq).then(function (progressArr) {
                __WEBPACK_IMPORTED_MODULE_4_lodash_es__["each"](progressArr, function (progress) {
                    progress.completionRate = progress.currentIdx / progress.targetIdx;
                    if (_this.field.listenType == "progress") {
                        _this.field.RecordsService.subscribeToAsyncProgress(progress.id, function (data, socketRes) {
                            console.log("Subscribed to async tasks: " + progress.id);
                            console.log(data);
                            console.log(socketRes);
                        });
                    }
                });
                if (_this.field.listenType == "record") {
                    _this.field.RecordsService.subscribeToAsyncProgress(_this.field.relatedRecordId, function (data, socketRes) {
                        console.log("Subscribed to async tasks for record: " + _this.field.relatedRecordId);
                        console.log(data);
                        console.log(socketRes);
                    });
                }
                else if (_this.field.listenType == "taskType") {
                    _this.field.RecordsService.subscribeToAsyncProgress(_this.field.relatedRecordId + "-" + _this.field.taskType, function (data, socketRes) {
                        console.log("Subscribed to async tasks for record with taskType: " + _this.field.relatedRecordId + "-" + _this.field.taskType);
                        console.log(data);
                        console.log(socketRes);
                    });
                }
                io.socket.on('start', _this.onStart.bind(_this));
                io.socket.on('stop', _this.onStop.bind(_this));
                io.socket.on('update', _this.onUpdate.bind(_this));
                _this.field.progressArr = progressArr;
                _this.isListening = true;
            });
        }
    };
    AsynchComponent.prototype.onStart = function (progress) {
        console.log("Got start event:");
        console.log(progress);
        this.field.progressArr ? this.field.progressArr.push(progress) : this.field.progressArr = [progress];
        this.changeRef.detectChanges();
    };
    AsynchComponent.prototype.onStop = function (progress) {
        console.log("Got stop event:");
        console.log(progress);
        this.updateProgress(progress);
    };
    AsynchComponent.prototype.onUpdate = function (progress) {
        console.log("Got update event:");
        console.log(progress);
        this.updateProgress(progress);
    };
    AsynchComponent.prototype.updateProgress = function (progress) {
        var targetProgress = __WEBPACK_IMPORTED_MODULE_4_lodash_es__["find"](this.field.progressArr, function (prog) { return prog.id == progress.id; });
        __WEBPACK_IMPORTED_MODULE_4_lodash_es__["assign"](targetProgress, progress);
        this.changeRef.detectChanges();
    };
    AsynchComponent.prototype.formatDateForDisplay = function (value) {
        return value ? __WEBPACK_IMPORTED_MODULE_7_moment_es6___default()(value).locale(this.locale).format(this.field.dateFormat) : '';
    };
    AsynchComponent = __decorate([
        Object(__WEBPACK_IMPORTED_MODULE_0__angular_core__["Component"])({
            selector: 'asynch-component',
            template: __webpack_require__("./redbox-portal/angular/shared/form/field-asynch.component.html")
        }),
        __metadata("design:paramtypes", [__WEBPACK_IMPORTED_MODULE_0__angular_core__["ChangeDetectorRef"]])
    ], AsynchComponent);
    return AsynchComponent;
}(__WEBPACK_IMPORTED_MODULE_1__field_simple_component__["l" /* SimpleComponent */]));



/***/ }),

/***/ "./redbox-portal/angular/shared/form/field-base.ts":
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "a", function() { return FieldBase; });
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__angular_core__ = __webpack_require__("./node_modules/@angular/core/esm5/core.js");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1__angular_forms__ = __webpack_require__("./node_modules/@angular/forms/esm5/forms.js");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2__translation_service__ = __webpack_require__("./redbox-portal/angular/shared/translation-service.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_lodash_es__ = __webpack_require__("./node_modules/lodash-es/lodash.js");
// Copyright (c) 2017 Queensland Cyber Infrastructure Foundation (http://www.qcif.edu.au/)
//
// GNU GENERAL PUBLIC LICENSE
//    Version 2, June 1991
//
// This program is free software; you can redistribute it and/or modify
// it under the terms of the GNU General Public License as published by
// the Free Software Foundation; either version 2 of the License, or
// (at your option) any later version.
//
// This program is distributed in the hope that it will be useful,
// but WITHOUT ANY WARRANTY; without even the implied warranty of
// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
// GNU General Public License for more details.
//
// You should have received a copy of the GNU General Public License along
// with this program; if not, write to the Free Software Foundation, Inc.,
// 51 Franklin Street, Fifth Floor, Boston, MA 02110-1301 USA.
var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {
    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
    if (typeof Reflect === "object" && typeof Reflect.decorate === "function") r = Reflect.decorate(decorators, target, key, desc);
    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;
    return c > 3 && r && Object.defineProperty(target, key, r), r;
};
var __metadata = (this && this.__metadata) || function (k, v) {
    if (typeof Reflect === "object" && typeof Reflect.metadata === "function") return Reflect.metadata(k, v);
};




/**
 * Base class for dynamic form models...
 *
 * Author: <a href='https://github.com/shilob' target='_blank'>Shilo Banihit</a>
 *
 */
var FieldBase = /** @class */ (function () {
    function FieldBase(options, injector) {
        if (options === void 0) { options = {}; }
        this.componentReactors = [];
        this.onValueUpdate = new __WEBPACK_IMPORTED_MODULE_0__angular_core__["EventEmitter"]();
        this.onValueLoaded = new __WEBPACK_IMPORTED_MODULE_0__angular_core__["EventEmitter"]();
        this.injector = injector;
        this.translationService = this.getFromInjector(__WEBPACK_IMPORTED_MODULE_2__translation_service__["a" /* TranslationService */]);
        this.setOptions(options);
        this.validators = null;
    }
    FieldBase.prototype.getFromInjector = function (token) {
        return this.injector.get(token);
    };
    FieldBase.prototype.setOptions = function (options) {
        var _this = this;
        if (options === void 0) { options = {}; }
        this.value = this.getTranslated(options.value, undefined);
        this.name = options.name || '';
        this.id = options.id || '';
        this.label = this.getTranslated(options.label, '');
        this.help = this.getTranslated(options.help, undefined);
        this.required = !!options.required;
        this.controlType = options.controlType || '';
        this.cssClasses = options.cssClasses || {}; // array of
        this.groupClasses = options['groupClasses'] || '';
        this.groupName = options.groupName || null;
        this.editMode = __WEBPACK_IMPORTED_MODULE_3_lodash_es__["isUndefined"](options.editMode) ? false : options.editMode;
        this.readOnly = __WEBPACK_IMPORTED_MODULE_3_lodash_es__["isUndefined"](options.readOnly) ? false : options.readOnly;
        this.onChange = options['onChange'] || null;
        this.publish = options['publish'] || null;
        this.subscribe = options['subscribe'] || null;
        this.visible = __WEBPACK_IMPORTED_MODULE_3_lodash_es__["isUndefined"](options['visible']) ? true : options['visible'];
        this.visibilityCriteria = options['visibilityCriteria'];
        if (this.groupName) {
            this.hasGroup = true;
        }
        this.options = options;
        this.hasControl = true;
        this.validationMessages = {};
        __WEBPACK_IMPORTED_MODULE_3_lodash_es__["forOwn"](options['validationMessages'] || {}, function (messageKey, messageName) {
            _this.validationMessages[messageName] = _this.getTranslated(messageKey, messageKey);
        });
        this.defaultValue = this.getTranslated(options.defaultValue, undefined);
        if ((__WEBPACK_IMPORTED_MODULE_3_lodash_es__["isUndefined"](this.value) || __WEBPACK_IMPORTED_MODULE_3_lodash_es__["isEmpty"](this.value)) && !__WEBPACK_IMPORTED_MODULE_3_lodash_es__["isUndefined"](this.defaultValue)) {
            this.value = this.defaultValue;
        }
    };
    FieldBase.prototype.getTranslated = function (key, defValue) {
        if (!__WEBPACK_IMPORTED_MODULE_3_lodash_es__["isEmpty"](key) && !__WEBPACK_IMPORTED_MODULE_3_lodash_es__["isUndefined"](key)) {
            if (__WEBPACK_IMPORTED_MODULE_3_lodash_es__["isFunction"](key.startsWith) && key.startsWith('@') && this.translationService) {
                return this.translationService.t(key);
            }
            else {
                return key;
            }
        }
        else {
            return defValue;
        }
    };
    Object.defineProperty(FieldBase.prototype, "isValid", {
        get: function () {
            if (this.form && this.form.controls) {
                return this.form.controls[this.name].valid;
            }
            return false;
        },
        enumerable: true,
        configurable: true
    });
    FieldBase.prototype.createFormModel = function (valueElem) {
        if (valueElem === void 0) { valueElem = null; }
        if (valueElem) {
            this.value = valueElem;
        }
        if (this.required) {
            this.validators = __WEBPACK_IMPORTED_MODULE_1__angular_forms__["i" /* Validators */].required;
        }
        this.formModel = new __WEBPACK_IMPORTED_MODULE_1__angular_forms__["b" /* FormControl */](this.value || '', this.validators);
        return this.formModel;
    };
    /**
     * Creates a control group and populates field map with:
     *
     * fieldMap[name].control = the NG2 FormControl
     * fieldMap[name].field = the Field model (this)
     *
     * Author: <a href='https://github.com/shilob' target='_blank'>Shilo Banihit</a>
     * @param  {any} group
     * @param  {any} fieldMap
     * @return {any}
     */
    FieldBase.prototype.getGroup = function (group, fieldMap) {
        this.fieldMap = fieldMap;
        var retval = null;
        __WEBPACK_IMPORTED_MODULE_3_lodash_es__["set"](fieldMap, this.getFullFieldName() + ".field", this);
        var control = this.createFormModel();
        __WEBPACK_IMPORTED_MODULE_3_lodash_es__["set"](fieldMap, this.getFullFieldName() + ".control", control);
        if (this.hasGroup && this.groupName) {
            if (group[this.groupName]) {
                group[this.groupName].addControl(this.name, control);
            }
            else {
                var fg = {};
                fg[this.name] = control;
                group[this.groupName] = new __WEBPACK_IMPORTED_MODULE_1__angular_forms__["c" /* FormGroup */](fg);
            }
            retval = group[this.groupName];
        }
        else {
            if (this.hasControl) {
                group[this.name] = control;
                retval = group[this.name];
            }
        }
        return retval;
    };
    FieldBase.prototype.triggerValidation = function () {
        if (this.formModel) {
            this.formModel.markAsTouched();
            this.formModel.updateValueAndValidity({ onlySelf: false, emitEvent: false });
        }
    };
    FieldBase.prototype.valueNotNull = function (data) {
        return !__WEBPACK_IMPORTED_MODULE_3_lodash_es__["isNull"](data) && (__WEBPACK_IMPORTED_MODULE_3_lodash_es__["isArray"](data) ? (!__WEBPACK_IMPORTED_MODULE_3_lodash_es__["isNull"](data[0])) : true);
    };
    FieldBase.prototype.setupEventHandlers = function () {
        var _this = this;
        var publishConfig = this.publish;
        var subscribeConfig = this.subscribe;
        if (!__WEBPACK_IMPORTED_MODULE_3_lodash_es__["isEmpty"](this.formModel)) {
            if (!__WEBPACK_IMPORTED_MODULE_3_lodash_es__["isEmpty"](publishConfig)) {
                __WEBPACK_IMPORTED_MODULE_3_lodash_es__["forOwn"](publishConfig, function (eventConfig, eventName) {
                    var eventSource = eventConfig.modelEventSource;
                    _this.formModel[eventSource].subscribe(function (value) {
                        if (_this.valueNotNull(value)) {
                            var emitData_1 = value;
                            if (!__WEBPACK_IMPORTED_MODULE_3_lodash_es__["isEmpty"](eventConfig.fields)) {
                                if (__WEBPACK_IMPORTED_MODULE_3_lodash_es__["isArray"](value)) {
                                    emitData_1 = [];
                                    __WEBPACK_IMPORTED_MODULE_3_lodash_es__["each"](value, function (v) {
                                        if (!__WEBPACK_IMPORTED_MODULE_3_lodash_es__["isEmpty"](v)) {
                                            var item_1 = {};
                                            __WEBPACK_IMPORTED_MODULE_3_lodash_es__["each"](eventConfig.fields, function (f) {
                                                __WEBPACK_IMPORTED_MODULE_3_lodash_es__["forOwn"](f, function (src, tgt) {
                                                    item_1[tgt] = __WEBPACK_IMPORTED_MODULE_3_lodash_es__["get"](v, src);
                                                });
                                            });
                                            emitData_1.push(item_1);
                                        }
                                    });
                                }
                                else {
                                    emitData_1 = {};
                                    if (!__WEBPACK_IMPORTED_MODULE_3_lodash_es__["isEmpty"](value)) {
                                        __WEBPACK_IMPORTED_MODULE_3_lodash_es__["each"](eventConfig.fields, function (f) {
                                            __WEBPACK_IMPORTED_MODULE_3_lodash_es__["forOwn"](f, function (src, tgt) {
                                                emitData_1[tgt] = __WEBPACK_IMPORTED_MODULE_3_lodash_es__["get"](value, src);
                                            });
                                        });
                                    }
                                }
                            }
                            console.log("Emitting data:");
                            console.log(emitData_1);
                            _this.emitEvent(eventName, emitData_1, value);
                        }
                    });
                });
            }
        }
        if (!__WEBPACK_IMPORTED_MODULE_3_lodash_es__["isEmpty"](subscribeConfig)) {
            __WEBPACK_IMPORTED_MODULE_3_lodash_es__["forOwn"](subscribeConfig, function (subConfig, srcName) {
                __WEBPACK_IMPORTED_MODULE_3_lodash_es__["forOwn"](subConfig, function (eventConfArr, eventName) {
                    var eventEmitter = _this.getEventEmitter(eventName, srcName);
                    eventEmitter.subscribe(function (value) {
                        var curValue = value;
                        if (__WEBPACK_IMPORTED_MODULE_3_lodash_es__["isArray"](value)) {
                            curValue = [];
                            __WEBPACK_IMPORTED_MODULE_3_lodash_es__["each"](value, function (v) {
                                var entryVal = v;
                                __WEBPACK_IMPORTED_MODULE_3_lodash_es__["each"](eventConfArr, function (eventConf) {
                                    var fn = __WEBPACK_IMPORTED_MODULE_3_lodash_es__["get"](_this, eventConf.action);
                                    if (fn) {
                                        var boundFunction = fn;
                                        if (eventConf.action.indexOf(".") == -1) {
                                            boundFunction = fn.bind(_this);
                                        }
                                        else {
                                            var objectName = eventConf.action.substring(0, eventConf.action.indexOf("."));
                                            boundFunction = fn.bind(_this[objectName]);
                                        }
                                        entryVal = boundFunction(entryVal, eventConf);
                                    }
                                });
                                if (!__WEBPACK_IMPORTED_MODULE_3_lodash_es__["isEmpty"](entryVal)) {
                                    curValue.push(entryVal);
                                }
                            });
                        }
                        else {
                            __WEBPACK_IMPORTED_MODULE_3_lodash_es__["each"](eventConfArr, function (eventConf) {
                                var fn = __WEBPACK_IMPORTED_MODULE_3_lodash_es__["get"](_this, eventConf.action);
                                if (fn) {
                                    var boundFunction = fn;
                                    if (eventConf.action.indexOf(".") == -1) {
                                        boundFunction = fn.bind(_this);
                                    }
                                    else {
                                        var objectName = eventConf.action.substring(0, eventConf.action.indexOf("."));
                                        boundFunction = fn.bind(_this[objectName]);
                                    }
                                    curValue = boundFunction(curValue, eventConf);
                                }
                            });
                        }
                        if (!__WEBPACK_IMPORTED_MODULE_3_lodash_es__["isUndefined"](curValue)) {
                            // cascade the event instance wide if only there's a valid value
                            _this.reactEvent(eventName, curValue, value);
                        }
                    });
                });
            });
        }
    };
    FieldBase.prototype.getEventEmitter = function (eventName, srcName) {
        if (srcName == "this") {
            return this[eventName];
        }
        if (srcName == "form") {
            return this.fieldMap['_rootComp'][eventName];
        }
        return this.fieldMap[srcName].field[eventName];
    };
    FieldBase.prototype.emitEvent = function (eventName, eventData, origData) {
        this[eventName].emit(eventData);
    };
    FieldBase.prototype.reactEvent = function (eventName, eventData, origData) {
        var _this = this;
        this.value = eventData;
        if (this.formModel) {
            this.formModel.setValue(eventData, { onlySelf: true, emitEvent: false });
        }
        __WEBPACK_IMPORTED_MODULE_3_lodash_es__["each"](this.componentReactors, function (compReact) {
            compReact.reactEvent(eventName, eventData, origData, _this);
        });
    };
    FieldBase.prototype.setFieldMapEntry = function (fieldMap, fieldCompRef) {
        if (!__WEBPACK_IMPORTED_MODULE_3_lodash_es__["isUndefined"](this.name) && !__WEBPACK_IMPORTED_MODULE_3_lodash_es__["isEmpty"](this.name) && !__WEBPACK_IMPORTED_MODULE_3_lodash_es__["isNull"](this.name)) {
            __WEBPACK_IMPORTED_MODULE_3_lodash_es__["set"](fieldMap, this.getFullFieldName() + ".instance", fieldCompRef.instance);
        }
    };
    FieldBase.prototype.getFullFieldName = function (name) {
        if (name === void 0) { name = null; }
        var fldName = "" + (name ? name : this.name);
        // console.log(`Using fldName: ${fldName}`);
        // console.log(this.fieldMap);
        return fldName;
    };
    FieldBase.prototype.getControl = function (name, fieldMap) {
        if (name === void 0) { name = null; }
        if (fieldMap === void 0) { fieldMap = null; }
        return __WEBPACK_IMPORTED_MODULE_3_lodash_es__["get"](fieldMap ? fieldMap : this.fieldMap, this.getFullFieldName(name) + ".control");
    };
    FieldBase.prototype.setValue = function (value, emitEvent) {
        if (emitEvent === void 0) { emitEvent = true; }
        this.value = value;
        this.formModel.setValue(value, { onlySelf: true, emitEvent: emitEvent });
    };
    FieldBase.prototype.toggleVisibility = function () {
        this.visible = !this.visible;
    };
    FieldBase.prototype.setVisibility = function (data) {
        if (__WEBPACK_IMPORTED_MODULE_3_lodash_es__["isObject"](this.visibilityCriteria) && this.visibilityCriteria.type == 'function') {
            var fn = __WEBPACK_IMPORTED_MODULE_3_lodash_es__["get"](this, this.visibilityCriteria.action);
            if (fn) {
                var boundFunction = fn;
                if (this.visibilityCriteria.action.indexOf(".") == -1) {
                    boundFunction = fn.bind(this);
                }
                else {
                    var objectName = this.visibilityCriteria.action.substring(0, this.visibilityCriteria.action.indexOf("."));
                    boundFunction = fn.bind(this[objectName]);
                }
                this.visible = boundFunction(data);
            }
        }
        else {
            this.visible = __WEBPACK_IMPORTED_MODULE_3_lodash_es__["isEqual"](data, this.visibilityCriteria);
        }
    };
    FieldBase.prototype.replaceValWithConfig = function (val) {
        __WEBPACK_IMPORTED_MODULE_3_lodash_es__["forOwn"](this.appConfig, function (configVal, configKey) {
            val = val.replace(new RegExp("@" + configKey, 'g'), configVal);
        });
        return val;
    };
    FieldBase.prototype.getConfigEntry = function (name, defValue) {
        return __WEBPACK_IMPORTED_MODULE_3_lodash_es__["isUndefined"](__WEBPACK_IMPORTED_MODULE_3_lodash_es__["get"](this.appConfig, name)) ? defValue : __WEBPACK_IMPORTED_MODULE_3_lodash_es__["get"](this.appConfig, name);
    };
    FieldBase.prototype.publishValueLoaded = function () {
        this.onValueLoaded.emit(this.value);
    };
    FieldBase.prototype.setRequiredAndClearValueOnFalse = function (flag) {
        this.required = flag;
        if (flag) {
            this.validators = __WEBPACK_IMPORTED_MODULE_1__angular_forms__["i" /* Validators */].required;
            this.formModel.setValidators(this.validators);
        }
        else {
            if (__WEBPACK_IMPORTED_MODULE_3_lodash_es__["isFunction"](this.validators) && __WEBPACK_IMPORTED_MODULE_3_lodash_es__["isEqual"](this.validators, __WEBPACK_IMPORTED_MODULE_1__angular_forms__["i" /* Validators */].required)) {
                this.validators = null;
            }
            this.formModel.clearValidators();
            this.formModel.setValue(null);
            this.value = null;
        }
    };
    __decorate([
        Object(__WEBPACK_IMPORTED_MODULE_0__angular_core__["Output"])(),
        __metadata("design:type", __WEBPACK_IMPORTED_MODULE_0__angular_core__["EventEmitter"])
    ], FieldBase.prototype, "onValueUpdate", void 0);
    __decorate([
        Object(__WEBPACK_IMPORTED_MODULE_0__angular_core__["Output"])(),
        __metadata("design:type", __WEBPACK_IMPORTED_MODULE_0__angular_core__["EventEmitter"])
    ], FieldBase.prototype, "onValueLoaded", void 0);
    return FieldBase;
}());



/***/ }),

/***/ "./redbox-portal/angular/shared/form/field-contributor.component.html":
/***/ (function(module, exports) {

module.exports = "<div *ngIf=\"field.editMode\" class='padding-bottom-10'>\n  <div class=\"row\" *ngIf=\"field.label && field.showHeader\">\n    <div class=\"col-xs-4\">\n      <h5>\n        {{field.label}} {{getRequiredLabelStr()}}\n        <button type=\"button\" class=\"btn btn-default\" *ngIf=\"field.help\" (click)=\"toggleHelp()\"><span class=\"glyphicon glyphicon-question-sign\" aria-hidden=\"true\"></span></button>\n      </h5>\n      <span id=\"{{ 'helpBlock_' + field.name }}\" class=\"help-block\" *ngIf=\"this.helpShow\" [innerHtml]=\"field.help\"></span>\n    </div>\n  </div>\n  <div class=\"row\">\n    <ng-container *ngIf=\"field.freeText\" [formGroup]='field.formModel'>\n      <!-- Free Text version -->\n      <!--\n      <ng-container >\n        <div [ngClass]=\"getGroupClass('name')\">\n          <input formControlName=\"name\" type=\"text\" class=\"form-control\"/>\n          <div class=\"text-danger\" *ngIf=\"field.formModel.controls['name'].touched && field.formModel.controls['name'].hasError('required')\">{{field.validationMessages.required.name}}</div>\n        </div>\n        <div [ngClass]=\"getGroupClass('email')\">\n          <input formControlName=\"email\" type=\"text\" class=\"form-control\" />\n          <div class=\"text-danger\" *ngIf=\"field.formModel.controls['email'].touched && field.formModel.controls['email'].hasError('email')\">{{field.validationMessages.invalid.email}}</div>\n          <div class=\"text-danger\" *ngIf=\"field.formModel.controls['email'].touched && field.formModel.controls['email'].hasError('required')\">{{field.validationMessages.required.email}}</div>\n        </div>\n        <div >\n          <input formControlName=\"orcid\" type=\"text\" class=\"form-control\"/>\n        </div>\n      </ng-container>  -->\n\n      <div *ngIf=\"!isEmbedded\">\n        <div class=\"row\">\n          <span class='col-xs-10' >\n            <!-- Free text not embedded version -->\n            <div class='col-xs-1'>\n              <span class='text-right'>{{ field.nameColHdr }}</span>\n            </div>\n            <div [ngClass]=\"getGroupClass('text_full_name')\">\n              <input formControlName=\"text_full_name\" type=\"text\" class=\"form-control\"/>\n              <div class=\"text-danger\" *ngIf=\"field.formModel.controls['text_full_name'].touched && field.formModel.controls['text_full_name'].hasError('required')\">{{field.validationMessages.required.text_full_name}}</div>\n            </div>\n            <div class='col-xs-1'>\n              <span class='text-right'>{{ field.emailColHdr }}</span>\n            </div>\n            <div [ngClass]=\"getGroupClass('email')\">\n              <input formControlName=\"email\" type=\"text\" class=\"form-control\" />\n              <div class=\"text-danger\" *ngIf=\"field.formModel.controls['email'].touched && field.formModel.controls['email'].hasError('email')\">{{field.validationMessages.invalid.email}}</div>\n              <div class=\"text-danger\" *ngIf=\"field.formModel.controls['email'].touched && field.formModel.controls['email'].hasError('required')\">{{field.validationMessages.required.email}}</div>\n            </div>\n            <div class='col-xs-1'>\n              <span class='text-right'>{{ field.orcidColHdr }}</span>\n            </div>\n            <div [ngClass]=\"getGroupClass('orcid')\">\n              <input formControlName=\"orcid\" type=\"text\" class=\"form-control\"/>\n            </div>\n          </span>\n        </div>\n      </div>\n\n      <ng-container *ngIf=\"isEmbedded\">\n        <!-- Embedded free text version -->\n        <div class='col-xs-1'>\n          <span class='text-right'>{{ field.nameColHdr }}</span>\n        </div>\n        <div [ngClass]=\"getGroupClass('text_full_name')\">\n          <input formControlName=\"text_full_name\" type=\"text\" class=\"form-control\"/>\n          <div class=\"text-danger\" *ngIf=\"field.formModel.controls['text_full_name'].touched && field.formModel.controls['text_full_name'].hasError('required')\">{{field.validationMessages.required.text_full_name}}</div>\n        </div>\n        <div class='col-xs-1'>\n          <span class='text-right'>{{ field.emailColHdr }}</span>\n        </div>\n        <div [ngClass]=\"getGroupClass('email')\">\n          <input formControlName=\"email\" type=\"text\" class=\"form-control\" />\n          <div class=\"text-danger\" *ngIf=\"field.formModel.controls['email'].touched && field.formModel.controls['email'].hasError('email')\">{{field.validationMessages.invalid.email}}</div>\n          <div class=\"text-danger\" *ngIf=\"field.formModel.controls['email'].touched && field.formModel.controls['email'].hasError('required')\">{{field.validationMessages.required.email}}</div>\n        </div>\n        <div class='col-xs-1'>\n          <span class='text-right'>{{ field.orcidColHdr }}</span>\n        </div>\n        <div [ngClass]=\"getGroupClass('orcid')\">\n          <input formControlName=\"orcid\" type=\"text\" class=\"form-control\" />\n        </div>\n      </ng-container>\n\n    </ng-container>\n    <!-- Lookup version -->\n    <ng-container *ngIf=\"!field.freeText\" [formGroup]=\"field.formModel\">\n      <div *ngIf=\"!isEmbedded\">\n        <div class=\"row\">\n          <span class='col-xs-10' >\n            <!-- Lookup Not Embedded version -->\n            <div class='col-xs-1'>\n              <span class='text-right'>{{ field.nameColHdr }}</span>\n            </div>\n            <div [ngClass]=\"getGroupClass('text_full_name')\">\n              <ng2-completer #ngCompleter [overrideSuggested]=\"!field.forceLookupOnly\" [inputClass]=\"'form-control'\" [placeholder]=\"field.vocabField.placeHolder\" [clearUnselected]=\"field.forceLookupOnly\" (selected)=\"onSelect($event)\" [datasource]=\"field.vocabField.dataService\" [minSearchLength]=\"0\" [initialValue]=\"field.vocabField.initialValue\"></ng2-completer>\n              <div class=\"text-danger\" *ngIf=\"field.formModel.controls['text_full_name'].hasError('required')\">{{field.validationMessages.required.text_full_name}}</div>\n            </div>\n            <div class='col-xs-1'>\n              <span class='text-right'>{{ field.emailColHdr }}</span>\n            </div>\n            <div [ngClass]=\"getGroupClass('email')\">\n              <input formControlName=\"email\" type=\"text\" class=\"form-control\" [readOnly]=\"field.forceLookupOnly\"/>\n              <div class=\"text-danger\" *ngIf=\"field.formModel.controls['email'].touched && field.formModel.controls['email'].hasError('email')\">{{field.validationMessages.invalid.email}}</div>\n              <div class=\"text-danger\" *ngIf=\"field.formModel.controls['email'].touched && field.formModel.controls['email'].hasError('required')\">{{field.validationMessages.required.email}}</div>\n            </div>\n            <div class='col-xs-1'>\n              <span class='text-right'>{{ field.orcidColHdr }}</span>\n            </div>\n            <div [ngClass]=\"getGroupClass('orcid')\">\n              <input formControlName=\"orcid\" type=\"text\" class=\"form-control\" />\n            </div>\n          </span>\n        </div>\n      </div>\n      <ng-container *ngIf=\"isEmbedded\">\n        <!-- Lookup Embedded version -->\n        <div class='col-xs-1'>\n          <span class='text-right'>{{ field.nameColHdr }}</span>\n        </div>\n        <div [ngClass]=\"getGroupClass('text_full_name')\">\n          <ng2-completer #ngCompleter [overrideSuggested]=\"!field.forceLookupOnly\" [inputClass]=\"'form-control'\" [placeholder]=\"field.vocabField.placeHolder\" [clearUnselected]=\"field.forceLookupOnly\" (selected)=\"onSelect($event)\" [datasource]=\"field.vocabField.dataService\" [minSearchLength]=\"0\" [initialValue]=\"field.vocabField.initialValue\"></ng2-completer>\n          <div class=\"text-danger\" *ngIf=\"field.formModel.controls['text_full_name'].hasError('required')\">{{field.validationMessages.required.text_full_name}}</div>\n        </div>\n        <div class='col-xs-1'>\n          <span class='text-right'>{{ field.emailColHdr }}</span>\n        </div>\n        <div [ngClass]=\"getGroupClass('email')\">\n          <input formControlName=\"email\" type=\"text\" class=\"form-control\" [readOnly]=\"field.forceLookupOnly\"/>\n          <div class=\"text-danger\" *ngIf=\"field.formModel.controls['email'].touched && field.formModel.controls['email'].hasError('email')\">{{field.validationMessages.invalid.email}}</div>\n          <div class=\"text-danger\" *ngIf=\"field.formModel.controls['email'].touched && field.formModel.controls['email'].hasError('required')\">{{field.validationMessages.required.email}}</div>\n        </div>\n        <div class='col-xs-1'>\n          <span class='text-right'>{{ field.orcidColHdr }}</span>\n        </div>\n        <div [ngClass]=\"getGroupClass('orcid')\">\n          <input formControlName=\"orcid\" type=\"text\" class=\"form-control\" />\n        </div>\n      </ng-container>\n    </ng-container>\n  </div>\n</div>\n<div *ngIf=\"!field.editMode\">\n  <label *ngIf=\"field.label\">{{field.label}}</label>\n  <div class=\"row\" *ngIf=\"field.showHeader\">\n\n    <div class=\"col-xs-3\"><label>{{field.nameColHdr}}</label></div>\n    <div [attr.class]=\"field.showRole? 'col-xs-3':'col-xs-4'\"><label>{{field.emailColHdr}}</label></div>\n    <div [attr.class]=\"field.showRole? 'col-xs-3':'hidden'\"><label>{{field.roleColHdr}}</label></div>\n    <div [attr.class]=\"field.showRole? 'col-xs-3':'col-xs-4'\"><label>{{field.orcidColHdr}}</label></div>\n  </div>\n  <div class=\"row\">\n    <div class=\"col-xs-3\">{{field.value.text_full_name}}</div>\n    <div [attr.class]=\"field.showRole? 'col-xs-3':'col-xs-4'\">{{field.value.email}}</div>\n    <div [attr.class]=\"field.showRole? 'col-xs-3':'hidden'\">{{field.value.role}}</div>\n    <div [attr.class]=\"field.showRole? 'col-xs-3':'col-xs-4'\">{{field.value.orcid}}</div>\n  </div>\n</div>\n"

/***/ }),

/***/ "./redbox-portal/angular/shared/form/field-contributor.component.ts":
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "b", function() { return ContributorField; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "a", function() { return ContributorComponent; });
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__angular_core__ = __webpack_require__("./node_modules/@angular/core/esm5/core.js");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1__field_simple_component__ = __webpack_require__("./redbox-portal/angular/shared/form/field-simple.component.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2__field_base__ = __webpack_require__("./redbox-portal/angular/shared/form/field-base.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3__angular_forms__ = __webpack_require__("./node_modules/@angular/forms/esm5/forms.js");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_lodash_es__ = __webpack_require__("./node_modules/lodash-es/lodash.js");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5__field_vocab_component__ = __webpack_require__("./redbox-portal/angular/shared/form/field-vocab.component.ts");
// Copyright (c) 2017 Queensland Cyber Infrastructure Foundation (http://www.qcif.edu.au/)
//
// GNU GENERAL PUBLIC LICENSE
//    Version 2, June 1991
//
// This program is free software; you can redistribute it and/or modify
// it under the terms of the GNU General Public License as published by
// the Free Software Foundation; either version 2 of the License, or
// (at your option) any later version.
//
// This program is distributed in the hope that it will be useful,
// but WITHOUT ANY WARRANTY; without even the implied warranty of
// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
// GNU General Public License for more details.
//
// You should have received a copy of the GNU General Public License along
// with this program; if not, write to the Free Software Foundation, Inc.,
// 51 Franklin Street, Fifth Floor, Boston, MA 02110-1301 USA.
var __extends = (this && this.__extends) || (function () {
    var extendStatics = Object.setPrototypeOf ||
        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||
        function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };
    return function (d, b) {
        extendStatics(d, b);
        function __() { this.constructor = d; }
        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
    };
})();
var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {
    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
    if (typeof Reflect === "object" && typeof Reflect.decorate === "function") r = Reflect.decorate(decorators, target, key, desc);
    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;
    return c > 3 && r && Object.defineProperty(target, key, r), r;
};
var __metadata = (this && this.__metadata) || function (k, v) {
    if (typeof Reflect === "object" && typeof Reflect.metadata === "function") return Reflect.metadata(k, v);
};






/**
 * Contributor Model
 *
 *
 * Author: <a href='https://github.com/shilob' target='_blank'>Shilo Banihit</a>
 *
 */
var ContributorField = /** @class */ (function (_super) {
    __extends(ContributorField, _super);
    function ContributorField(options, injector) {
        var _this = _super.call(this, options, injector) || this;
        _this.fullNameResponseField = "text_full_name";
        _this.clName = 'ContributorField';
        _this.controlType = 'textbox';
        _this.nameColHdr = options['nameColHdr'] ? _this.getTranslated(options['nameColHdr'], options['nameColHdr']) : 'Researcher Name';
        _this.emailColHdr = options['emailColHdr'] ? _this.getTranslated(options['emailColHdr'], options['emailColHdr']) : 'Email Address';
        _this.roleColHdr = options['roleColHdr'] ? _this.getTranslated(options['roleColHdr'], options['roleColHdr']) : 'Project Role';
        _this.orcidColHdr = options['orcidColHdr'] ? _this.getTranslated(options['orcidColHdr'], options['orcidColHdr']) : 'ORCID';
        _this.showHeader = options['showHeader'] || true;
        _this.showRole = options['showRole'] || true;
        _this.baseMarginTop = options['baseMarginTop'] || '45px';
        _this.roles = options['roles'] || [];
        _this.value = options['value'] || _this.setEmptyValue();
        _this.fieldNames = options['fieldNames'] || [];
        var textFullNameFieldName = __WEBPACK_IMPORTED_MODULE_4_lodash_es__["find"](_this.fieldNames, function (fieldNameObject) {
            return fieldNameObject['text_full_name'] != undefined;
        });
        if (textFullNameFieldName != null) {
            _this.fullNameResponseField = textFullNameFieldName['text_full_name'];
        }
        _this.validationMessages = options['validationMessages'] || { required: {
                email: _this.getTranslated(options['validation_required_email'], 'Email required'),
                text_full_name: _this.getTranslated(options['validation_required_name'], 'Name is required'),
                role: _this.getTranslated(options['validation_required_role'], 'Select a role')
            },
            invalid: { email: _this.getTranslated(options['validation_invalid_email'], 'Email format is incorrect') } };
        _this.groupFieldNames = ['text_full_name', 'email'];
        _this.freeText = options['freeText'] || false;
        _this.forceLookupOnly = options['forceLookupOnly'] || false;
        if (_this.forceLookupOnly) {
            // override free text as it doesn't make sense
            _this.freeText = false;
        }
        _this.role = options['role'] ? _this.getTranslated(options['role'], options['role']) : null;
        _this.username = options['username'] || '';
        _this.previousEmail = _this.value ? _this.value.email : '';
        _this.validators = {
            text_full_name: [__WEBPACK_IMPORTED_MODULE_3__angular_forms__["i" /* Validators */].required],
            email: [__WEBPACK_IMPORTED_MODULE_3__angular_forms__["i" /* Validators */].required, __WEBPACK_IMPORTED_MODULE_3__angular_forms__["i" /* Validators */].email]
        };
        if (!_this.freeText) {
            _this.vocabField = new __WEBPACK_IMPORTED_MODULE_5__field_vocab_component__["a" /* VocabField */](_this.options, _this.injector);
            _this.hasLookup = true;
        }
        return _this;
    }
    ContributorField.prototype.setLookupServices = function (completerService, lookupService) {
        if (!this.freeText) {
            this.vocabField.setLookupServices(completerService, lookupService);
        }
    };
    ContributorField.prototype.createFormModel = function (valueElem) {
        if (valueElem === void 0) { valueElem = undefined; }
        if (valueElem) {
            this.value = valueElem;
        }
        if (__WEBPACK_IMPORTED_MODULE_4_lodash_es__["isEmpty"](this.value.role)) {
            this.value.role = this.role;
        }
        if (!this.freeText) {
            this.vocabField.setEmptyValue();
            this.formModel = this.vocabField.createFormModel(this.value, true);
            this.formModel.addControl('username', new __WEBPACK_IMPORTED_MODULE_3__angular_forms__["b" /* FormControl */](this.value.username));
            this.formModel.addControl('role', new __WEBPACK_IMPORTED_MODULE_3__angular_forms__["b" /* FormControl */](this.value.role));
            this.formModel.addControl('orcid', new __WEBPACK_IMPORTED_MODULE_3__angular_forms__["b" /* FormControl */](this.value.orcid));
            if (this.value) {
                this.setValue(this.value);
            }
        }
        else {
            this.formModel = new __WEBPACK_IMPORTED_MODULE_3__angular_forms__["c" /* FormGroup */]({ text_full_name: new __WEBPACK_IMPORTED_MODULE_3__angular_forms__["b" /* FormControl */](this.value.text_full_name || null),
                email: new __WEBPACK_IMPORTED_MODULE_3__angular_forms__["b" /* FormControl */](this.value.email || null),
                role: new __WEBPACK_IMPORTED_MODULE_3__angular_forms__["b" /* FormControl */](this.value.role || null),
                username: new __WEBPACK_IMPORTED_MODULE_3__angular_forms__["b" /* FormControl */](this.value.username || ''),
                orcid: new __WEBPACK_IMPORTED_MODULE_3__angular_forms__["b" /* FormControl */](this.value.orcid || '')
            });
        }
        if (this.required) {
            this.enableValidators();
        }
        return this.formModel;
    };
    ContributorField.prototype.setValue = function (value, emitEvent, updateTitle) {
        if (emitEvent === void 0) { emitEvent = true; }
        if (updateTitle === void 0) { updateTitle = false; }
        if (!this.hasInit) {
            this.hasInit = true;
            value.username = __WEBPACK_IMPORTED_MODULE_4_lodash_es__["isUndefined"](value.username) ? '' : value.username;
        }
        else {
            if (__WEBPACK_IMPORTED_MODULE_4_lodash_es__["isUndefined"](value.username) || (value.email && value.email != this.previousEmail)) {
                value.username = '';
                this.previousEmail = value.email;
            }
        }
        this.formModel.patchValue(value, { emitEvent: emitEvent });
        this.formModel.markAsTouched();
        this.formModel.markAsDirty();
        if (updateTitle) {
            this.component.ngCompleter.ctrInput.nativeElement.value = this.vocabField.getTitle(value);
        }
    };
    ContributorField.prototype.toggleValidator = function (c) {
        var _this = this;
        return function (value) {
            if (value || __WEBPACK_IMPORTED_MODULE_4_lodash_es__["find"](_this.formModel.controls, function (c) { return c.value; })) {
                _this.enableValidators();
            }
            else {
                _this.disableValidators();
            }
        };
    };
    ContributorField.prototype.enableValidators = function () {
        var _this = this;
        if (this.enabledValidators) {
            return;
        }
        this.enabledValidators = true;
        __WEBPACK_IMPORTED_MODULE_4_lodash_es__["forEach"](this.groupFieldNames, function (f) {
            _this.formModel.controls[f].setValidators(_this.validators[f]);
        });
    };
    ContributorField.prototype.disableValidators = function () {
        if (!this.enabledValidators) {
            return;
        }
        this.enabledValidators = false;
        __WEBPACK_IMPORTED_MODULE_4_lodash_es__["forEach"](this.formModel.controls, function (c) {
            c.setValidators(null);
            c.setErrors(null);
        });
    };
    ContributorField.prototype.postInit = function (value) {
        if (value) {
            this.value = value;
            if (!this.freeText) {
                this.vocabField.value = value;
                this.vocabField.initialValue = __WEBPACK_IMPORTED_MODULE_4_lodash_es__["cloneDeep"](value);
                this.vocabField.initialValue.title = this.vocabField.getTitle(value);
                this.vocabField.initLookupData();
            }
        }
        else {
            this.setEmptyValue();
        }
    };
    ContributorField.prototype.setEmptyValue = function (emitEvent) {
        if (emitEvent === void 0) { emitEvent = true; }
        this.value = { text_full_name: null, email: null, role: null, username: '' };
        if (this.formModel) {
            __WEBPACK_IMPORTED_MODULE_4_lodash_es__["forOwn"](this.formModel.controls, function (c, cName) {
                c.setValue(null, { emitEvent: emitEvent });
            });
        }
        return this.value;
    };
    Object.defineProperty(ContributorField.prototype, "isValid", {
        get: function () {
            var _this = this;
            var validity = false;
            __WEBPACK_IMPORTED_MODULE_4_lodash_es__["forEach"](this.groupFieldNames, function (f) {
                validity = validity && _this.formModel.controls[f].valid;
            });
            return validity;
        },
        enumerable: true,
        configurable: true
    });
    ContributorField.prototype.triggerValidation = function () {
        var _this = this;
        __WEBPACK_IMPORTED_MODULE_4_lodash_es__["forEach"](this.groupFieldNames, function (f) {
            _this.formModel.controls[f].updateValueAndValidity({ onlySelf: true, emitEvent: false });
            _this.formModel.controls[f].markAsTouched();
        });
    };
    ContributorField.prototype.getValidationError = function () {
        var _this = this;
        var errObj = null;
        if (this.formModel) {
            __WEBPACK_IMPORTED_MODULE_4_lodash_es__["forEach"](this.groupFieldNames, function (f) {
                if (!__WEBPACK_IMPORTED_MODULE_4_lodash_es__["isEmpty"](_this.formModel.controls[f].errors)) {
                    errObj = _this.formModel.controls[f].errors;
                }
            });
        }
        return errObj;
    };
    ContributorField.prototype.reactEvent = function (eventName, eventData, origData) {
        this.setValue(eventData, false);
        __WEBPACK_IMPORTED_MODULE_4_lodash_es__["each"](this.componentReactors, function (compReact) {
            compReact.reactEvent(eventName, eventData, origData);
        });
    };
    return ContributorField;
}(__WEBPACK_IMPORTED_MODULE_2__field_base__["a" /* FieldBase */]));

var ContributorComponent = /** @class */ (function (_super) {
    __extends(ContributorComponent, _super);
    function ContributorComponent() {
        var _this = _super !== null && _super.apply(this, arguments) || this;
        _this.isEmbedded = false;
        return _this;
    }
    ContributorComponent.prototype.ngOnInit = function () {
        this.field.componentReactors.push(this);
        this.field.component = this;
    };
    ContributorComponent.prototype.getGroupClass = function (fldName) {
        var hasError = false;
        hasError = hasError || (this.field.formModel.controls[fldName].hasError('required'));
        if (!hasError && fldName == 'email') {
            hasError = hasError || (this.field.formModel.controls[fldName].hasError('email'));
        }
        return "col-xs-3 form-group" + (hasError ? ' has-error' : '');
    };
    ContributorComponent.prototype.onSelect = function (selected, emitEvent, updateTitle) {
        if (emitEvent === void 0) { emitEvent = true; }
        if (updateTitle === void 0) { updateTitle = false; }
        if (selected) {
            if ((__WEBPACK_IMPORTED_MODULE_4_lodash_es__["isUndefined"](selected.title) && __WEBPACK_IMPORTED_MODULE_4_lodash_es__["isUndefined"](selected.text_full_name) && __WEBPACK_IMPORTED_MODULE_4_lodash_es__["isEmpty"](selected.title) && __WEBPACK_IMPORTED_MODULE_4_lodash_es__["isEmpty"](selected.text_full_name))
                || (selected.title && selected.title == this.field.formModel.value.text_full_name)) {
                console.log("Same or empty selection, returning...");
                return;
            }
            var val = void 0;
            if (selected.text_full_name) {
                val = this.field.vocabField.getValue(selected);
            }
            else if (selected[this.field.fullNameResponseField]) {
                val = this.field.vocabField.getValue(selected);
            }
            else {
                val = { text_full_name: selected.title };
            }
            val.role = this.field.role;
            console.log("Using val:");
            console.log(JSON.stringify(val));
            this.field.setValue(val, emitEvent, updateTitle);
        }
        else {
            console.log("No selected user.");
            if (this.field.forceLookupOnly) {
                console.log("Forced lookup, clearing data..");
                this.field.setEmptyValue(emitEvent);
            }
        }
    };
    ContributorComponent.prototype.reactEvent = function (eventName, eventData, origData, elem) {
        console.log("Contributor component reacting:");
        console.log(eventData);
        this.onSelect(eventData, false, true);
    };
    __decorate([
        Object(__WEBPACK_IMPORTED_MODULE_0__angular_core__["Input"])(),
        __metadata("design:type", Boolean)
    ], ContributorComponent.prototype, "isEmbedded", void 0);
    __decorate([
        Object(__WEBPACK_IMPORTED_MODULE_0__angular_core__["ViewChild"])('ngCompleter'),
        __metadata("design:type", __WEBPACK_IMPORTED_MODULE_0__angular_core__["ElementRef"])
    ], ContributorComponent.prototype, "ngCompleter", void 0);
    ContributorComponent = __decorate([
        Object(__WEBPACK_IMPORTED_MODULE_0__angular_core__["Component"])({
            selector: 'rb-contributor',
            template: __webpack_require__("./redbox-portal/angular/shared/form/field-contributor.component.html"),
        })
    ], ContributorComponent);
    return ContributorComponent;
}(__WEBPACK_IMPORTED_MODULE_1__field_simple_component__["l" /* SimpleComponent */]));



/***/ }),

/***/ "./redbox-portal/angular/shared/form/field-control-meta.service.ts":
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "a", function() { return FieldControlMetaService; });
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__angular_core__ = __webpack_require__("./node_modules/@angular/core/esm5/core.js");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_rxjs_Observable__ = __webpack_require__("./node_modules/rxjs/_esm5/Observable.js");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_lodash_es__ = __webpack_require__("./node_modules/lodash-es/lodash.js");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3__fieldClasses__ = __webpack_require__("./redbox-portal/angular/shared/fieldClasses.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4__config_service__ = __webpack_require__("./redbox-portal/angular/shared/config-service.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5__field_vocab_component__ = __webpack_require__("./redbox-portal/angular/shared/form/field-vocab.component.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_6_ng2_completer__ = __webpack_require__("./node_modules/ng2-completer/index.js");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_7__translation_service__ = __webpack_require__("./redbox-portal/angular/shared/translation-service.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_8__util_service__ = __webpack_require__("./redbox-portal/angular/shared/util-service.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_9__base_service__ = __webpack_require__("./redbox-portal/angular/shared/base-service.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_10__angular_http__ = __webpack_require__("./node_modules/@angular/http/esm5/http.js");
var __extends = (this && this.__extends) || (function () {
    var extendStatics = Object.setPrototypeOf ||
        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||
        function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };
    return function (d, b) {
        extendStatics(d, b);
        function __() { this.constructor = d; }
        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
    };
})();
var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {
    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
    if (typeof Reflect === "object" && typeof Reflect.decorate === "function") r = Reflect.decorate(decorators, target, key, desc);
    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;
    return c > 3 && r && Object.defineProperty(target, key, r), r;
};
var __metadata = (this && this.__metadata) || function (k, v) {
    if (typeof Reflect === "object" && typeof Reflect.metadata === "function") return Reflect.metadata(k, v);
};
var __param = (this && this.__param) || function (paramIndex, decorator) {
    return function (target, key) { decorator(target, key, paramIndex); }
};











var FieldControlMetaService = /** @class */ (function (_super) {
    __extends(FieldControlMetaService, _super);
    function FieldControlMetaService(http, vocabFieldLookupService, completerService, configService, translationService, utilityService, app) {
        var _this = _super.call(this, http, configService) || this;
        _this.vocabFieldLookupService = vocabFieldLookupService;
        _this.completerService = completerService;
        _this.configService = configService;
        _this.translationService = translationService;
        _this.utilityService = utilityService;
        _this.app = app;
        _this.classes = __WEBPACK_IMPORTED_MODULE_3__fieldClasses__["a" /* fieldClasses */];
        return _this;
    }
    FieldControlMetaService.prototype.getFieldsMeta = function (fieldsArr) {
        var _this = this;
        var fields = __WEBPACK_IMPORTED_MODULE_2_lodash_es__["map"](fieldsArr, function (f) {
            // console.log(f.class);
            // if(typeof this.classes[f.class] != 'undefined'){
            //   console.log(f.class + ' is null');
            // }
            var inst = new _this.classes[f.class].meta(f.definition, _this.app['_injector']);
            inst.utilityService = _this.getInjectedService('utilityService');
            inst.appConfig = _this.getInjectedService('configService').config;
            // set the component class
            if (__WEBPACK_IMPORTED_MODULE_2_lodash_es__["isArray"](_this.classes[f.class].comp)) {
                inst.compClass = __WEBPACK_IMPORTED_MODULE_2_lodash_es__["find"](_this.classes[f.class].comp, function (c) {
                    // console.log(`Checking if ${c.clName} == ${f.compClass}`);
                    return c.clName == f.compClass;
                });
                // defaults to the first entry when compClass is undefined
                if (__WEBPACK_IMPORTED_MODULE_2_lodash_es__["isUndefined"](inst.compClass)) {
                    inst.compClass = _this.classes[f.class].comp[0];
                }
            }
            else {
                inst.compClass = _this.classes[f.class].comp;
            }
            if (f.definition && f.definition.fields) {
                inst.fields = _this.getFieldsMeta(f.definition.fields);
            }
            return inst;
        });
        return fields;
    };
    FieldControlMetaService.prototype.flattenFields = function (fields, fieldArr) {
        var _this = this;
        __WEBPACK_IMPORTED_MODULE_2_lodash_es__["map"](fields, function (f) {
            fieldArr.push(f);
            if (f.fields) {
                _this.flattenFields(f.fields, fieldArr);
            }
        });
    };
    FieldControlMetaService.prototype.getLookupData = function (fields) {
        var _this = this;
        var fieldArray = [];
        this.flattenFields(fields, fieldArray);
        return __WEBPACK_IMPORTED_MODULE_1_rxjs_Observable__["a" /* Observable */].from(fieldArray).flatMap(function (f) {
            if (f.hasLookup) {
                var lookupServiceName = _this.classes[f.clName].lookupService;
                var serviceInst = _this.getInjectedService(lookupServiceName);
                f.setLookupServices(_this.getInjectedService('completerService'), serviceInst);
                // f.completerService = this.completerService;
                // f.lookupService = this[lookupServiceName];
                return serviceInst.getLookupData(f);
            }
            else {
                return __WEBPACK_IMPORTED_MODULE_1_rxjs_Observable__["a" /* Observable */].of(null);
            }
        })
            .flatMap(function (field) {
            return __WEBPACK_IMPORTED_MODULE_1_rxjs_Observable__["a" /* Observable */].of(field);
        })
            .last()
            .flatMap(function (whatever) {
            return __WEBPACK_IMPORTED_MODULE_1_rxjs_Observable__["a" /* Observable */].of(fields);
        });
    };
    FieldControlMetaService.prototype.getInjectedService = function (serviceName) {
        var serviceInst = null;
        switch (serviceName) {
            case 'vocabFieldLookupService':
                serviceInst = this.vocabFieldLookupService;
                break;
            case 'completerService':
                serviceInst = this.completerService;
                break;
            case 'configService':
                serviceInst = this.configService;
                break;
            case 'translationService':
                serviceInst = this.translationService;
                break;
            case 'utilityService':
                serviceInst = this.utilityService;
                break;
        }
        return serviceInst;
    };
    FieldControlMetaService = __decorate([
        Object(__WEBPACK_IMPORTED_MODULE_0__angular_core__["Injectable"])(),
        __param(0, Object(__WEBPACK_IMPORTED_MODULE_0__angular_core__["Inject"])(__WEBPACK_IMPORTED_MODULE_10__angular_http__["b" /* Http */])),
        __param(1, Object(__WEBPACK_IMPORTED_MODULE_0__angular_core__["Inject"])(__WEBPACK_IMPORTED_MODULE_5__field_vocab_component__["c" /* VocabFieldLookupService */])),
        __param(2, Object(__WEBPACK_IMPORTED_MODULE_0__angular_core__["Inject"])(__WEBPACK_IMPORTED_MODULE_6_ng2_completer__["a" /* CompleterService */])),
        __param(3, Object(__WEBPACK_IMPORTED_MODULE_0__angular_core__["Inject"])(__WEBPACK_IMPORTED_MODULE_4__config_service__["a" /* ConfigService */])),
        __param(4, Object(__WEBPACK_IMPORTED_MODULE_0__angular_core__["Inject"])(__WEBPACK_IMPORTED_MODULE_7__translation_service__["a" /* TranslationService */])),
        __param(5, Object(__WEBPACK_IMPORTED_MODULE_0__angular_core__["Inject"])(__WEBPACK_IMPORTED_MODULE_8__util_service__["a" /* UtilityService */])),
        __metadata("design:paramtypes", [__WEBPACK_IMPORTED_MODULE_10__angular_http__["b" /* Http */],
            __WEBPACK_IMPORTED_MODULE_5__field_vocab_component__["c" /* VocabFieldLookupService */],
            __WEBPACK_IMPORTED_MODULE_6_ng2_completer__["a" /* CompleterService */],
            __WEBPACK_IMPORTED_MODULE_4__config_service__["a" /* ConfigService */],
            __WEBPACK_IMPORTED_MODULE_7__translation_service__["a" /* TranslationService */],
            __WEBPACK_IMPORTED_MODULE_8__util_service__["a" /* UtilityService */],
            __WEBPACK_IMPORTED_MODULE_0__angular_core__["ApplicationRef"]])
    ], FieldControlMetaService);
    return FieldControlMetaService;
}(__WEBPACK_IMPORTED_MODULE_9__base_service__["a" /* BaseService */]));



/***/ }),

/***/ "./redbox-portal/angular/shared/form/field-control.service.ts":
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "a", function() { return FieldControlService; });
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__angular_core__ = __webpack_require__("./node_modules/@angular/core/esm5/core.js");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1__angular_forms__ = __webpack_require__("./node_modules/@angular/forms/esm5/forms.js");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_lodash_es__ = __webpack_require__("./node_modules/lodash-es/lodash.js");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_rxjs_add_observable_of__ = __webpack_require__("./node_modules/rxjs/_esm5/add/observable/of.js");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_rxjs_add_operator_mergeMap__ = __webpack_require__("./node_modules/rxjs/_esm5/add/operator/mergeMap.js");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5_rxjs_add_operator_last__ = __webpack_require__("./node_modules/rxjs/_esm5/add/operator/last.js");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_6_rxjs_add_observable_from__ = __webpack_require__("./node_modules/rxjs/_esm5/add/observable/from.js");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_7_ng2_completer__ = __webpack_require__("./node_modules/ng2-completer/index.js");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_8__config_service__ = __webpack_require__("./redbox-portal/angular/shared/config-service.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_9__translation_service__ = __webpack_require__("./redbox-portal/angular/shared/translation-service.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_10__util_service__ = __webpack_require__("./redbox-portal/angular/shared/util-service.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_11__field_control_meta_service__ = __webpack_require__("./redbox-portal/angular/shared/form/field-control-meta.service.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_12__fieldClasses__ = __webpack_require__("./redbox-portal/angular/shared/fieldClasses.ts");
var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {
    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
    if (typeof Reflect === "object" && typeof Reflect.decorate === "function") r = Reflect.decorate(decorators, target, key, desc);
    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;
    return c > 3 && r && Object.defineProperty(target, key, r), r;
};
var __metadata = (this && this.__metadata) || function (k, v) {
    if (typeof Reflect === "object" && typeof Reflect.metadata === "function") return Reflect.metadata(k, v);
};
var __param = (this && this.__param) || function (paramIndex, decorator) {
    return function (target, key) { decorator(target, key, paramIndex); }
};
// Copyright (c) 2017 Queensland Cyber Infrastructure Foundation (http://www.qcif.edu.au/)
//
// GNU GENERAL PUBLIC LICENSE
//    Version 2, June 1991
//
// This program is free software; you can redistribute it and/or modify
// it under the terms of the GNU General Public License as published by
// the Free Software Foundation; either version 2 of the License, or
// (at your option) any later version.
//
// This program is distributed in the hope that it will be useful,
// but WITHOUT ANY WARRANTY; without even the implied warranty of
// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
// GNU General Public License for more details.
//
// You should have received a copy of the GNU General Public License along
// with this program; if not, write to the Free Software Foundation, Inc.,
// 51 Franklin Street, Fifth Floor, Boston, MA 02110-1301 USA.













/**
 * Field / Model Factory Service...
 *
 * Author: <a href='https://github.com/shilob' target='_blank'>Shilo Banihit</a>
 *
 */
var FieldControlService = /** @class */ (function () {
    function FieldControlService(completerService, configService, translationService, utilityService, fcmetaService, app) {
        this.completerService = completerService;
        this.configService = configService;
        this.translationService = translationService;
        this.utilityService = utilityService;
        this.fcmetaService = fcmetaService;
        this.app = app;
        this.classes = __WEBPACK_IMPORTED_MODULE_12__fieldClasses__["a" /* fieldClasses */];
    }
    FieldControlService.prototype.addComponentClasses = function (componentClasses) {
        this.classes = __WEBPACK_IMPORTED_MODULE_2_lodash_es__["merge"](this.classes, componentClasses);
    };
    FieldControlService.prototype.getEmptyFormGroup = function () {
        return new __WEBPACK_IMPORTED_MODULE_1__angular_forms__["c" /* FormGroup */]({});
    };
    FieldControlService.prototype.toFormGroup = function (fields, fieldMap) {
        if (fieldMap === void 0) { fieldMap = null; }
        var group = {};
        this.populateFormGroup(fields, group, fieldMap);
        this.setupEventHandlers(fieldMap);
        return new __WEBPACK_IMPORTED_MODULE_1__angular_forms__["c" /* FormGroup */](group);
    };
    FieldControlService.prototype.setupEventHandlers = function (fieldMap) {
        __WEBPACK_IMPORTED_MODULE_2_lodash_es__["forOwn"](fieldMap, function (fMap) {
            if (fMap.field) {
                fMap.field.setupEventHandlers();
            }
        });
    };
    FieldControlService.prototype.populateFormGroup = function (fields, group, fieldMap) {
        var _this = this;
        fields.forEach(function (field) {
            if (field.fields && !field.hasGroup) {
                _this.populateFormGroup(field.fields, group, fieldMap);
            }
            else {
                field.getGroup(group, fieldMap);
            }
        });
        return group;
    };
    FieldControlService.prototype.getFieldsMeta = function (fieldsArr) {
        var fields = this.fcmetaService.getFieldsMeta(fieldsArr);
        return fields;
    };
    FieldControlService.prototype.getLookupData = function (fields) {
        return this.fcmetaService.getLookupData(fields);
    };
    FieldControlService = __decorate([
        Object(__WEBPACK_IMPORTED_MODULE_0__angular_core__["Injectable"])(),
        __param(0, Object(__WEBPACK_IMPORTED_MODULE_0__angular_core__["Inject"])(__WEBPACK_IMPORTED_MODULE_7_ng2_completer__["a" /* CompleterService */])),
        __param(1, Object(__WEBPACK_IMPORTED_MODULE_0__angular_core__["Inject"])(__WEBPACK_IMPORTED_MODULE_8__config_service__["a" /* ConfigService */])),
        __param(2, Object(__WEBPACK_IMPORTED_MODULE_0__angular_core__["Inject"])(__WEBPACK_IMPORTED_MODULE_9__translation_service__["a" /* TranslationService */])),
        __param(3, Object(__WEBPACK_IMPORTED_MODULE_0__angular_core__["Inject"])(__WEBPACK_IMPORTED_MODULE_10__util_service__["a" /* UtilityService */])),
        __param(4, Object(__WEBPACK_IMPORTED_MODULE_0__angular_core__["Inject"])(__WEBPACK_IMPORTED_MODULE_11__field_control_meta_service__["a" /* FieldControlMetaService */])),
        __metadata("design:paramtypes", [__WEBPACK_IMPORTED_MODULE_7_ng2_completer__["a" /* CompleterService */],
            __WEBPACK_IMPORTED_MODULE_8__config_service__["a" /* ConfigService */],
            __WEBPACK_IMPORTED_MODULE_9__translation_service__["a" /* TranslationService */],
            __WEBPACK_IMPORTED_MODULE_10__util_service__["a" /* UtilityService */],
            __WEBPACK_IMPORTED_MODULE_11__field_control_meta_service__["a" /* FieldControlMetaService */],
            __WEBPACK_IMPORTED_MODULE_0__angular_core__["ApplicationRef"]])
    ], FieldControlService);
    return FieldControlService;
}());



/***/ }),

/***/ "./redbox-portal/angular/shared/form/field-data-location.html":
/***/ (function(module, exports) {

module.exports = "<!-- Basic Uppy styles -->\n<link rel=\"stylesheet\" href=\"/node_modules/uppy/dist/uppy.min.css\">\n<div class='padding-bottom-10'>\n  <label [attr.for]=\"field.name\">\n    {{field.label}} {{ getRequiredLabelStr()}}\n    <button type=\"button\" class=\"btn btn-default\" *ngIf=\"field.help\" (click)=\"toggleHelp()\"><span class=\"glyphicon glyphicon-question-sign\" aria-hidden=\"true\"></span></button>\n  </label><br/>\n  <div>\n    <div class=\"table-responsive\">\n    <table class=\"table table-bordered table-striped table-hover\">\n      <thead>\n        <tr>\n          <th width=\"15%\">Type of location</th>\n          <th width=\"40%\">Location</th>\n          <th width=\"40%\">Notes</th>\n          <th width=\"5%\" *ngIf=\"field.editMode\"></th>\n        </tr>\n      </thead>\n      <tbody>\n        <tr *ngFor=\"let dataLocation of getDatalocations()\">\n          <td>{{ field.dataTypeLookup[dataLocation.type] }}</td>\n          <td>\n            <ng-container *ngIf=\"dataLocation && dataLocation.type != 'attachment'\">\n            {{ dataLocation.location }}\n            </ng-container>\n            <ng-container *ngIf=\"dataLocation.type == 'attachment'\">\n              <ng-container *ngIf=\"dataLocation.pending\">\n                {{ dataLocation.name }}\n              </ng-container>\n              <a *ngIf=\"!dataLocation.pending\" href=\"{{ getAbsUrl(dataLocation.location) }}\" target=\"_blank\">\n                {{ dataLocation.name }}\n              </a>\n            </ng-container>\n          </td>\n          <td>{{ dataLocation.notes }}</td>\n          <td *ngIf=\"field.editMode\">\n            <a class=\"fa fa-minus-circle btn text-20 btn-danger\" (click)=\"field.removeLocation(dataLocation)\"></a>\n          </td>\n        </tr>\n      </tbody>\n    </table>\n  </div>\n  <div class=\"row\" *ngIf=\"field.editMode\">\n    <div class=\"col-xs-3\">\n      <label>Type of location</label>\n    </div>\n    <div class=\"col-xs-4\">\n      <label>Location</label>\n    </div>\n    <div class=\"col-xs-5\">\n      <label *ngIf=\"field.newLocation.type != 'attachment'\">Notes</label>\n    </div>\n\n  </div>\n  <div class=\"row\" *ngIf=\"field.editMode\">\n\n    <div class=\"col-xs-3\">\n      <select [(ngModel)]=\"field.newLocation.type\" [id]=\"field.newLocation.type\" class=\"form-control\">\n         <option *ngFor=\"let opt of field.dataTypes\" [value]=\"opt.value\">{{opt.label}}</option>\n      </select>\n    </div>\n\n    <div class=\"col-xs-4\">\n      <input [(ngModel)]=\"field.newLocation.location\" *ngIf=\"field.newLocation.type != 'attachment'\" type=\"text\" class=\"form-control\" />\n      <a [class.disabled]=\"isAttachmentsDisabled()\"\n      class=\"btn btn-info UppyModalOpenerBtn\"\n      [style.display]=\"field.newLocation.type == 'attachment' ? 'inherit' : 'none'\" (click)=\"openModal()\">{{ field.attachmentText }}</a>\n    </div>\n    <div class=\"col-xs-4\">\n      <input [(ngModel)]=\"field.newLocation.notes\"  *ngIf=\"field.newLocation.type != 'attachment'\" type=\"text\" class=\"form-control\" />\n    </div>\n    <div class=\"col-xs-1\">\n      <a  *ngIf=\"field.newLocation.type != 'attachment'\" class=\"fa fa-plus-circle btn text-20 pull-right btn-success\" (click)=\"field.addLocation()\"></a>\n    </div>\n  </div>\n</div>\n</div>\n"

/***/ }),

/***/ "./redbox-portal/angular/shared/form/field-datalocation.component.ts":
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "b", function() { return DataLocationField; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "a", function() { return DataLocationComponent; });
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__angular_core__ = __webpack_require__("./node_modules/@angular/core/esm5/core.js");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1__field_simple_component__ = __webpack_require__("./redbox-portal/angular/shared/form/field-simple.component.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2__field_base__ = __webpack_require__("./redbox-portal/angular/shared/form/field-base.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_lodash_es__ = __webpack_require__("./node_modules/lodash-es/lodash.js");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4__records_service__ = __webpack_require__("./redbox-portal/angular/shared/form/records.service.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5_uppy__ = __webpack_require__("./node_modules/uppy/lib/index.js");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5_uppy___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_5_uppy__);
var __extends = (this && this.__extends) || (function () {
    var extendStatics = Object.setPrototypeOf ||
        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||
        function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };
    return function (d, b) {
        extendStatics(d, b);
        function __() { this.constructor = d; }
        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
    };
})();
var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {
    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
    if (typeof Reflect === "object" && typeof Reflect.decorate === "function") r = Reflect.decorate(decorators, target, key, desc);
    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;
    return c > 3 && r && Object.defineProperty(target, key, r), r;
};
// Copyright (c) 2017 Queensland Cyber Infrastructure Foundation (http://www.qcif.edu.au/)
//
// GNU GENERAL PUBLIC LICENSE
//    Version 2, June 1991
//
// This program is free software; you can redistribute it and/or modify
// it under the terms of the GNU General Public License as published by
// the Free Software Foundation; either version 2 of the License, or
// (at your option) any later version.
//
// This program is distributed in the hope that it will be useful,
// but WITHOUT ANY WARRANTY; without even the implied warranty of
// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
// GNU General Public License for more details.
//
// You should have received a copy of the GNU General Public License along
// with this program; if not, write to the Free Software Foundation, Inc.,
// 51 Franklin Street, Fifth Floor, Boston, MA 02110-1301 USA.






/**
 * Contributor Model
 *
 *
 * @author <a target='_' href='https://github.com/shilob'>Shilo Banihit</a>
 *
 */
var DataLocationField = /** @class */ (function (_super) {
    __extends(DataLocationField, _super);
    function DataLocationField(options, injector) {
        var _this = _super.call(this, options, injector) || this;
        _this.newLocation = { type: "url", location: "", notes: "" };
        _this.attachmentText = "Add attachment(s)";
        _this.dataTypes = [{
                'label': 'URL',
                'value': 'url',
            },
            {
                'label': 'Physical location',
                'value': 'physical',
            },
            {
                'label': 'File path',
                'value': 'file',
            },
            {
                'label': 'Attachment',
                'value': 'attachment'
            }
        ];
        _this.dataTypeLookup = {
            'url': "URL",
            'physical': "Physical location",
            'attachment': "Attachment",
            'file': "File path"
        };
        _this.accessDeniedObjects = [];
        _this.columns = options['columns'] || [];
        _this.maxFileSize = options['maxFileSize'] || null;
        _this.maxNumberOfFiles = options['maxNumberOfFiles'] || null;
        _this.allowedFileTypes = options['allowedFileTypes'] || null;
        _this.value = options['value'] || _this.setEmptyValue();
        _this.recordsService = _this.getFromInjector(__WEBPACK_IMPORTED_MODULE_4__records_service__["a" /* RecordsService */]);
        return _this;
    }
    DataLocationField.prototype.setValue = function (value, emitEvent) {
        if (emitEvent === void 0) { emitEvent = true; }
        this.formModel.setValue(value, { emitEvent: emitEvent, emitModelToViewChange: true });
        this.formModel.markAsTouched();
        this.formModel.markAsDirty();
    };
    DataLocationField.prototype.setEmptyValue = function () {
        this.value = [];
        return this.value;
    };
    DataLocationField.prototype.addLocation = function () {
        this.value.push(this.newLocation);
        this.setValue(this.value);
        this.newLocation = { type: "url", location: "", notes: "" };
    };
    DataLocationField.prototype.appendLocation = function (newLoc) {
        this.value.push(newLoc);
        this.setValue(this.value, true);
    };
    DataLocationField.prototype.clearPendingAtt = function (value) {
        __WEBPACK_IMPORTED_MODULE_3_lodash_es__["each"](value, function (val) {
            if (val.type == 'attachment') {
                __WEBPACK_IMPORTED_MODULE_3_lodash_es__["unset"](val, 'pending');
            }
        });
    };
    DataLocationField.prototype.removeLocation = function (loc) {
        __WEBPACK_IMPORTED_MODULE_3_lodash_es__["remove"](this.value, function (val) {
            return val.type == loc.type && val.name == loc.name && val.location == loc.location;
        });
        this.setValue(this.value);
    };
    return DataLocationField;
}(__WEBPACK_IMPORTED_MODULE_2__field_base__["a" /* FieldBase */]));

/**
* Component to display information from related objects within ReDBox
*
*
*
*
*/
var DataLocationComponent = /** @class */ (function (_super) {
    __extends(DataLocationComponent, _super);
    function DataLocationComponent() {
        var _this = _super !== null && _super.apply(this, arguments) || this;
        _this.uppy = null;
        _this.oid = null;
        return _this;
    }
    DataLocationComponent.prototype.ngOnInit = function () {
        var oid = this.field.fieldMap._rootComp.oid;
        if (__WEBPACK_IMPORTED_MODULE_3_lodash_es__["isNull"](oid) || __WEBPACK_IMPORTED_MODULE_3_lodash_es__["isUndefined"](oid) || __WEBPACK_IMPORTED_MODULE_3_lodash_es__["isEmpty"](oid)) {
            // wait for the OID to be set when record is created
            if (!this.field.fieldMap._rootComp.getSubscription('recordCreated')) {
                console.log("Subscribing to record creation..... " + this.field.name);
                this.field.fieldMap._rootComp.subscribe('recordCreated', this.field.name, this.eventRecordCreate.bind(this));
                this.initUppy(oid);
            }
        }
        this.initUppy(oid);
    };
    DataLocationComponent.prototype.getDatalocations = function () {
        return this.field.value;
    };
    DataLocationComponent.prototype.eventRecordCreate = function (createdInfo) {
        console.log("Created record triggered: ");
        console.log(createdInfo);
        this.field.fieldMap[this.field.name].instance.initUppy(createdInfo.oid);
    };
    DataLocationComponent.prototype.tempClearPending = function () {
        // temporarily clearing pending values
        var fieldVal = __WEBPACK_IMPORTED_MODULE_3_lodash_es__["cloneDeep"](this.field.fieldMap._rootComp.form.value[this.field.name]);
        this.field.clearPendingAtt(fieldVal);
        this.field.fieldMap._rootComp.form.controls[this.field.name].setValue(fieldVal, { emitEvent: true });
    };
    DataLocationComponent.prototype.applyPendingChanges = function (savedInfo) {
        if (savedInfo.success) {
            // this.field.value = this.field.fieldMap._rootComp.form.value[this.field.name];
            var finalVal = this.field.fieldMap._rootComp.form.controls[this.field.name].value;
            this.field.fieldMap[this.field.name].field.value = finalVal;
        }
        else {
            // reverse the value
            console.log("Resetting....");
            this.field.fieldMap._rootComp.form.controls[this.field.name].setValue(this.field.fieldMap[this.field.name].field.value);
        }
    };
    DataLocationComponent.prototype.initUppy = function (oid) {
        var _this = this;
        this.field.fieldMap[this.field.name].instance.oid = oid;
        if (this.uppy) {
            console.log("Uppy already created... setting oid to: " + oid);
            this.field.fieldMap[this.field.name].instance.uppy.getPlugin('Tus').opts.endpoint = this.field.recordsService.getBrandingAndPortalUrl + "/record/" + oid + "/attach";
            return;
        }
        var uppyConfig = {
            debug: true,
            autoProceed: false,
            restrictions: {
                maxFileSize: this.field.maxFileSize,
                maxNumberOfFiles: this.field.maxNumberOfFiles,
                allowedFileTypes: this.field.allowedFileTypes
            }
        };
        console.debug("Using Uppy config:");
        console.debug(JSON.stringify(uppyConfig));
        var appConfig = this.field.recordsService.getConfig();
        var tusConfig = {
            endpoint: this.field.recordsService.getBrandingAndPortalUrl + "/record/" + oid + "/attach"
        };
        console.debug("Using TUS config:::");
        console.debug(JSON.stringify(tusConfig));
        this.uppy = __WEBPACK_IMPORTED_MODULE_5_uppy__["Core"](uppyConfig);
        this.uppy.use(__WEBPACK_IMPORTED_MODULE_5_uppy__["Dashboard"], {
            // trigger: '.UppyModalOpenerBtn',
            inline: false,
            metaFields: [
                { id: 'notes', name: 'Notes', placeholder: 'Notes about this file.' }
            ]
        })
            .use(__WEBPACK_IMPORTED_MODULE_5_uppy__["Tus"], tusConfig)
            .run();
        console.log(this.uppy);
        var fieldVal = null;
        // attach event handers...
        this.uppy.on('upload-success', function (file, resp, uploadURL) {
            console.debug("File info:");
            console.debug(file);
            console.debug("Response:");
            console.debug(resp);
            console.debug("Upload URL:" + uploadURL);
            // add to form control on each upload...
            var urlParts = uploadURL.split('/');
            var fileId = urlParts[urlParts.length - 1];
            var choppedUrl = urlParts.slice(6, urlParts.length).join('/');
            var newLoc = { type: "attachment", pending: true, location: choppedUrl, notes: file.meta.notes, mimeType: file.type, name: file.meta.name, fileId: fileId, uploadUrl: uploadURL };
            console.debug("Adding new location:");
            console.debug(newLoc);
            _this.field.appendLocation(newLoc);
        });
        // clearing all pending attachments...
        this.field.fieldMap._rootComp.subscribe('onBeforeSave', this.field.name, function (savedInfo) {
            console.log("Before saving record triggered.. ");
            _this.field.fieldMap[_this.field.name].instance.tempClearPending();
        });
        // attach event handling for saving the record
        this.field.fieldMap._rootComp.subscribe('recordSaved', this.field.name, function (savedInfo) {
            console.log("Saved record triggered.. ");
            _this.field.fieldMap[_this.field.name].instance.applyPendingChanges(savedInfo);
        });
    };
    DataLocationComponent.prototype.isAttachmentsDisabled = function () {
        if (__WEBPACK_IMPORTED_MODULE_3_lodash_es__["isEmpty"](this.oid)) {
            this.field.attachmentText = "Save your record to attach files";
            return true;
        }
        else {
            this.field.attachmentText = "Add attachment(s)";
            return false;
        }
    };
    DataLocationComponent.prototype.getAbsUrl = function (location) {
        return this.field.recordsService.getBrandingAndPortalUrl + "/record/" + location;
    };
    DataLocationComponent.prototype.openModal = function () {
        this.uppy && this.uppy.getPlugin('Dashboard') && this.uppy.getPlugin('Dashboard').openModal();
    };
    DataLocationComponent = __decorate([
        Object(__WEBPACK_IMPORTED_MODULE_0__angular_core__["Component"])({
            selector: 'data-location-selector',
            template: __webpack_require__("./redbox-portal/angular/shared/form/field-data-location.html")
        })
    ], DataLocationComponent);
    return DataLocationComponent;
}(__WEBPACK_IMPORTED_MODULE_1__field_simple_component__["l" /* SimpleComponent */]));



/***/ }),

/***/ "./redbox-portal/angular/shared/form/field-group.component.ts":
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "a", function() { return GenericGroupComponent; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "b", function() { return RepeatableGroupComponent; });
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__angular_core__ = __webpack_require__("./node_modules/@angular/core/esm5/core.js");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1__field_repeatable_component__ = __webpack_require__("./redbox-portal/angular/shared/form/field-repeatable.component.ts");
var __extends = (this && this.__extends) || (function () {
    var extendStatics = Object.setPrototypeOf ||
        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||
        function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };
    return function (d, b) {
        extendStatics(d, b);
        function __() { this.constructor = d; }
        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
    };
})();
var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {
    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
    if (typeof Reflect === "object" && typeof Reflect.decorate === "function") r = Reflect.decorate(decorators, target, key, desc);
    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;
    return c > 3 && r && Object.defineProperty(target, key, r), r;
};
// Copyright (c) 2018 Queensland Cyber Infrastructure Foundation (http://www.qcif.edu.au/)
//
// GNU GENERAL PUBLIC LICENSE
//    Version 2, June 1991
//
// This program is free software; you can redistribute it and/or modify
// it under the terms of the GNU General Public License as published by
// the Free Software Foundation; either version 2 of the License, or
// (at your option) any later version.
//
// This program is distributed in the hope that it will be useful,
// but WITHOUT ANY WARRANTY; without even the implied warranty of
// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
// GNU General Public License for more details.
//
// You should have received a copy of the GNU General Public License along
// with this program; if not, write to the Free Software Foundation, Inc.,
// 51 Franklin Street, Fifth Floor, Boston, MA 02110-1301 USA.


/**
#### Generic Group Component

Generic component for grouping components together. The resulting JSON will have the field names as keys.

```
{
   class: 'Container',
   compClass: 'GenericGroupComponent',
   definition: {
     name: "related_website",
     cssClasses: "form-inline",
     fields: [
       {
         class: 'TextField',
         editOnly: true,
         definition: {
           name: 'related_url',
           label: '@dmpt-related-website-url',
           type: 'text',
           required: true,
           groupName: 'related_website',
           groupClasses: 'width-30',
           cssClasses : "width-80 form-control"
         }
       },
       {
         class: 'TextField',
         editOnly: true,
         definition: {
           name: 'related_title',
           label: '@dmpt-related-website-title',
           type: 'text',
           required: true,
           groupName: 'related_website',
           groupClasses: 'width-30',
           cssClasses : "width-80 form-control"
         }
       },
       {
         class: 'TextField',
         editOnly: true,
         definition: {
           name: 'related_notes',
           label: '@dmpt-related-website-notes',
           type: 'text',
           required: true,
           groupName: 'related_website',
           groupClasses: 'width-30',
           cssClasses : "width-80 form-control"
         }
       }
     ]
   }
 }
```
 * @author <a target='_' href='https://github.com/shilob'>Shilo Banihit</a>
 */
var GenericGroupComponent = /** @class */ (function (_super) {
    __extends(GenericGroupComponent, _super);
    function GenericGroupComponent() {
        return _super !== null && _super.apply(this, arguments) || this;
    }
    GenericGroupComponent.clName = 'GenericGroupComponent';
    GenericGroupComponent = __decorate([
        Object(__WEBPACK_IMPORTED_MODULE_0__angular_core__["Component"])({
            selector: 'generic-group-field',
            template: "\n  <ng-container *ngIf=\"field.editMode\">\n    <div *ngIf=\"field.label\">\n      <label>\n        {{field.label}} {{getRequiredLabelStr()}}\n        <button type=\"button\" class=\"btn btn-default\" *ngIf=\"field.help\" (click)=\"toggleHelp()\"><span class=\"glyphicon glyphicon-question-sign\" aria-hidden=\"true\"></span></button>\n      </label>\n      <span id=\"{{ 'helpBlock_' + field.name }}\" class=\"help-block\" *ngIf=\"this.helpShow\" >{{field.help}}</span>\n    </div>\n    <ng-container *ngIf=\"isEmbedded\">\n      <div [formGroup]='form' [ngClass]=\"field.cssClasses\">\n        <div class='row'>\n          <div class=\"col-xs-11\">\n            <dmp-field *ngFor=\"let childField of field.fields\" [name]=\"name\" [index]=\"index\" [field]=\"childField\" [form]=\"form\" [fieldMap]=\"fieldMap\"></dmp-field>\n          </div>\n          <div class=\"col-xs-1\">\n            <button type='button' *ngIf=\"removeBtnText\" [disabled]=\"!canRemove\" (click)=\"onRemove($event)\" [ngClass]=\"removeBtnClass\" >{{removeBtnText}}</button>\n            <button [disabled]=\"!canRemove\" type='button' [ngClass]=\"removeBtnClass\" (click)=\"onRemove($event)\"></button>\n          </div>\n        </div>\n      </div>\n    </ng-container>\n    <ng-container *ngIf=\"!isEmbedded\">\n      <div [formGroup]='form' [ngClass]=\"field.cssClasses\">\n        <dmp-field *ngFor=\"let field of field.fields\" [field]=\"field\" [form]=\"form\" [fieldMap]=\"fieldMap\"></dmp-field>\n      </div>\n    </ng-container>\n  </ng-container>\n  <ng-container *ngIf=\"!field.editMode\">\n    <div [formGroup]='form' [ngClass]=\"field.cssClasses\">\n      <dmp-field *ngFor=\"let fieldElem of field.fields\" [field]=\"fieldElem\" [form]=\"form\" [fieldMap]=\"fieldMap\"></dmp-field>\n    </div>\n  </ng-container>\n  ",
        })
    ], GenericGroupComponent);
    return GenericGroupComponent;
}(__WEBPACK_IMPORTED_MODULE_1__field_repeatable_component__["a" /* EmbeddableComponent */]));

/**
 * ### Repeatable Generic Component
 *
 *
 * ```
 * {
   class: 'RepeatableContainer',
   compClass: 'RepeatableGroupComponent',
   definition: {
     name: "related_websites",
     label: "@dmpt-related-website",
     help: "@dmpt-related-website-help",
     forceClone: ['fields', 'fieldMap'],
     fields: [
       {
         class: 'Container',
         compClass: 'GenericGroupComponent',
         definition: {
           name: "related_website",
           cssClasses: "form-inline",
           fields: [
             {
               class: 'TextField',
               editOnly: true,
               definition: {
                 name: 'related_url',
                 label: '@dmpt-related-website-url',
                 type: 'text',
                 required: true,
                 groupName: 'related_website',
                 groupClasses: 'width-30',
                 cssClasses : "width-80 form-control"
               }
             },
             {
               class: 'TextField',
               editOnly: true,
               definition: {
                 name: 'related_title',
                 label: '@dmpt-related-website-title',
                 type: 'text',
                 required: true,
                 groupName: 'related_website',
                 groupClasses: 'width-30',
                 cssClasses : "width-80 form-control"
               }
             },
             {
               class: 'TextField',
               editOnly: true,
               definition: {
                 name: 'related_notes',
                 label: '@dmpt-related-website-notes',
                 type: 'text',
                 required: true,
                 groupName: 'related_website',
                 groupClasses: 'width-30',
                 cssClasses : "width-80 form-control"
               }
             }
           ]
         }
       }
     ]
   }
 }
 ```
 * @author <a target='_' href='https://github.com/shilob'>Shilo Banihit</a>
 */
var RepeatableGroupComponent = /** @class */ (function (_super) {
    __extends(RepeatableGroupComponent, _super);
    function RepeatableGroupComponent() {
        return _super !== null && _super.apply(this, arguments) || this;
    }
    RepeatableGroupComponent.clName = 'RepeatableGroupComponent';
    RepeatableGroupComponent = __decorate([
        Object(__WEBPACK_IMPORTED_MODULE_0__angular_core__["Component"])({
            selector: 'repeatable-group',
            template: "\n  <div *ngIf=\"field.editMode\">\n    <div *ngIf=\"field.label\">\n      <label>\n        {{field.label}} {{getRequiredLabelStr()}}\n        <button type=\"button\" class=\"btn btn-default\" *ngIf=\"field.help\" (click)=\"toggleHelp()\"><span class=\"glyphicon glyphicon-question-sign\" aria-hidden=\"true\"></span></button>\n      </label>\n      <span id=\"{{ 'helpBlock_' + field.name }}\" class=\"help-block\" *ngIf=\"this.helpShow\" >{{field.help}}</span>\n    </div>\n    <ng-container *ngFor=\"let fieldElem of field.fields; let i = index;\" >\n      <div class=\"row\">\n        <span class=\"col-xs-12\">\n          <generic-group-field [name]=\"field.name\" [field]=\"fieldElem\" [form]=\"form\" [fieldMap]=\"fieldMap\" [isEmbedded]=\"true\" [removeBtnText]=\"field.removeButtonText\" [removeBtnClass]=\"field.removeButtonClass\" [canRemove]=\"field.fields.length > 1\" (onRemoveBtnClick)=\"removeElem($event[0], $event[1])\" [index]=\"i\"></generic-group-field>\n        </span>\n      </div>\n      <div class=\"row\">\n        <span class=\"col-xs-12\">&nbsp;</span>\n      </div>\n    </ng-container>\n    <div class=\"row\">\n      <span class=\"col-xs-11\">&nbsp;\n      </span>\n      <span class=\"col-xs-1\">\n        <button *ngIf=\"field.addButtonText\" type='button' (click)=\"addElem($event)\" [ngClass]=\"field.addButtonTextClass\" >{{field.addButtonText}}</button>\n        <button *ngIf=\"!field.addButtonText\" type='button' (click)=\"addElem($event)\" [ngClass]=\"field.addButtonClass\"></button>\n      </span>\n    </div>\n  </div>\n  <li *ngIf=\"!field.editMode\" class=\"key-value-pair\">\n    <span *ngIf=\"field.label\" class=\"key\">{{field.label}}</span>\n    <span class=\"value\">\n      <ul class=\"key-value-list\">\n        <generic-group-field *ngFor=\"let fieldElem of field.fields; let i = index;\" [name]=\"field.name\" [index]=\"i\" [field]=\"fieldElem\" [form]=\"form\" [fieldMap]=\"fieldMap\"></generic-group-field>\n      </ul>\n    </span>\n  </li>\n  ",
        })
    ], RepeatableGroupComponent);
    return RepeatableGroupComponent;
}(__WEBPACK_IMPORTED_MODULE_1__field_repeatable_component__["b" /* RepeatableComponent */]));



/***/ }),

/***/ "./redbox-portal/angular/shared/form/field-map.component.ts":
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "b", function() { return MapField; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "a", function() { return MapComponent; });
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__angular_core__ = __webpack_require__("./node_modules/@angular/core/esm5/core.js");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1__field_simple_component__ = __webpack_require__("./redbox-portal/angular/shared/form/field-simple.component.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2__field_base__ = __webpack_require__("./redbox-portal/angular/shared/form/field-base.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3__angular_forms__ = __webpack_require__("./node_modules/@angular/forms/esm5/forms.js");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_lodash_es__ = __webpack_require__("./node_modules/lodash-es/lodash.js");
var __extends = (this && this.__extends) || (function () {
    var extendStatics = Object.setPrototypeOf ||
        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||
        function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };
    return function (d, b) {
        extendStatics(d, b);
        function __() { this.constructor = d; }
        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
    };
})();
var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {
    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
    if (typeof Reflect === "object" && typeof Reflect.decorate === "function") r = Reflect.decorate(decorators, target, key, desc);
    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;
    return c > 3 && r && Object.defineProperty(target, key, r), r;
};
// Copyright (c) 2017 Queensland Cyber Infrastructure Foundation (http://www.qcif.edu.au/)
//
// GNU GENERAL PUBLIC LICENSE
//    Version 2, June 1991
//
// This program is free software; you can redistribute it and/or modify
// it under the terms of the GNU General Public License as published by
// the Free Software Foundation; either version 2 of the License, or
// (at your option) any later version.
//
// This program is distributed in the hope that it will be useful,
// but WITHOUT ANY WARRANTY; without even the implied warranty of
// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
// GNU General Public License for more details.
//
// You should have received a copy of the GNU General Public License along
// with this program; if not, write to the Free Software Foundation, Inc.,
// 51 Franklin Street, Fifth Floor, Boston, MA 02110-1301 USA.





/**
 * Map Model
 *
 *
 * @author <a target='_' href='https://github.com/andrewbrazzatti'>Andrew Brazzatti</a>
 *
 */
var MapField = /** @class */ (function (_super) {
    __extends(MapField, _super);
    function MapField(options, injector) {
        var _this = _super.call(this, options, injector) || this;
        _this.initialised = false;
        _this.importDataString = "";
        _this.layerGeoJSON = {};
        _this.importFailed = false;
        _this.layers = [];
        _this.drawnItems = new L.FeatureGroup();
        _this.googleMaps = L.tileLayer('http://{s}.google.com/vt/lyrs=m&x={x}&y={y}&z={z}', {
            maxZoom: 20,
            subdomains: ['mt0', 'mt1', 'mt2', 'mt3'],
            detectRetina: true
        });
        _this.googleHybrid = L.tileLayer('http://{s}.google.com/vt/lyrs=s,h&x={x}&y={y}&z={z}', {
            maxZoom: 20,
            subdomains: ['mt0', 'mt1', 'mt2', 'mt3'],
            detectRetina: true
        });
        /*
        *
        * Draw options
        */
        /* Draw options that we do not want to be overridden by form config as it'll break functionality */
        _this.masterDrawOptions = {
            edit: {
                featureGroup: _this.drawnItems
            },
        };
        _this.defaultDrawOptions = {
            position: 'topright',
            edit: {
                featureGroup: _this.drawnItems
            },
            draw: {
                marker: {
                    icon: L.icon({
                        iconSize: [25, 41],
                        iconAnchor: [13, 41],
                        iconUrl: 'http://localhost:1500/default/rdmp/images/leaflet/marker-icon.png',
                        shadowUrl: 'http://localhost:1500/default/rdmp/images/leaflet/marker-shadow.png'
                    })
                },
                circlemarker: false,
                circle: false
            }
        };
        _this.drawOptions = _this.defaultDrawOptions;
        /*
        *
        * Leaf options
        */
        _this.masterLeafletOptions = {
            layers: [_this.googleMaps, _this.drawnItems],
        };
        _this.defaultLeafletOptions = {
            zoom: 4,
            center: L.latLng([-24.673148, 134.074574])
        };
        _this.leafletOptions = _this.defaultLeafletOptions;
        _this.layersControl = {
            baseLayers: {
                'Google Maps': _this.googleMaps,
                'Google Hybrid': _this.googleHybrid
            }
        };
        _this.clName = 'MapField';
        _this.leafletOptions = options['leafletOptions'] || _this.defaultLeafletOptions;
        // merge in master options to ensure we have the right layers configured
        _this.leafletOptions = __WEBPACK_IMPORTED_MODULE_4_lodash_es__["merge"](_this.leafletOptions, _this.masterLeafletOptions);
        _this.drawOptions = options['drawOptions'] || _this.drawOptions;
        // merge in master options to ensure we have the right layers configured
        _this.drawOptions = __WEBPACK_IMPORTED_MODULE_4_lodash_es__["merge"](_this.drawOptions, _this.masterDrawOptions);
        _this.tabId = options['tabId'] || null;
        _this.layerGeoJSON = options.value;
        return _this;
    }
    MapField.prototype.onMapReady = function (map) {
        var _this = this;
        this.map = map;
        var that = this;
        this.registerMapEventHandlers(map);
        this.setValue(this.layerGeoJSON);
        if (this.tabId === null) {
            map.invalidateSize();
            map.fitBounds(this.drawnItems.getBounds());
        }
        else {
            if (this.editMode) {
                // TODO: need a better way to select the tab component
                this.fieldMap._rootComp.fields[0]["onTabChange"].subscribe(function (tabName) {
                    if (tabName == _this.tabId) {
                        map.invalidateSize();
                        if (!that.initialised) {
                            try {
                                // if there are no layers present this will throw an error
                                map.fitBounds(_this.drawnItems.getBounds());
                            }
                            catch (e) {
                            }
                            that.initialised = true;
                        }
                    }
                });
            }
            else {
                setTimeout(5000, function () { map.invalidateSize(); });
            }
        }
    };
    MapField.prototype.registerMapEventHandlers = function (map) {
        var that = this;
        map.on(L.Draw.Event.CREATED, function (e) {
            var type = e.layerType, layer = e.layer;
            that.layers.push(layer);
            that.layerGeoJSON = L.featureGroup(that.layers).toGeoJSON();
            that.setValue(that.layerGeoJSON);
            return false;
        });
        map.on('draw:edited', function (e) {
            var layers = e.layers;
            var that2 = that;
            layers.eachLayer(function (layer) {
                var layerIndex = __WEBPACK_IMPORTED_MODULE_4_lodash_es__["findIndex"](that2.layers, function (o) { return o._leaflet_id == layer._leaflet_id; });
                if (layerIndex == -1) {
                    that2.layers.push(layer);
                }
                else {
                    that2.layers[layerIndex] = layer;
                }
            });
        });
        map.on('draw:editstop', function (e) {
            that.layerGeoJSON = L.featureGroup(that.layers).toGeoJSON();
            that.setValue(that.layerGeoJSON);
        });
        map.on('draw:deletestop', function (e) {
            that.layerGeoJSON = L.featureGroup(that.layers).toGeoJSON();
            that.setValue(that.layerGeoJSON);
        });
        map.on('draw:deleted', function (e) {
            var layers = e.layers;
            var that2 = that;
            layers.eachLayer(function (layer) {
                __WEBPACK_IMPORTED_MODULE_4_lodash_es__["remove"](that2.layers, function (o) { return o._leaflet_id == layer._leaflet_id; });
            });
        });
    };
    MapField.prototype.drawLayers = function () {
        this.drawnItems.clearLayers();
        var geoJSONLayer = L.geoJSON(this.layerGeoJSON);
        this.layers = [];
        var that = this;
        geoJSONLayer.eachLayer(function (layer) {
            layer.addTo(that.drawnItems);
            that.layers.push(layer);
        });
    };
    MapField.prototype.postInit = function (value) {
        if (!__WEBPACK_IMPORTED_MODULE_4_lodash_es__["isEmpty"](value)) {
            this.layerGeoJSON = value;
            this.drawLayers();
        }
    };
    MapField.prototype.createFormModel = function (valueElem) {
        if (valueElem === void 0) { valueElem = undefined; }
        if (valueElem) {
            this.layerGeoJSON = valueElem;
        }
        this.formModel = new __WEBPACK_IMPORTED_MODULE_3__angular_forms__["b" /* FormControl */](this.layerGeoJSON || {});
        return this.formModel;
    };
    MapField.prototype.setValue = function (value) {
        if (!__WEBPACK_IMPORTED_MODULE_4_lodash_es__["isEmpty"](value)) {
            this.layerGeoJSON = value;
            this.drawLayers();
            this.formModel.patchValue(this.layerGeoJSON, { emitEvent: false });
            this.formModel.markAsTouched();
        }
    };
    MapField.prototype.setEmptyValue = function () {
        this.layerGeoJSON = {};
        return this.layerGeoJSON;
    };
    MapField.prototype.importData = function () {
        var _this = this;
        if (this.importDataString.length > 0) {
            try {
                if (this.importDataString.indexOf("<") == 0) {
                    //probably KML
                    var parsedLayers = omnivore.kml.parse(this.importDataString);
                    if (parsedLayers.getLayers().length == 0) {
                        this.importFailed = true;
                        return false;
                    }
                    var that_1 = this;
                    parsedLayers.eachLayer(function (layer) {
                        layer.addTo(that_1.drawnItems);
                        that_1.layers.push(layer);
                        that_1.layerGeoJSON = L.featureGroup(that_1.layers).toGeoJSON();
                        _this.drawLayers();
                        that_1.map.fitBounds(that_1.drawnItems.getBounds());
                    });
                    this.importDataString = "";
                    this.importFailed = false;
                }
                else {
                    var parsedLayers = L.geoJSON(JSON.parse(this.importDataString));
                    var that_2 = this;
                    parsedLayers.eachLayer(function (layer) {
                        layer.addTo(that_2.drawnItems);
                        that_2.layers.push(layer);
                        that_2.layerGeoJSON = L.featureGroup(that_2.layers).toGeoJSON();
                        _this.drawLayers();
                        that_2.map.fitBounds(that_2.drawnItems.getBounds());
                    });
                    this.importDataString = "";
                    this.importFailed = false;
                }
            }
            catch (e) {
                this.importFailed = true;
            }
        }
        return false;
    };
    return MapField;
}(__WEBPACK_IMPORTED_MODULE_2__field_base__["a" /* FieldBase */]));

// Setting the template url to a constant rather than directly in the component as the latter breaks document generation
var rbMapDataTemplate = './field-map.html';
if (typeof aotMode == 'undefined') {
    rbMapDataTemplate = '../angular/shared/form/field-map.html';
}
/**
* #### Map Component.
*
* Uses Leaflet.js to render a widget and the Leaflet.draw plugin to be able to select regions
*
* #### Usage
* ```
*  {
*   class: 'MapField',
*   compClass: 'MapComponent',
*   definition: {
*     name: 'geocoords',
*     label: '@dataRecord-coverage',
*     help: '@dataRecord-coverage',
*     tabId: 'coverage',
*     leafletOptions: {
*                      zoom: 3,
*                      center: latLng([108.94248962402342, 34.26516142452615)
*                     }
*     }
*   }
* ```
*
*| Property Name  | Description                                                                                                                                                                                                                                                                                                                       | Required | Default                                                                                                                                                                                                                                                                                  |
*|----------------|-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|----------|------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
*| label          | The label to show above the component                                                                                                                                                                                                                                                                                             | No       *|                                                                                                                                                                                                                                                                                          |
*| help           | Help text                                                                                                                                                                                                                                                                                                                         | No       *|                                                                                                                                                                                                                                                                                          |
*| tabId          | The name of the tab the widget is placed, this is needed as Leaflet needs the map to be visible before the tiles can be loaded correctly. Leave empty if widget isn't placed in a tab.                                                                                                                                            | No       *|                                                                                                                                                                                                                                                                                          |
*| leafletOptions | The leaflet options object. See the [Leaflet's documentation](http://leafletjs.com/reference-1.3.0.html#map-option) for more information. Note: layers cannot be changed as other functionality depends on it being set as it is and will be overridden. Defaults to a map centred on Australia (if no elements are drawn on map) | No       | ```{zoom: 4, center:" latLng([-24.673148, 134.074574]) }```                                                                                                                                                                                                                              |
*| drawOptions    | The leaflet draw options object. See the [Leaflet Draw's documentation](https://leaflet.github.io/Leaflet.draw/docs/leaflet-draw-latest.html#options) for more information. Note: the edit featureGroup cannot be changed as other functionality depends on it being set as it is and will be overridden.                         | No       | ```{position:"topright",draw:{marker:{icon:icon({iconSize:[25,41],iconAnchor:[13,41],iconUrl:"http://localhost:1500/default/rdmp/images/leaflet/marker-icon.png",shadowUrl:"http://localhost:1500/default/rdmp/images/leaflet/marker-shadow.png"})},circlemarker:false,circle:false}}``` |
*/
var MapComponent = /** @class */ (function (_super) {
    __extends(MapComponent, _super);
    function MapComponent() {
        return _super !== null && _super.apply(this, arguments) || this;
    }
    MapComponent = __decorate([
        Object(__WEBPACK_IMPORTED_MODULE_0__angular_core__["Component"])({
            selector: 'rb-mapdata',
            template: __webpack_require__("./redbox-portal/angular/shared/form/field-map.html")
        })
    ], MapComponent);
    return MapComponent;
}(__WEBPACK_IMPORTED_MODULE_1__field_simple_component__["l" /* SimpleComponent */]));



/***/ }),

/***/ "./redbox-portal/angular/shared/form/field-map.html":
/***/ (function(module, exports) {

module.exports = "<div class='padding-bottom-10'>\n  <div *ngIf=\"field.editMode\" [formGroup]='form' class=\"form-group\">\n  <label [attr.for]=\"field.name\">\n    {{field.label}} {{ getRequiredLabelStr()}}\n    <button type=\"button\" class=\"btn btn-default\" *ngIf=\"field.help\" (click)=\"toggleHelp()\"><span class=\"glyphicon glyphicon-question-sign\" aria-hidden=\"true\"></span></button>\n  </label><br/>\n  <span id=\"{{ 'helpBlock_' + field.name }}\" class=\"help-block\" *ngIf=\"this.helpShow\" [innerHtml]=\"field.help\"></span>\n\n  <div leaflet style=\"height: 450px;\"\n       leafletDraw\n       [leafletOptions]=\"field.leafletOptions\"\n       [leafletDrawOptions]=\"field.drawOptions\"\n       (leafletMapReady)=\"field.onMapReady($event)\"\n       [leafletLayersControl]=\"field.layersControl\">\n  </div>\n  <div class='padding-top-10'>\n  <div><label>Enter KML or GeoJSON</label><br/><textarea class=\"form-control\" rows=\"5\" [(ngModel)]=\"field.importDataString\" [ngModelOptions]=\"{standalone: true}\"></textarea></div>\n  <div class=\"padding-top-10\"><a class=\"btn btn-info\" (click)=\"field.importData()\">Import</a> <span *ngIf=\"field.importFailed\" class=\"text-danger\">Entered text is not a valid KML or GeoJSON</span></div>\n</div>\n</div>\n</div>\n<div *ngIf=\"!field.editMode\">\n  <div leaflet style=\"height: 450px;\"\n       [leafletOptions]=\"field.leafletOptions\"\n       (leafletMapReady)=\"field.onMapReady($event)\"\n       [leafletLayersControl]=\"field.layersControl\">\n  </div>\n</div>\n"

/***/ }),

/***/ "./redbox-portal/angular/shared/form/field-pdflist.component.ts":
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "b", function() { return PDFListField; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "a", function() { return PDFListComponent; });
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__angular_core__ = __webpack_require__("./node_modules/@angular/core/esm5/core.js");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1__field_simple_component__ = __webpack_require__("./redbox-portal/angular/shared/form/field-simple.component.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2__field_base__ = __webpack_require__("./redbox-portal/angular/shared/form/field-base.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3__angular_forms__ = __webpack_require__("./node_modules/@angular/forms/esm5/forms.js");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_lodash_es__ = __webpack_require__("./node_modules/lodash-es/lodash.js");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5__records_service__ = __webpack_require__("./redbox-portal/angular/shared/form/records.service.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_6_moment_es6__ = __webpack_require__("./node_modules/moment-es6/index.js");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_6_moment_es6___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_6_moment_es6__);
var __extends = (this && this.__extends) || (function () {
    var extendStatics = Object.setPrototypeOf ||
        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||
        function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };
    return function (d, b) {
        extendStatics(d, b);
        function __() { this.constructor = d; }
        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
    };
})();
var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {
    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
    if (typeof Reflect === "object" && typeof Reflect.decorate === "function") r = Reflect.decorate(decorators, target, key, desc);
    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;
    return c > 3 && r && Object.defineProperty(target, key, r), r;
};
// Copyright (c) 2017 Queensland Cyber Infrastructure Foundation (http://www.qcif.edu.au/)
//
// GNU GENERAL PUBLIC LICENSE
//    Version 2, June 1991
//
// This program is free software; you can redistribute it and/or modify
// it under the terms of the GNU General Public License as published by
// the Free Software Foundation; either version 2 of the License, or
// (at your option) any later version.
//
// This program is distributed in the hope that it will be useful,
// but WITHOUT ANY WARRANTY; without even the implied warranty of
// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
// GNU General Public License for more details.
//
// You should have received a copy of the GNU General Public License along
// with this program; if not, write to the Free Software Foundation, Inc.,
// 51 Franklin Street, Fifth Floor, Boston, MA 02110-1301 USA.







/**
 * Contributor Model
 *
 *
 * @author <a target='_' href='https://github.com/shilob'>Shilo Banihit</a>
 *
 */
var PDFListField = /** @class */ (function (_super) {
    __extends(PDFListField, _super);
    function PDFListField(options, injector) {
        var _this = _super.call(this, options, injector) || this;
        _this.showHistoryTable = false;
        _this.relatedObjects = [];
        _this.accessDeniedObjects = [];
        _this.failedObjects = [];
        _this.columns = options['columns'] || [];
        _this.startsWith = options['startsWith'] || 'rdmp-pdf';
        var relatedObjects = _this.relatedObjects;
        _this.recordsService = _this.getFromInjector(__WEBPACK_IMPORTED_MODULE_5__records_service__["a" /* RecordsService */]);
        _this.pdfAttachments = [];
        return _this;
    }
    PDFListField.prototype.createFormModel = function (valueElem) {
        if (valueElem === void 0) { valueElem = undefined; }
        if (valueElem) {
            this.value = valueElem;
        }
        this.formModel = new __WEBPACK_IMPORTED_MODULE_3__angular_forms__["b" /* FormControl */](this.value || []);
        if (this.value) {
            this.setValue(this.value);
        }
        return this.formModel;
    };
    PDFListField.prototype.setValue = function (value) {
        this.formModel.patchValue(value, { emitEvent: false });
        this.formModel.markAsTouched();
    };
    PDFListField.prototype.setEmptyValue = function () {
        this.value = [];
        return this.value;
    };
    return PDFListField;
}(__WEBPACK_IMPORTED_MODULE_2__field_base__["a" /* FieldBase */]));

/**
* Component to display PDFs related to this record
*
*/
var PDFListComponent = /** @class */ (function (_super) {
    __extends(PDFListComponent, _super);
    function PDFListComponent() {
        return _super !== null && _super.apply(this, arguments) || this;
    }
    PDFListComponent.prototype.ngOnInit = function () {
        var _this = this;
        var oid = this.fieldMap._rootComp.oid;
        if (oid) {
            var allAttachmentsPromise = this.field.recordsService.getAttachments(oid);
            var matchingExpression_1 = new RegExp(this.field.startsWith + "-[0-9a-fA-F]{32}-[0-9]+.pdf");
            var that = this;
            allAttachmentsPromise.then(function (allAttachments) {
                _this.field.latestPdf = null;
                __WEBPACK_IMPORTED_MODULE_4_lodash_es__["forEach"](allAttachments, function (attachment) {
                    if (matchingExpression_1.test(attachment.label)) {
                        attachment.dateUpdated = __WEBPACK_IMPORTED_MODULE_6_moment_es6___default()(attachment.dateUpdated).format('LLL');
                        _this.field.pdfAttachments.push(attachment);
                        if (_this.field.latestPdf == null || __WEBPACK_IMPORTED_MODULE_6_moment_es6___default()(_this.field.latestPdf['dateUploaded']).isBefore(__WEBPACK_IMPORTED_MODULE_6_moment_es6___default()(attachment.dateUpdated))) {
                            _this.field.latestPdf = attachment;
                        }
                    }
                });
                _this.field.pdfAttachments.sort(function compare(a, b) {
                    var before = __WEBPACK_IMPORTED_MODULE_6_moment_es6___default()(a['dateUpdated']).isBefore(__WEBPACK_IMPORTED_MODULE_6_moment_es6___default()(b['dateUpdated']));
                    //We want descending order so let's reverse it
                    return before ? 1 : -1;
                });
            });
        }
    };
    PDFListComponent.prototype.getDownloadUrl = function (attachment) {
        var oid = this.fieldMap._rootComp.oid;
        return this.field.recordsService.getBrandingAndPortalUrl + "/record/" + oid + "/datastream?datastreamId=" + attachment.label;
    };
    PDFListComponent = __decorate([
        Object(__WEBPACK_IMPORTED_MODULE_0__angular_core__["Component"])({
            selector: 'rb-pdf-list',
            template: __webpack_require__("./redbox-portal/angular/shared/form/field-pdflist.html")
        })
    ], PDFListComponent);
    return PDFListComponent;
}(__WEBPACK_IMPORTED_MODULE_1__field_simple_component__["l" /* SimpleComponent */]));



/***/ }),

/***/ "./redbox-portal/angular/shared/form/field-pdflist.html":
/***/ (function(module, exports) {

module.exports = "<span class=\"print-hidden\">\n\n<span *ngIf=\"field.pdfAttachments.length > 0\">\n  <!-- <a [attr.href]=\"getDownloadUrl(field.latestPdf)+'&fileName=rdmp.pdf'\" target=\"_blank\" [ngClass]=\"field.cssClasses\"><i class=\"fa fa-file-pdf-o\">&nbsp;</i> Download a PDF of this plan</a>\n  <a *ngIf=\"field.pdfAttachments.length > 1\" data-toggle=\"modal\" data-target=\"#pdfHistoryModal\" [ngClass]=\"field.cssClasses\">Download a previous version</a> -->\n\n\n<div class=\"btn-group\">\n  <a type=\"button\" [attr.href]=\"getDownloadUrl(field.latestPdf)+'&fileName=rdmp.pdf'\" target=\"_blank\" class=\"btn btn-danger\"><i class=\"fa fa-file-pdf-o\">&nbsp;</i> Download a PDF of this plan</a>\n  <button type=\"button\" class=\"btn btn-danger dropdown-toggle\" data-toggle=\"dropdown\">\n    <span class=\"caret\"></span>\n    <span class=\"sr-only\">Toggle Dropdown</span>\n  </button>\n  <ul class=\"dropdown-menu\" role=\"menu\">\n    <li><a data-toggle=\"modal\" data-target=\"#pdfHistoryModal\">Download a previous version</a></li>\n  </ul>\n</div>\n</span>\n\n<!-- Modal -->\n<div class=\"modal fade\" id=\"pdfHistoryModal\" tabindex=\"-1\" role=\"dialog\" aria-labelledby=\"pdfHistoryModalLabel\" aria-hidden=\"true\">\n  <div class=\"modal-dialog\" role=\"document\">\n    <div class=\"modal-content\">\n      <div class=\"modal-body\">\n        <table class=\"table\">\n          <thead>\n              <tr>\n                  <th>Date created</th><th>Download</th>\n              </tr>\n          </thead>\n          <tbody>\n            <tr *ngFor=\"let item of field.pdfAttachments\">\n              <td>{{ item.dateUpdated }}</td>\n              <td><a [attr.href]=\"getDownloadUrl(item)\" target=\"_blank\"><i class=\"fa fa-file-pdf-o\"></i> Download</a></td>\n            </tr>\n          </tbody>\n        </table>\n      </div>\n      <div class=\"modal-footer\">\n        <button type=\"button\" class=\"btn btn-default\" data-dismiss=\"modal\">Close</button>\n      </div>\n    </div>\n  </div>\n</div>\n</span>\n"

/***/ }),

/***/ "./redbox-portal/angular/shared/form/field-publishdatalocationselector.component.ts":
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "b", function() { return PublishDataLocationSelectorField; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "a", function() { return PublishDataLocationSelectorComponent; });
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__angular_core__ = __webpack_require__("./node_modules/@angular/core/esm5/core.js");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1__field_simple_component__ = __webpack_require__("./redbox-portal/angular/shared/form/field-simple.component.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2__field_base__ = __webpack_require__("./redbox-portal/angular/shared/form/field-base.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_lodash_es__ = __webpack_require__("./node_modules/lodash-es/lodash.js");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4__records_service__ = __webpack_require__("./redbox-portal/angular/shared/form/records.service.ts");
var __extends = (this && this.__extends) || (function () {
    var extendStatics = Object.setPrototypeOf ||
        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||
        function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };
    return function (d, b) {
        extendStatics(d, b);
        function __() { this.constructor = d; }
        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
    };
})();
var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {
    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
    if (typeof Reflect === "object" && typeof Reflect.decorate === "function") r = Reflect.decorate(decorators, target, key, desc);
    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;
    return c > 3 && r && Object.defineProperty(target, key, r), r;
};
// Copyright (c) 2017 Queensland Cyber Infrastructure Foundation (http://www.qcif.edu.au/)
//
// GNU GENERAL PUBLIC LICENSE
//    Version 2, June 1991
//
// This program is free software; you can redistribute it and/or modify
// it under the terms of the GNU General Public License as published by
// the Free Software Foundation; either version 2 of the License, or
// (at your option) any later version.
//
// This program is distributed in the hope that it will be useful,
// but WITHOUT ANY WARRANTY; without even the implied warranty of
// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
// GNU General Public License for more details.
//
// You should have received a copy of the GNU General Public License along
// with this program; if not, write to the Free Software Foundation, Inc.,
// 51 Franklin Street, Fifth Floor, Boston, MA 02110-1301 USA.





/**
 * Contributor Model
 *
 *
 * @author <a target='_' href='https://github.com/shilob'>Shilo Banihit</a>
 *
 */
var PublishDataLocationSelectorField = /** @class */ (function (_super) {
    __extends(PublishDataLocationSelectorField, _super);
    function PublishDataLocationSelectorField(options, injector) {
        var _this = _super.call(this, options, injector) || this;
        _this.newLocation = { type: "url", location: "", notes: "" };
        _this.dataTypes = [{
                'label': 'URL',
                'value': 'url',
            },
            {
                'label': 'Physical location',
                'value': 'physical',
            },
            {
                'label': 'File path',
                'value': 'file',
            },
            {
                'label': 'Attachment',
                'value': 'attachment'
            }
        ];
        _this.dataTypeLookup = {
            'url': "URL",
            'physical': "Physical location",
            'attachment': "Attachment",
            'file': "File path"
        };
        _this.accessDeniedObjects = [];
        _this.columns = options['columns'] || [];
        _this.value = options['value'] || _this.setEmptyValue();
        _this.recordsService = _this.getFromInjector(__WEBPACK_IMPORTED_MODULE_4__records_service__["a" /* RecordsService */]);
        return _this;
    }
    PublishDataLocationSelectorField.prototype.setValue = function (value, emitEvent) {
        if (emitEvent === void 0) { emitEvent = true; }
        this.formModel.setValue(value, { emitEvent: emitEvent, emitModelToViewChange: true });
        this.formModel.markAsTouched();
        this.formModel.markAsDirty();
    };
    PublishDataLocationSelectorField.prototype.setEmptyValue = function () {
        this.value = [];
        return this.value;
    };
    PublishDataLocationSelectorField.prototype.addLocation = function () {
        this.value.push(this.newLocation);
        this.setValue(this.value);
        this.newLocation = { type: "url", location: "", notes: "" };
    };
    PublishDataLocationSelectorField.prototype.appendLocation = function (newLoc) {
        this.value.push(newLoc);
        this.setValue(this.value, true);
    };
    PublishDataLocationSelectorField.prototype.clearPendingAtt = function (value) {
        __WEBPACK_IMPORTED_MODULE_3_lodash_es__["each"](value, function (val) {
            if (val.type == 'attachment') {
                __WEBPACK_IMPORTED_MODULE_3_lodash_es__["unset"](val, 'pending');
            }
        });
    };
    PublishDataLocationSelectorField.prototype.populateDataLocation = function (oid, config) {
        var _this = this;
        console.log(oid);
        this.recordsService.getRecordMeta(oid).then(function (record) {
            _this.value = record.dataLocations;
        });
    };
    PublishDataLocationSelectorField.prototype.removeLocation = function (loc) {
        __WEBPACK_IMPORTED_MODULE_3_lodash_es__["remove"](this.value, function (val) {
            return val.type == loc.type && val.name == loc.name && val.location == loc.location;
        });
        this.setValue(this.value);
    };
    return PublishDataLocationSelectorField;
}(__WEBPACK_IMPORTED_MODULE_2__field_base__["a" /* FieldBase */]));

/**
* Component to display information from related objects within ReDBox
*
*
*
*
*/
var PublishDataLocationSelectorComponent = /** @class */ (function (_super) {
    __extends(PublishDataLocationSelectorComponent, _super);
    function PublishDataLocationSelectorComponent() {
        return _super !== null && _super.apply(this, arguments) || this;
    }
    PublishDataLocationSelectorComponent.prototype.ngOnInit = function () {
    };
    PublishDataLocationSelectorComponent.prototype.selectAllLocations = function (checked) {
        __WEBPACK_IMPORTED_MODULE_3_lodash_es__["each"](this.field.value, function (dataLocation) {
            dataLocation.selected = checked;
        });
    };
    PublishDataLocationSelectorComponent.prototype.getDatalocations = function () {
        return this.field.value;
    };
    PublishDataLocationSelectorComponent.prototype.getAbsUrl = function (location) {
        return this.field.recordsService.getBrandingAndPortalUrl + "/record/" + location;
    };
    PublishDataLocationSelectorComponent = __decorate([
        Object(__WEBPACK_IMPORTED_MODULE_0__angular_core__["Component"])({
            selector: 'publish-data-location-selector',
            template: __webpack_require__("./redbox-portal/angular/shared/form/field-publishdatalocationselector.html")
        })
    ], PublishDataLocationSelectorComponent);
    return PublishDataLocationSelectorComponent;
}(__WEBPACK_IMPORTED_MODULE_1__field_simple_component__["l" /* SimpleComponent */]));



/***/ }),

/***/ "./redbox-portal/angular/shared/form/field-publishdatalocationselector.html":
/***/ (function(module, exports) {

module.exports = "<div class='padding-bottom-10' *ngIf=\"field.visible\">\n  <label [attr.for]=\"field.name\">\n    {{field.label}} {{ getRequiredLabelStr()}}\n    <button type=\"button\" class=\"btn btn-default\" *ngIf=\"field.help\" (click)=\"toggleHelp()\"><span class=\"glyphicon glyphicon-question-sign\" aria-hidden=\"true\"></span></button>\n  </label><br/>\n  <div>\n    <div class=\"table-responsive\">\n    <table class=\"table table-bordered table-striped table-hover\">\n      <thead>\n        <tr>\n          <th width=\"5%\"><input type=\"checkbox\" (change)=\"selectAllLocations($event.target.checked)\"/></th>\n          <th width=\"15%\">Type of location</th>\n          <th width=\"40%\">Location</th>\n          <th width=\"40%\">Notes</th>\n        </tr>\n      </thead>\n      <tbody>\n        <tr *ngFor=\"let dataLocation of getDatalocations()\">\n          <td><input type=\"checkbox\" [(ngModel)]=\"dataLocation.selected\"/></td>\n          <td>{{ field.dataTypeLookup[dataLocation.type] }}</td>\n          <td>\n            <ng-container *ngIf=\"dataLocation && dataLocation.type != 'attachment'\">\n            {{ dataLocation.location }}\n            </ng-container>\n            <ng-container *ngIf=\"dataLocation.type == 'attachment'\">\n              <ng-container *ngIf=\"dataLocation.pending\">\n                {{ dataLocation.name }}\n              </ng-container>\n              <a *ngIf=\"!dataLocation.pending\" href=\"{{ getAbsUrl(dataLocation.location) }}\" target=\"_blank\">\n                {{ dataLocation.name }}\n              </a>\n            </ng-container>\n          </td>\n          <td>{{ dataLocation.notes }}</td>\n\n        </tr>\n      </tbody>\n    </table>\n  </div>\n  <!-- <div><button class=\"btn btn-info\">Export</button></div> -->\n</div>\n</div>\n"

/***/ }),

/***/ "./redbox-portal/angular/shared/form/field-relatedobjectdata.component.ts":
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "b", function() { return RelatedObjectDataField; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "a", function() { return RelatedObjectDataComponent; });
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__angular_core__ = __webpack_require__("./node_modules/@angular/core/esm5/core.js");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1__field_simple_component__ = __webpack_require__("./redbox-portal/angular/shared/form/field-simple.component.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2__field_base__ = __webpack_require__("./redbox-portal/angular/shared/form/field-base.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3__angular_forms__ = __webpack_require__("./node_modules/@angular/forms/esm5/forms.js");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_lodash_es__ = __webpack_require__("./node_modules/lodash-es/lodash.js");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5__records_service__ = __webpack_require__("./redbox-portal/angular/shared/form/records.service.ts");
var __extends = (this && this.__extends) || (function () {
    var extendStatics = Object.setPrototypeOf ||
        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||
        function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };
    return function (d, b) {
        extendStatics(d, b);
        function __() { this.constructor = d; }
        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
    };
})();
var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {
    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
    if (typeof Reflect === "object" && typeof Reflect.decorate === "function") r = Reflect.decorate(decorators, target, key, desc);
    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;
    return c > 3 && r && Object.defineProperty(target, key, r), r;
};
// Copyright (c) 2017 Queensland Cyber Infrastructure Foundation (http://www.qcif.edu.au/)
//
// GNU GENERAL PUBLIC LICENSE
//    Version 2, June 1991
//
// This program is free software; you can redistribute it and/or modify
// it under the terms of the GNU General Public License as published by
// the Free Software Foundation; either version 2 of the License, or
// (at your option) any later version.
//
// This program is distributed in the hope that it will be useful,
// but WITHOUT ANY WARRANTY; without even the implied warranty of
// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
// GNU General Public License for more details.
//
// You should have received a copy of the GNU General Public License along
// with this program; if not, write to the Free Software Foundation, Inc.,
// 51 Franklin Street, Fifth Floor, Boston, MA 02110-1301 USA.






/**
 * Contributor Model
 *
 *
 * @author <a target='_' href='https://github.com/shilob'>Shilo Banihit</a>
 *
 */
var RelatedObjectDataField = /** @class */ (function (_super) {
    __extends(RelatedObjectDataField, _super);
    function RelatedObjectDataField(options, injector) {
        var _this = _super.call(this, options, injector) || this;
        _this.relatedObjects = [];
        _this.accessDeniedObjects = [];
        _this.failedObjects = [];
        _this.columns = options['columns'] || [];
        var relatedObjects = _this.relatedObjects;
        _this.value = options['value'] || _this.setEmptyValue();
        _this.recordsService = _this.getFromInjector(__WEBPACK_IMPORTED_MODULE_5__records_service__["a" /* RecordsService */]);
        var that = _this;
        __WEBPACK_IMPORTED_MODULE_4_lodash_es__["forEach"](_this.value, function (item) {
            _this.recordsService.getRecordMeta(item.id).then(function (meta) {
                if (!meta) {
                    that.failedObjects.push(meta);
                }
                else if (meta.status == "Access Denied") {
                    that.accessDeniedObjects.push(meta);
                }
                else if (meta.title) {
                    that.relatedObjects.push(meta);
                }
                else {
                    that.failedObjects.push(meta);
                }
            });
        });
        return _this;
    }
    RelatedObjectDataField.prototype.createFormModel = function (valueElem) {
        if (valueElem === void 0) { valueElem = undefined; }
        if (valueElem) {
            this.value = valueElem;
        }
        this.formModel = new __WEBPACK_IMPORTED_MODULE_3__angular_forms__["b" /* FormControl */](this.value || []);
        if (this.value) {
            this.setValue(this.value);
        }
        return this.formModel;
    };
    RelatedObjectDataField.prototype.setValue = function (value) {
        this.formModel.patchValue(value, { emitEvent: false });
        this.formModel.markAsTouched();
    };
    RelatedObjectDataField.prototype.setEmptyValue = function () {
        this.value = [];
        return this.value;
    };
    return RelatedObjectDataField;
}(__WEBPACK_IMPORTED_MODULE_2__field_base__["a" /* FieldBase */]));

// Setting the template url to a constant rather than directly in the component as the latter breaks document generation
var rbRelatedObjectDataTemplate = './field-relatedobjectdata.html';
if (typeof aotMode == 'undefined') {
    rbRelatedObjectDataTemplate = '../angular/shared/form/field-relatedobjectdata.html';
}
/**
* Component to display information from related objects within ReDBox
*
*
*
*
*/
var RelatedObjectDataComponent = /** @class */ (function (_super) {
    __extends(RelatedObjectDataComponent, _super);
    function RelatedObjectDataComponent() {
        return _super !== null && _super.apply(this, arguments) || this;
    }
    RelatedObjectDataComponent = __decorate([
        Object(__WEBPACK_IMPORTED_MODULE_0__angular_core__["Component"])({
            selector: 'rb-relatedobjectdata',
            template: __webpack_require__("./redbox-portal/angular/shared/form/field-relatedobjectdata.html")
        })
    ], RelatedObjectDataComponent);
    return RelatedObjectDataComponent;
}(__WEBPACK_IMPORTED_MODULE_1__field_simple_component__["l" /* SimpleComponent */]));



/***/ }),

/***/ "./redbox-portal/angular/shared/form/field-relatedobjectdata.html":
/***/ (function(module, exports) {

module.exports = "<div class='padding-bottom-10'>\n\n  <div class=\"row\">\n    <table class=\"table\">\n      <thead>\n          <tr>\n              <ng-container *ngFor=\"let header of field.columns\"><th *ngIf='header.show != false'>{{ header.label }}</th></ng-container>\n          </tr>\n      </thead>\n      <tbody>\n        <tr *ngFor=\"let item of field.relatedObjects\">\n          <ng-container *ngFor=\"let column of field.columns\">\n            <td *ngIf='column.show != false'>\n              <span *ngIf='column.link === \"relative\"; then relative'></span>\n              <span *ngIf='column.link === \"absolute\"; then absolute; else noProcessing'></span>\n              <ng-template #multivalue></ng-template>\n              <ng-template #relative><a href=\"/{{ branding }}/{{ portal }}/{{ column.link.pattern}}\">{{ column.link.pattern | stringTemplate:item }}</a></ng-template>\n              <ng-template #absolute><a target=\"_blank\" rel=\"noopener noreferrer\" href=\"{{item[column.property]}}\">{{item[column.property]}}</a></ng-template>\n              <ng-template #noProcessing>{{ item[column.property] }}</ng-template>\n            </td>\n          </ng-container>\n        </tr>\n      </tbody>\n    </table>\n    <p *ngIf=\"field.failedObjects.length > 0\">There were {{ field.failedObjects.length }} records that failed to load</p>\n    <p *ngIf=\"field.accessDeniedObjects.length > 0\">There were {{ field.accessDeniedObjects.length }} records that you do not have access to</p>\n  </div>\n</div>\n"

/***/ }),

/***/ "./redbox-portal/angular/shared/form/field-relatedobjectselector.component.ts":
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "b", function() { return RelatedObjectSelectorField; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "a", function() { return RelatedObjectSelectorComponent; });
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__angular_core__ = __webpack_require__("./node_modules/@angular/core/esm5/core.js");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1__field_simple_component__ = __webpack_require__("./redbox-portal/angular/shared/form/field-simple.component.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2__field_base__ = __webpack_require__("./redbox-portal/angular/shared/form/field-base.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3__angular_forms__ = __webpack_require__("./node_modules/@angular/forms/esm5/forms.js");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_lodash_es__ = __webpack_require__("./node_modules/lodash-es/lodash.js");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5__dashboard_service__ = __webpack_require__("./redbox-portal/angular/shared/dashboard-service.ts");
var __extends = (this && this.__extends) || (function () {
    var extendStatics = Object.setPrototypeOf ||
        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||
        function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };
    return function (d, b) {
        extendStatics(d, b);
        function __() { this.constructor = d; }
        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
    };
})();
var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {
    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
    if (typeof Reflect === "object" && typeof Reflect.decorate === "function") r = Reflect.decorate(decorators, target, key, desc);
    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;
    return c > 3 && r && Object.defineProperty(target, key, r), r;
};
// Copyright (c) 2017 Queensland Cyber Infrastructure Foundation (http://www.qcif.edu.au/)
//
// GNU GENERAL PUBLIC LICENSE
//    Version 2, June 1991
//
// This program is free software; you can redistribute it and/or modify
// it under the terms of the GNU General Public License as published by
// the Free Software Foundation; either version 2 of the License, or
// (at your option) any later version.
//
// This program is distributed in the hope that it will be useful,
// but WITHOUT ANY WARRANTY; without even the implied warranty of
// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
// GNU General Public License for more details.
//
// You should have received a copy of the GNU General Public License along
// with this program; if not, write to the Free Software Foundation, Inc.,
// 51 Franklin Street, Fifth Floor, Boston, MA 02110-1301 USA.






/**
 * Contributor Model
 *
 *
 * @author <a target='_' href='https://github.com/shilob'>Shilo Banihit</a>
 *
 */
var RelatedObjectSelectorField = /** @class */ (function (_super) {
    __extends(RelatedObjectSelectorField, _super);
    function RelatedObjectSelectorField(options, injector) {
        var _this = _super.call(this, options, injector) || this;
        _this.relatedObjectSelected = new __WEBPACK_IMPORTED_MODULE_0__angular_core__["EventEmitter"]();
        _this.clName = 'RelatedObjectDataField';
        _this.columnTitle = options['columnTitle'] || "Record title";
        _this.value = options['value'] || _this.setEmptyValue();
        _this.recordType = options['recordType'];
        _this.dashboardService = _this.getFromInjector(__WEBPACK_IMPORTED_MODULE_5__dashboard_service__["a" /* DashboardService */]);
        var that = _this;
        _this.dashboardService.getAllRecordsCanEdit(_this.recordType, '').then(function (draftPlans) {
            _this.plans = draftPlans;
            _this.onFilterChange();
        });
        return _this;
    }
    RelatedObjectSelectorField.prototype.recordSelected = function (record, event) {
        this.setValue({ oid: record.oid, title: record.title });
        this.relatedObjectSelected.emit(record.oid);
    };
    RelatedObjectSelectorField.prototype.resetSelector = function () {
        this.setEmptyValue();
    };
    RelatedObjectSelectorField.prototype.createFormModel = function (valueElem) {
        if (valueElem === void 0) { valueElem = undefined; }
        if (valueElem) {
            this.value = valueElem;
        }
        this.formModel = new __WEBPACK_IMPORTED_MODULE_3__angular_forms__["b" /* FormControl */](this.value || []);
        if (this.value) {
            this.setValue(this.value);
        }
        return this.formModel;
    };
    RelatedObjectSelectorField.prototype.setValue = function (value) {
        this.value = value;
        this.formModel.patchValue(value, { emitEvent: false });
        this.formModel.markAsTouched();
    };
    RelatedObjectSelectorField.prototype.setEmptyValue = function () {
        this.value = {};
        return this.value;
    };
    RelatedObjectSelectorField.prototype.onFilterChange = function () {
        var _this = this;
        this.filteredPlans = __WEBPACK_IMPORTED_MODULE_4_lodash_es__["filter"](this.plans.items, function (plan) {
            plan.selected = false;
            var title = __WEBPACK_IMPORTED_MODULE_4_lodash_es__["isArray"](plan.title) ? plan.title[0] : plan.title;
            return __WEBPACK_IMPORTED_MODULE_4_lodash_es__["toLower"](title).includes(__WEBPACK_IMPORTED_MODULE_4_lodash_es__["toLower"](_this.searchFilterName));
        });
    };
    RelatedObjectSelectorField.prototype.resetFilter = function () {
        this.searchFilterName = null;
        this.onFilterChange();
    };
    return RelatedObjectSelectorField;
}(__WEBPACK_IMPORTED_MODULE_2__field_base__["a" /* FieldBase */]));

/**
* Component to display information from related objects within ReDBox
*
*
*
*/
var RelatedObjectSelectorComponent = /** @class */ (function (_super) {
    __extends(RelatedObjectSelectorComponent, _super);
    function RelatedObjectSelectorComponent() {
        return _super !== null && _super.apply(this, arguments) || this;
    }
    RelatedObjectSelectorComponent = __decorate([
        Object(__WEBPACK_IMPORTED_MODULE_0__angular_core__["Component"])({
            selector: 'rb-RelatedObjectSelector',
            template: __webpack_require__("./redbox-portal/angular/shared/form/field-relatedobjectselector.html")
        })
    ], RelatedObjectSelectorComponent);
    return RelatedObjectSelectorComponent;
}(__WEBPACK_IMPORTED_MODULE_1__field_simple_component__["l" /* SimpleComponent */]));



/***/ }),

/***/ "./redbox-portal/angular/shared/form/field-relatedobjectselector.html":
/***/ (function(module, exports) {

module.exports = "<div class='padding-bottom-10'>\n  <label [attr.for]=\"field.name\">\n    {{field.label}} {{ getRequiredLabelStr()}}\n    <button type=\"button\" class=\"btn btn-default\" *ngIf=\"field.help\" (click)=\"toggleHelp()\"><span class=\"glyphicon glyphicon-question-sign\" aria-hidden=\"true\"></span></button>\n  </label><br/>\n  <div *ngIf=\"field.value.oid\">\n     {{ field.value.title }} <button class=\"btn btn-info\" (click)=\"field.resetSelector()\">Change</button>\n  </div>\n  <div *ngIf=\"!field.value.oid\">\n    <div class=\"input-group\">\n      <span class=\"input-group-addon\" id=\"name-addon\">Filter by name</span>\n      <input type=\"text\" (keyup)=\"field.onFilterChange()\" [(ngModel)]=\"field.searchFilterName\" class=\"form-control\" placeholder=\"Name\" aria-describedby=\"name-addon\">\n      <span  (click)=\"field.resetFilter()\" class=\"input-group-btn\"><button class=\"btn btn-primary\" type='button'>{{ 'transfer-ownership-reset' | translate }}</button></span>\n    </div>\n    <div><br/></div>\n    <div class=\"table-responsive\">\n    <table class=\"table table-bordered table-striped table-hover\">\n      <thead>\n        <tr>\n          <th>{{ field.columnTitle }}</th>\n        </tr>\n      </thead>\n      <tbody>\n        <tr *ngFor=\"let plan of field.filteredPlans\" (click)=\"field.recordSelected(plan,$event)\">\n          <td>{{ plan.title }}</td>\n        </tr>\n      </tbody>\n    </table>\n  </div>\n</div>\n</div>\n"

/***/ }),

/***/ "./redbox-portal/angular/shared/form/field-repeatable.component.ts":
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "c", function() { return RepeatableContainer; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "a", function() { return EmbeddableComponent; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "b", function() { return RepeatableComponent; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "f", function() { return RepeatableVocab; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "g", function() { return RepeatableVocabComponent; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "d", function() { return RepeatableContributor; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "e", function() { return RepeatableContributorComponent; });
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__angular_core__ = __webpack_require__("./node_modules/@angular/core/esm5/core.js");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1__field_simple_component__ = __webpack_require__("./redbox-portal/angular/shared/form/field-simple.component.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2__field_simple__ = __webpack_require__("./redbox-portal/angular/shared/form/field-simple.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3__angular_forms__ = __webpack_require__("./node_modules/@angular/forms/esm5/forms.js");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_lodash_es__ = __webpack_require__("./node_modules/lodash-es/lodash.js");
// Copyright (c) 2017 Queensland Cyber Infrastructure Foundation (http://www.qcif.edu.au/)
//
// GNU GENERAL PUBLIC LICENSE
//    Version 2, June 1991
//
// This program is free software; you can redistribute it and/or modify
// it under the terms of the GNU General Public License as published by
// the Free Software Foundation; either version 2 of the License, or
// (at your option) any later version.
//
// This program is distributed in the hope that it will be useful,
// but WITHOUT ANY WARRANTY; without even the implied warranty of
// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
// GNU General Public License for more details.
//
// You should have received a copy of the GNU General Public License along
// with this program; if not, write to the Free Software Foundation, Inc.,
// 51 Franklin Street, Fifth Floor, Boston, MA 02110-1301 USA.
var __extends = (this && this.__extends) || (function () {
    var extendStatics = Object.setPrototypeOf ||
        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||
        function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };
    return function (d, b) {
        extendStatics(d, b);
        function __() { this.constructor = d; }
        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
    };
})();
var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {
    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
    if (typeof Reflect === "object" && typeof Reflect.decorate === "function") r = Reflect.decorate(decorators, target, key, desc);
    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;
    return c > 3 && r && Object.defineProperty(target, key, r), r;
};
var __metadata = (this && this.__metadata) || function (k, v) {
    if (typeof Reflect === "object" && typeof Reflect.metadata === "function") return Reflect.metadata(k, v);
};





/**
 * Repeatable Field Container
 *
 * Author: <a href='https://github.com/shilob' target='_blank'>Shilo Banihit</a>
 *
 */
var RepeatableContainer = /** @class */ (function (_super) {
    __extends(RepeatableContainer, _super);
    function RepeatableContainer(options, injector) {
        var _this = _super.call(this, options, injector) || this;
        _this.hasGroup = true;
        _this.addButtonText = options['addButtonText'] || '';
        _this.removeButtonText = options['removeButtonText'] || null;
        _this.skipClone = options['skipClone'] || [];
        _this.forceClone = options['forceClone'] || [];
        _this.addButtonTextClass = options['addButtonTextClass'] || 'btn btn-success pull-right';
        _this.addButtonClass = options['addButtonClass'] || 'fa fa-plus-circle btn text-20 pull-right btn-success';
        _this.removeButtonTextClass = options['removeButtonTextClass'] || 'btn btn-danger pull-right';
        _this.removeButtonClass = options['removeButtonClass'] || 'fa fa-minus-circle btn text-20 pull-right btn-danger';
        _this.moveUpButtonClass = options['addButtonClass'] || 'fa fa-chevron-circle-up btn text-20 pull-left btn-primary';
        _this.moveDownButtonClass = options['addButtonClass'] || 'fa fa-chevron-circle-down btn text-20 pull-left btn-primary';
        return _this;
    }
    RepeatableContainer.prototype.getInitArrayEntry = function () {
        if (this.fields[0].isGroup) {
            var grp = {};
            var fm = {};
            var fg = this.fields[0].getGroup(grp, fm);
            return [fg];
        }
        return [this.fields[0].createFormModel()];
    };
    RepeatableContainer.prototype.getGroup = function (group, fieldMap) {
        var _this = this;
        this.fieldMap = fieldMap;
        fieldMap[this.name] = { field: this };
        if (!this.value || this.value.length == 0) {
            this.formModel = this.required ? new __WEBPACK_IMPORTED_MODULE_3__angular_forms__["a" /* FormArray */](this.getInitArrayEntry(), __WEBPACK_IMPORTED_MODULE_3__angular_forms__["i" /* Validators */].required) : new __WEBPACK_IMPORTED_MODULE_3__angular_forms__["a" /* FormArray */](this.getInitArrayEntry());
        }
        else {
            var fieldCtr_1 = 0;
            var baseField_1 = this.fields[0];
            var elems_1 = [];
            this.fields = __WEBPACK_IMPORTED_MODULE_4_lodash_es__["map"](this.value, function (valueElem) {
                var fieldClone = null;
                if (fieldCtr_1 == 0) {
                    fieldClone = baseField_1;
                    fieldClone.value = __WEBPACK_IMPORTED_MODULE_4_lodash_es__["isArray"](valueElem) ? valueElem[fieldCtr_1] : valueElem;
                }
                else {
                    fieldClone = _this.createNewElem(baseField_1, __WEBPACK_IMPORTED_MODULE_4_lodash_es__["isArray"](valueElem) ? valueElem[fieldCtr_1] : valueElem);
                    fieldClone.value = __WEBPACK_IMPORTED_MODULE_4_lodash_es__["isArray"](valueElem) ? valueElem[fieldCtr_1] : valueElem;
                }
                fieldCtr_1++;
                elems_1.push(fieldClone.createFormModel());
                return fieldClone;
            });
            this.formModel = this.required ? new __WEBPACK_IMPORTED_MODULE_3__angular_forms__["a" /* FormArray */](elems_1, __WEBPACK_IMPORTED_MODULE_3__angular_forms__["i" /* Validators */].required) : new __WEBPACK_IMPORTED_MODULE_3__angular_forms__["a" /* FormArray */](elems_1);
            __WEBPACK_IMPORTED_MODULE_4_lodash_es__["each"](this.fields, function (f) {
                f.setupEventHandlers();
            });
        }
        fieldMap[this.name].control = this.formModel;
        if (this.groupName) {
            if (group[this.groupName]) {
                group[this.groupName].addControl(this.name, this.formModel);
            }
            else {
                var fg = {};
                fg[this.name] = this.formModel;
                group[this.groupName] = fg;
            }
        }
        else {
            group[this.name] = this.formModel;
        }
    };
    RepeatableContainer.prototype.createNewElem = function (baseFieldInst, value) {
        var _this = this;
        if (value === void 0) { value = null; }
        var newOpts = __WEBPACK_IMPORTED_MODULE_4_lodash_es__["cloneDeep"](baseFieldInst.options);
        newOpts.value = value;
        var newInst = new baseFieldInst.constructor(newOpts, this.injector);
        __WEBPACK_IMPORTED_MODULE_4_lodash_es__["forEach"](this.skipClone, function (f) {
            newInst[f] = null;
        });
        __WEBPACK_IMPORTED_MODULE_4_lodash_es__["forEach"](this.forceClone, function (f) {
            if (__WEBPACK_IMPORTED_MODULE_4_lodash_es__["isString"](f)) {
                newInst[f] = __WEBPACK_IMPORTED_MODULE_4_lodash_es__["cloneDeepWith"](baseFieldInst[f], _this.getCloneCustomizer({
                    skipClone: ['fields', 'fieldMap', 'formModel', 'injector', 'onValueUpdate', 'onValueLoaded', 'translationService', 'utilityService', 'componentReactors'],
                    copy: ['fieldMap', 'injector', 'translationService', 'utilityService']
                }));
            }
            else {
                newInst[f.field] = __WEBPACK_IMPORTED_MODULE_4_lodash_es__["cloneDeepWith"](baseFieldInst[f.field], _this.getCloneCustomizer(f));
            }
        });
        if (__WEBPACK_IMPORTED_MODULE_4_lodash_es__["isFunction"](newInst.postInit)) {
            newInst.postInit(value);
        }
        return newInst;
    };
    RepeatableContainer.prototype.getCloneCustomizer = function (cloneOpts) {
        var that = this;
        return function (value, key) {
            if (__WEBPACK_IMPORTED_MODULE_4_lodash_es__["includes"](cloneOpts.skipClone, key)) {
                if (__WEBPACK_IMPORTED_MODULE_4_lodash_es__["includes"](cloneOpts.copy, key)) {
                    return that[key];
                }
                return false;
            }
        };
    };
    RepeatableContainer.prototype.addElem = function (val) {
        if (val === void 0) { val = null; }
        var newElem = this.createNewElem(this.fields[0], val);
        if (val == null && __WEBPACK_IMPORTED_MODULE_4_lodash_es__["isFunction"](newElem.setEmptyValue)) {
            newElem.setEmptyValue();
        }
        this.fields.push(newElem);
        var newFormModel = newElem.createFormModel();
        this.formModel.push(newFormModel);
        return newElem;
    };
    RepeatableContainer.prototype.removeElem = function (index) {
        __WEBPACK_IMPORTED_MODULE_4_lodash_es__["remove"](this.fields, function (val, idx) { return idx == index; });
        this.formModel.removeAt(index);
    };
    RepeatableContainer.prototype.swap = function (fromIdx, toIdx) {
        var temp = this.fields[toIdx];
        this.fields[toIdx] = this.fields[fromIdx];
        this.fields[fromIdx] = temp;
        temp = this.formModel.at(toIdx);
        this.formModel.setControl(toIdx, this.formModel.at(fromIdx));
        this.formModel.setControl(fromIdx, temp);
    };
    RepeatableContainer.prototype.setValueAtElem = function (index, value) {
        this.fields[index].setValue(value, true);
    };
    RepeatableContainer.prototype.triggerValidation = function () {
        __WEBPACK_IMPORTED_MODULE_4_lodash_es__["forEach"](this.fields, function (f) {
            f.triggerValidation();
        });
    };
    RepeatableContainer.prototype.reactEvent = function (eventName, eventData, origData) {
        var _this = this;
        console.log("Repeatable container field reacting: " + eventName);
        console.log(eventData);
        // delete first...
        for (var toDelIdx = 1; toDelIdx < this.fields.length; toDelIdx++) {
            this.removeElem(toDelIdx);
        }
        __WEBPACK_IMPORTED_MODULE_4_lodash_es__["each"](eventData, function (entry, idx) {
            if (idx >= _this.formModel.controls.length) {
                _this.addElem(entry);
            }
            else {
                _this.setValueAtElem(idx, entry);
            }
        });
    };
    return RepeatableContainer;
}(__WEBPACK_IMPORTED_MODULE_2__field_simple__["d" /* Container */]));

var EmbeddableComponent = /** @class */ (function (_super) {
    __extends(EmbeddableComponent, _super);
    function EmbeddableComponent() {
        var _this = _super !== null && _super.apply(this, arguments) || this;
        _this.canRemove = false;
        _this.removeBtnText = null;
        _this.removeBtnClass = 'btn fa fa-minus-circle btn text-20 pull-left btn btn-danger';
        _this.onRemoveBtnClick = new __WEBPACK_IMPORTED_MODULE_0__angular_core__["EventEmitter"]();
        return _this;
    }
    EmbeddableComponent.prototype.onRemove = function (event) {
        this.onRemoveBtnClick.emit([event, this.index]);
    };
    EmbeddableComponent.prototype.getGroupClass = function (fldName) {
        if (fldName === void 0) { fldName = null; }
        var baseClass = 'form-group';
        if (this.isEmbedded) {
            baseClass = '';
        }
        return baseClass + " " + (this.hasRequiredError() ? 'has-error' : '') + " " + this.field.groupClasses;
    };
    __decorate([
        Object(__WEBPACK_IMPORTED_MODULE_0__angular_core__["Input"])(),
        __metadata("design:type", Boolean)
    ], EmbeddableComponent.prototype, "canRemove", void 0);
    __decorate([
        Object(__WEBPACK_IMPORTED_MODULE_0__angular_core__["Input"])(),
        __metadata("design:type", String)
    ], EmbeddableComponent.prototype, "removeBtnText", void 0);
    __decorate([
        Object(__WEBPACK_IMPORTED_MODULE_0__angular_core__["Input"])(),
        __metadata("design:type", String)
    ], EmbeddableComponent.prototype, "removeBtnClass", void 0);
    __decorate([
        Object(__WEBPACK_IMPORTED_MODULE_0__angular_core__["Input"])(),
        __metadata("design:type", Number)
    ], EmbeddableComponent.prototype, "index", void 0);
    __decorate([
        Object(__WEBPACK_IMPORTED_MODULE_0__angular_core__["Output"])(),
        __metadata("design:type", __WEBPACK_IMPORTED_MODULE_0__angular_core__["EventEmitter"])
    ], EmbeddableComponent.prototype, "onRemoveBtnClick", void 0);
    return EmbeddableComponent;
}(__WEBPACK_IMPORTED_MODULE_1__field_simple_component__["l" /* SimpleComponent */]));

var RepeatableComponent = /** @class */ (function (_super) {
    __extends(RepeatableComponent, _super);
    function RepeatableComponent() {
        return _super !== null && _super.apply(this, arguments) || this;
    }
    RepeatableComponent.prototype.addElem = function (event) {
        this.field.addElem();
    };
    RepeatableComponent.prototype.removeElem = function (event, i) {
        this.field.removeElem(i);
    };
    return RepeatableComponent;
}(__WEBPACK_IMPORTED_MODULE_1__field_simple_component__["l" /* SimpleComponent */]));

var RepeatableVocab = /** @class */ (function (_super) {
    __extends(RepeatableVocab, _super);
    function RepeatableVocab(options, injector) {
        var _this = _super.call(this, options, injector) || this;
        _this.clName = 'RepeatableVocab';
        return _this;
    }
    RepeatableVocab.prototype.setValueAtElem = function (index, value) {
        console.log("Repeatable vocab setting value at: " + index);
        console.log(value);
        this.fields[index].component.onSelect(value, false, true);
    };
    return RepeatableVocab;
}(RepeatableContainer));

var RepeatableVocabComponent = /** @class */ (function (_super) {
    __extends(RepeatableVocabComponent, _super);
    function RepeatableVocabComponent() {
        return _super !== null && _super.apply(this, arguments) || this;
    }
    RepeatableVocabComponent.clName = 'RepeatableVocabComponent';
    RepeatableVocabComponent = __decorate([
        Object(__WEBPACK_IMPORTED_MODULE_0__angular_core__["Component"])({
            selector: 'repeatable-vocab',
            template: "\n  <div *ngIf=\"field.editMode\">\n    <div class=\"row\">\n      <div class=\"col-xs-12\">\n      <label>{{field.label}}\n        <button type=\"button\" class=\"btn btn-default\" *ngIf=\"field.help\" (click)=\"toggleHelp()\"><span class=\"glyphicon glyphicon-question-sign\" aria-hidden=\"true\"></span></button>\n      </label>\n      <span id=\"{{ 'helpBlock_' + field.name }}\" class=\"help-block\" *ngIf=\"this.helpShow\" [innerHtml]=\"field.help\"></span>\n      </div>\n    </div>\n    <div *ngFor=\"let fieldElem of field.fields; let i = index;\" class=\"row\">\n      <span class=\"col-xs-12\">\n        <rb-vocab [field]=\"fieldElem\" [form]=\"form\" [fieldMap]=\"fieldMap\" [isEmbedded]=\"true\" [removeBtnText]=\"field.removeButtonText\" [removeBtnClass]=\"field.removeButtonClass\" [canRemove]=\"field.fields.length > 1\" (onRemoveBtnClick)=\"removeElem($event[0], $event[1])\" [index]=\"i\"></rb-vocab>\n      </span>\n    </div>\n    <div class=\"row\">\n      <span class=\"col-xs-11\">&nbsp;\n      </span>\n      <span class=\"col-xs-1\">\n        <button *ngIf=\"field.addButtonText\" type='button' (click)=\"addElem($event)\" [ngClass]=\"field.addButtonTextClass\" >{{field.addButtonText}}</button>\n        <button *ngIf=\"!field.addButtonText\" type='button' (click)=\"addElem($event)\" [ngClass]=\"field.addButtonClass\"></button>\n      </span>\n    </div>\n  </div>\n  <li *ngIf=\"!field.editMode\" class=\"key-value-pair\">\n    <span *ngIf=\"field.label\" class=\"key\">{{field.label}}</span>\n    <span class=\"value\">\n      <ul class=\"key-value-list\">\n        <rb-vocab *ngFor=\"let fieldElem of field.fields; let i = index;\" [field]=\"fieldElem\" [form]=\"form\" [fieldMap]=\"fieldMap\"></rb-vocab>\n      </ul>\n    </span>\n  </li>\n  ",
        })
    ], RepeatableVocabComponent);
    return RepeatableVocabComponent;
}(RepeatableComponent));

var RepeatableContributor = /** @class */ (function (_super) {
    __extends(RepeatableContributor, _super);
    function RepeatableContributor(options, injector) {
        var _this = _super.call(this, options, injector) || this;
        _this.canSort = __WEBPACK_IMPORTED_MODULE_4_lodash_es__["isUndefined"](options['canSort']) ? false : options['canSort'];
        return _this;
    }
    RepeatableContributor.prototype.setValueAtElem = function (index, value) {
        this.fields[index].component.onSelect(value, false, true);
    };
    return RepeatableContributor;
}(RepeatableContainer));

var RepeatableContributorComponent = /** @class */ (function (_super) {
    __extends(RepeatableContributorComponent, _super);
    function RepeatableContributorComponent() {
        return _super !== null && _super.apply(this, arguments) || this;
    }
    RepeatableContributorComponent.prototype.ngOnInit = function () {
        this.field.fields[0].marginTop = this.field.fields[0].baseMarginTop;
        this.field.fields[0].componentReactors.push(this);
    };
    RepeatableContributorComponent.prototype.addElem = function (event) {
        var newElem = this.field.addElem();
        newElem.marginTop = '0px';
        newElem.vocabField.initialValue = null;
        newElem.setupEventHandlers();
        newElem.componentReactors.push(this);
    };
    RepeatableContributorComponent.prototype.removeElem = function (event, i) {
        this.field.removeElem(i);
        if (i == 0) {
            this.field.fields[0].marginTop = this.field.fields[0].baseMarginTop;
            this.field.fields[0]["showHeader"] = true;
        }
    };
    RepeatableContributorComponent.prototype.reactEvent = function (eventName, eventData, origData, elem) {
        if (this.field.fields.length > 0) {
            elem.marginTop = '0px';
            elem.vocabField.initialValue = eventData;
            elem.setupEventHandlers();
            elem.componentReactors.push(this);
        }
    };
    RepeatableContributorComponent.prototype.moveUp = function (event, i) {
        var newIdx = i - 1;
        if (newIdx >= 0) {
            this.field.swap(i, newIdx);
            if (newIdx == 0) {
                this.field.fields[i].showHeader = false;
                this.field.fields[i].marginTop = '';
                this.field.fields[newIdx].showHeader = true;
                this.field.fields[newIdx].marginTop = this.field.fields[newIdx].baseMarginTop;
            }
        }
    };
    RepeatableContributorComponent.prototype.moveDown = function (event, i) {
        var newIdx = i + 1;
        if (newIdx < this.field.fields.length) {
            this.field.swap(i, newIdx);
            if (i == 0) {
                this.field.fields[i].showHeader = true;
                this.field.fields[i].marginTop = this.field.fields[i].baseMarginTop;
                this.field.fields[newIdx].showHeader = false;
                this.field.fields[newIdx].marginTop = '';
            }
        }
    };
    RepeatableContributorComponent = __decorate([
        Object(__WEBPACK_IMPORTED_MODULE_0__angular_core__["Component"])({
            selector: 'repeatable-contributor',
            template: "\n  <div *ngIf=\"field.editMode\">\n    <div *ngFor=\"let fieldElem of field.fields; let i = index;\" class=\"row\">\n      <span class=\"col-xs-9\">\n        <rb-contributor [field]=\"fieldElem\" [form]=\"form\" [fieldMap]=\"fieldMap\" [isEmbedded]=\"true\"></rb-contributor>\n      </span>\n      <span class=\"col-xs-3\">\n        <button type='button' *ngIf=\"field.fields.length > 1 && field.canSort\"  (click)=\"moveUp($event, i)\" [ngClass]=\"field.moveUpButtonClass\" [ngStyle]=\"{'margin-top': fieldElem.marginTop}\" ></button>\n        <button type='button' *ngIf=\"field.fields.length > 1 && field.canSort\"  (click)=\"moveDown($event, i)\" [ngClass]=\"field.moveDownButtonClass\" [ngStyle]=\"{'margin-top': fieldElem.marginTop}\" ></button>\n        <button type='button' *ngIf=\"field.fields.length > 1 && field.removeButtonText\" (click)=\"removeElem($event, i)\"  [ngClass]=\"field.removeButtonTextClass\" [ngStyle]=\"{'margin-top': fieldElem.marginTop}\" >{{field.removeButtonText}}</button>\n        <button type='button' *ngIf=\"field.fields.length > 1 && !field.removeButtonText\" (click)=\"removeElem($event, i)\" [ngClass]=\"field.removeButtonClass\" [ngStyle]=\"{'margin-top': fieldElem.marginTop}\" ></button>\n      </span>\n    </div>\n    <div class=\"row\">\n      <span class=\"col-xs-12\">\n        <button *ngIf=\"field.addButtonText\" type='button' (click)=\"addElem($event)\" [ngClass]=\"field.addButtonTextClass\" >{{field.addButtonText}}</button>\n        <button *ngIf=\"!field.addButtonText\" type='button' (click)=\"addElem($event)\" [ngClass]=\"field.addButtonClass\" ></button>\n      </span>\n    </div>\n  </div>\n  <ng-container  *ngIf=\"!field.editMode\">\n    <div class=\"row\">\n      <div class=\"col-xs-3\"><label>{{field.fields[0].nameColHdr}}</label></div>\n      <div class=\"col-xs-3\"><label>{{field.fields[0].emailColHdr}}</label></div>\n      <div class=\"col-xs-3\"><label>{{field.fields[0].roleColHdr}}</label></div>\n      <div class=\"col-xs-3\"><label>{{field.fields[0].orcidColHdr}}</label></div>\n    </div>\n    <div class=\"row\" *ngFor=\"let fieldElem of field.fields; let i = index;\">\n      <div class=\"col-xs-3\">{{fieldElem.value.text_full_name}}</div>\n      <div class=\"col-xs-3\">{{fieldElem.value.email}}</div>\n      <div class=\"col-xs-3\">{{fieldElem.value.role}}</div>\n      <div class=\"col-xs-3\">{{fieldElem.value.orcid}}</div>\n    </div>\n  </ng-container>\n  ",
        })
    ], RepeatableContributorComponent);
    return RepeatableContributorComponent;
}(RepeatableComponent));



/***/ }),

/***/ "./redbox-portal/angular/shared/form/field-simple.component.ts":
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "l", function() { return SimpleComponent; });
/* unused harmony export SelectionComponent */
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "e", function() { return DropdownFieldComponent; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "k", function() { return SelectionFieldComponent; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "o", function() { return TabOrAccordionContainerComponent; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "b", function() { return ButtonBarContainerComponent; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "g", function() { return HtmlRawComponent; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "p", function() { return TextBlockComponent; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "j", function() { return SaveButtonComponent; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "c", function() { return CancelButtonComponent; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "a", function() { return AnchorOrButtonComponent; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "n", function() { return TabNavButtonComponent; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "h", function() { return LinkValueComponent; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "f", function() { return HiddenValueComponent; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "d", function() { return DateTimeComponent; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "i", function() { return ParameterRetrieverComponent; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "m", function() { return SpacerComponent; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "q", function() { return ToggleComponent; });
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__angular_core__ = __webpack_require__("./node_modules/@angular/core/esm5/core.js");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1__field_base__ = __webpack_require__("./redbox-portal/angular/shared/form/field-base.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2__angular_forms__ = __webpack_require__("./node_modules/@angular/forms/esm5/forms.js");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_lodash_es__ = __webpack_require__("./node_modules/lodash-es/lodash.js");
// Copyright (c) 2017 Queensland Cyber Infrastructure Foundation (http://www.qcif.edu.au/)
//
// GNU GENERAL PUBLIC LICENSE
//    Version 2, June 1991
//
// This program is free software; you can redistribute it and/or modify
// it under the terms of the GNU General Public License as published by
// the Free Software Foundation; either version 2 of the License, or
// (at your option) any later version.
//
// This program is distributed in the hope that it will be useful,
// but WITHOUT ANY WARRANTY; without even the implied warranty of
// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
// GNU General Public License for more details.
//
// You should have received a copy of the GNU General Public License along
// with this program; if not, write to the Free Software Foundation, Inc.,
// 51 Franklin Street, Fifth Floor, Boston, MA 02110-1301 USA.
var __extends = (this && this.__extends) || (function () {
    var extendStatics = Object.setPrototypeOf ||
        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||
        function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };
    return function (d, b) {
        extendStatics(d, b);
        function __() { this.constructor = d; }
        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
    };
})();
var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {
    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
    if (typeof Reflect === "object" && typeof Reflect.decorate === "function") r = Reflect.decorate(decorators, target, key, desc);
    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;
    return c > 3 && r && Object.defineProperty(target, key, r), r;
};
var __metadata = (this && this.__metadata) || function (k, v) {
    if (typeof Reflect === "object" && typeof Reflect.metadata === "function") return Reflect.metadata(k, v);
};




/**
 * A component base class
 *
 * Author: <a href='https://github.com/shilob' target='_blank'>Shilo Banihit</a>
 */
var SimpleComponent = /** @class */ (function () {
    function SimpleComponent() {
        this.isEmbedded = false;
    }
    /**
     * Return the NG2 FormControl or subclass thereof
     * @param  {string = null} name
     * @return {FormControl}
     */
    SimpleComponent.prototype.getFormControl = function (name, ctrlIndex) {
        if (name === void 0) { name = null; }
        if (ctrlIndex === void 0) { ctrlIndex = null; }
        var fc = null;
        if (__WEBPACK_IMPORTED_MODULE_3_lodash_es__["isEmpty"](name)) {
            name = this.name;
        }
        if (__WEBPACK_IMPORTED_MODULE_3_lodash_es__["isEmpty"](name)) {
            name = this.field.name;
        }
        if (this.fieldMap && this.field) {
            // console.log(name);
            fc = this.field.getControl(name, this.fieldMap);
        }
        if (!__WEBPACK_IMPORTED_MODULE_3_lodash_es__["isNull"](ctrlIndex) && !__WEBPACK_IMPORTED_MODULE_3_lodash_es__["isUndefined"](ctrlIndex)) {
            if (!__WEBPACK_IMPORTED_MODULE_3_lodash_es__["isNull"](fc.controls) && !__WEBPACK_IMPORTED_MODULE_3_lodash_es__["isUndefined"](fc.controls)) {
                fc = fc.controls[ctrlIndex];
            }
        }
        else if (this.index != null) {
            fc = fc.controls[this.index];
        }
        if (name != this.field.name && !__WEBPACK_IMPORTED_MODULE_3_lodash_es__["isEmpty"](this.field.name) && !__WEBPACK_IMPORTED_MODULE_3_lodash_es__["isUndefined"](fc.controls)) {
            fc = fc.controls[this.field.name];
        }
        return fc;
    };
    /**
     * Returns the CSS class
     * @param  {string=null} fldName
     * @return {string}
     */
    SimpleComponent.prototype.getGroupClass = function (fldName) {
        if (fldName === void 0) { fldName = null; }
        return this.field.groupClasses + " form-group " + (this.hasRequiredError() ? 'has-error' : '');
    };
    /**
     * If this field has a 'required' error.
     * Author: <a href='https://github.com/shilob' target='_blank'>Shilo Banihit</a>
     * @return {[type]}
     */
    SimpleComponent.prototype.hasRequiredError = function () {
        return (this.field.formModel ? this.field.formModel.touched && this.field.formModel.hasError('required') : false);
    };
    /**
     * Convenience method to toggle help mode.
     * @return {[type]}
     */
    SimpleComponent.prototype.toggleHelp = function () {
        this.helpShow = !this.helpShow;
    };
    /**
     * Returns label
     * @return {string}
     */
    SimpleComponent.prototype.getRequiredLabelStr = function () {
        return this.field.required ? '(*)' : '';
    };
    /**
     * Returns the NG2 root injector
     * @param  {any} token
     * @return {any}
     */
    SimpleComponent.prototype.getFromInjector = function (token) {
        return this.injector.get(token);
    };
    __decorate([
        Object(__WEBPACK_IMPORTED_MODULE_0__angular_core__["Input"])(),
        __metadata("design:type", __WEBPACK_IMPORTED_MODULE_1__field_base__["a" /* FieldBase */])
    ], SimpleComponent.prototype, "field", void 0);
    __decorate([
        Object(__WEBPACK_IMPORTED_MODULE_0__angular_core__["Input"])(),
        __metadata("design:type", __WEBPACK_IMPORTED_MODULE_2__angular_forms__["c" /* FormGroup */])
    ], SimpleComponent.prototype, "form", void 0);
    __decorate([
        Object(__WEBPACK_IMPORTED_MODULE_0__angular_core__["Input"])(),
        __metadata("design:type", Object)
    ], SimpleComponent.prototype, "fieldMap", void 0);
    __decorate([
        Object(__WEBPACK_IMPORTED_MODULE_0__angular_core__["Input"])(),
        __metadata("design:type", Object)
    ], SimpleComponent.prototype, "index", void 0);
    __decorate([
        Object(__WEBPACK_IMPORTED_MODULE_0__angular_core__["Input"])(),
        __metadata("design:type", Object)
    ], SimpleComponent.prototype, "name", void 0);
    __decorate([
        Object(__WEBPACK_IMPORTED_MODULE_0__angular_core__["Input"])(),
        __metadata("design:type", Boolean)
    ], SimpleComponent.prototype, "isEmbedded", void 0);
    return SimpleComponent;
}());

var SelectionComponent = /** @class */ (function (_super) {
    __extends(SelectionComponent, _super);
    function SelectionComponent() {
        return _super !== null && _super.apply(this, arguments) || this;
    }
    SelectionComponent.prototype.getLabel = function (val) {
        var opt = __WEBPACK_IMPORTED_MODULE_3_lodash_es__["find"](this.field.options, function (opt) {
            return opt.value == val;
        });
        if (opt) {
            return opt.label;
        }
        else {
            return '';
        }
    };
    return SelectionComponent;
}(SimpleComponent));

var DropdownFieldComponent = /** @class */ (function (_super) {
    __extends(DropdownFieldComponent, _super);
    function DropdownFieldComponent() {
        return _super !== null && _super.apply(this, arguments) || this;
    }
    DropdownFieldComponent.clName = 'DropdownFieldComponent';
    DropdownFieldComponent = __decorate([
        Object(__WEBPACK_IMPORTED_MODULE_0__angular_core__["Component"])({
            selector: 'dropdownfield',
            template: "\n  <div [formGroup]='form' *ngIf=\"field.editMode\" [ngClass]=\"getGroupClass()\">\n     <label [attr.for]=\"field.name\">\n      {{field.label}} {{ getRequiredLabelStr()}}\n      <button type=\"button\" class=\"btn btn-default\" *ngIf=\"field.help\" (click)=\"toggleHelp()\"><span class=\"glyphicon glyphicon-question-sign\" aria-hidden=\"true\"></span></button>\n     </label><br/>\n     <span id=\"{{ 'helpBlock_' + field.name }}\" class=\"help-block\" *ngIf=\"this.helpShow\" [innerHtml]=\"field.help\"></span>\n     <select [formControl]=\"getFormControl()\"  [id]=\"field.name\" [ngClass]=\"field.cssClasses\">\n        <option *ngFor=\"let opt of field.options\" [value]=\"opt.value\">{{opt.label}}</option>\n     </select>\n     <div class=\"text-danger\" *ngIf=\"getFormControl().hasError('required') && getFormControl().touched && !field.validationMessages?.required\">{{field.label}} is required</div>\n     <div class=\"text-danger\" *ngIf=\"getFormControl().hasError('required') && getFormControl().touched && field.validationMessages?.required\">{{field.validationMessages.required}}</div>\n  </div>\n  <div *ngIf=\"!field.editMode\" class=\"key-value-pair\">\n    <span class=\"key\" *ngIf=\"field.label\">{{field.label}}</span>\n    <span class=\"value\">{{getLabel(field.value)}}</span>\n  </div>\n  ",
        })
    ], DropdownFieldComponent);
    return DropdownFieldComponent;
}(SelectionComponent));

var SelectionFieldComponent = /** @class */ (function (_super) {
    __extends(SelectionFieldComponent, _super);
    function SelectionFieldComponent() {
        return _super !== null && _super.apply(this, arguments) || this;
    }
    SelectionFieldComponent.prototype.isValArray = function () {
        return __WEBPACK_IMPORTED_MODULE_3_lodash_es__["isArray"](this.field.value);
    };
    SelectionFieldComponent.prototype.isRadio = function () {
        return this.field.controlType == 'radio';
    };
    SelectionFieldComponent.prototype.getControlFromOption = function (opt) {
        var control = __WEBPACK_IMPORTED_MODULE_3_lodash_es__["find"](this.getFormControl()['controls'], function (ctrl) {
            return opt.value == ctrl.value;
        });
        return control;
    };
    SelectionFieldComponent.prototype.onChange = function (opt, event) {
        var formcontrol = this.getFormControl();
        if (event.target.checked) {
            formcontrol.push(new __WEBPACK_IMPORTED_MODULE_2__angular_forms__["b" /* FormControl */](opt.value));
        }
        else {
            var idx_1 = null;
            __WEBPACK_IMPORTED_MODULE_3_lodash_es__["forEach"](formcontrol.controls, function (ctrl, i) {
                if (ctrl.value == opt.value) {
                    idx_1 = i;
                    return false;
                }
            });
            formcontrol.removeAt(idx_1);
        }
    };
    SelectionFieldComponent.clName = 'SelectionFieldComponent';
    SelectionFieldComponent = __decorate([
        Object(__WEBPACK_IMPORTED_MODULE_0__angular_core__["Component"])({
            selector: 'selectionfield',
            template: "\n  <div [formGroup]='form' *ngIf=\"field.editMode && field.visible\" class=\"form-group\">\n     <label [attr.for]=\"field.name\">\n      {{field.label}} {{ getRequiredLabelStr()}}\n      <button type=\"button\" class=\"btn btn-default\" *ngIf=\"field.help\" (click)=\"toggleHelp()\"><span class=\"glyphicon glyphicon-question-sign\" aria-hidden=\"true\"></span></button>\n     </label><br/>\n     <span id=\"{{ 'helpBlock_' + field.name }}\" class=\"help-block\" *ngIf=\"this.helpShow\" [innerHtml]=\"field.help\"></span>\n     <span *ngFor=\"let opt of field.options\">\n      <!-- radio type hard-coded otherwise accessor directive will not work! -->\n      <input *ngIf=\"isRadio()\" type=\"radio\" name=\"{{field.name}}\" [id]=\"field.name + '_' + opt.value\" [formControl]=\"getFormControl()\" [value]=\"opt.value\" [attr.disabled]=\"field.readOnly ? '' : null \">\n      <input *ngIf=\"!isRadio()\" type=\"{{field.controlType}}\" name=\"{{field.name}}\" [id]=\"field.name + '_' + opt.value\" [value]=\"opt.value\" (change)=\"onChange(opt, $event)\" [attr.selected]=\"getControlFromOption(opt)\" [attr.checked]=\"getControlFromOption(opt)\" [attr.disabled]=\"field.readOnly ? '' : null \">\n      <label for=\"{{field.name + '_' + opt.value}}\" class=\"radio-label\">{{ opt.label }}</label>\n      <br/>\n     </span>\n     <div class=\"text-danger\" *ngIf=\"getFormControl().hasError('required') && getFormControl().touched && !field.validationMessages?.required\">{{field.label}} is required</div>\n     <div class=\"text-danger\" *ngIf=\"getFormControl().hasError('required') && getFormControl().touched && field.validationMessages?.required\">{{field.validationMessages.required}}</div>\n  </div>\n  <div *ngIf=\"!field.editMode\" class=\"key-value-pair\">\n    <ng-container *ngIf=\"isRadio()\">\n      <span *ngIf=\"field.label\" class=\"key\">{{field.label}}</span>\n      <span class=\"value\">{{getLabel(field.value)}}</span>\n    </ng-container>\n    <ng-container *ngIf=\"!isRadio()\">\n      <span *ngIf=\"field.label\" class=\"key\">{{field.label}}</span>\n      <span class=\"value\" *ngIf=\"!isValArray()\">{{getLabel(field.value)}}</span>\n      <ng-container *ngIf=\"isValArray()\">\n        <div class=\"value\" *ngFor=\"let val of field.value\">\n          {{getLabel(val)}}\n        </div>\n      </ng-container>\n    </ng-container>\n    <div>&nbsp;</div>\n  </div>\n  ",
        })
    ], SelectionFieldComponent);
    return SelectionFieldComponent;
}(SelectionComponent));

/****************************************************************************
Container components
*****************************************************************************/
var TabOrAccordionContainerComponent = /** @class */ (function (_super) {
    __extends(TabOrAccordionContainerComponent, _super);
    function TabOrAccordionContainerComponent() {
        return _super !== null && _super.apply(this, arguments) || this;
    }
    TabOrAccordionContainerComponent.prototype.ngAfterViewChecked = function () {
        var that = this;
        jQuery("[role='tab']").on('shown.bs.tab', function () {
            that.field.onTabChange.emit(this.getAttribute("href").substring(1, this.getAttribute("href").length));
        });
    };
    TabOrAccordionContainerComponent = __decorate([
        Object(__WEBPACK_IMPORTED_MODULE_0__angular_core__["Component"])({
            selector: 'tabcontainer',
            template: "\n  <div *ngIf=\"field.editMode\" class=\"row\" style=\"min-height:300px;\">\n    <div [ngClass]=\"field.cssClasses\">\n      <div [ngClass]=\"field.tabNavContainerClass\">\n        <ul [ngClass]=\"field.tabNavClass\">\n          <li *ngFor=\"let tab of field.fields\" [ngClass]=\"{'active': tab.active}\"><a href=\"#{{tab.id}}\" data-toggle=\"tab\" role=\"tab\">{{tab.label}}</a></li>\n        </ul>\n      </div>\n      <div [ngClass]=\"field.tabContentContainerClass\">\n        <div [ngClass]=\"field.tabContentClass\">\n      <!--\n      Inlined the tab definition instead of creating it's own component otherwise Bootstrap refuses to toggle the panes\n      Likely because of the extra DOM node (component selector) that it doesn't know what to do.\n      TODO: remove inlining, or perhaps consider a 3rd-party NG2 tab component\n      -->\n          <div *ngFor=\"let tab of field.fields\" [ngClass]=\"{'tab-pane': true, 'fade': true, 'active': tab.active==true, 'in': tab.active==true}\" id=\"{{tab.id}}\">\n            <dmp-field *ngFor=\"let field of tab.fields\" [field]=\"field\" [form]=\"form\" class=\"form-row\" [fieldMap]=\"fieldMap\" [parentId]=\"tab.id\"></dmp-field>\n          </div>\n        </div>\n      </div>\n    </div>\n  </div>\n  <div *ngIf=\"!field.editMode\" [ngClass]=\"field.accContainerClass\">\n    <div class=\"panel-group\">\n      <div *ngFor=\"let tab of field.fields\" [ngClass]=\"field.accClass\">\n        <div class=\"panel-heading\">\n          <h4 class=\"panel-title\">\n            <a data-toggle=\"collapse\" href=\"#{{tab.id}}\">{{tab.label}}</a>\n          </h4>\n        </div>\n        <div id=\"{{tab.id}}\" class=\"panel-collapse collapse\">\n          <div class=\"panel-body\">\n            <ul class=\"key-value-list\">\n              <dmp-field *ngFor=\"let field of tab.fields\" [field]=\"field\" [form]=\"form\" class=\"form-row\" [fieldMap]=\"fieldMap\"></dmp-field>\n            </ul>\n          </div>\n        </div>\n      </div>\n    </div>\n  </div>\n  "
        })
    ], TabOrAccordionContainerComponent);
    return TabOrAccordionContainerComponent;
}(SimpleComponent));

var ButtonBarContainerComponent = /** @class */ (function (_super) {
    __extends(ButtonBarContainerComponent, _super);
    function ButtonBarContainerComponent() {
        return _super !== null && _super.apply(this, arguments) || this;
    }
    ButtonBarContainerComponent = __decorate([
        Object(__WEBPACK_IMPORTED_MODULE_0__angular_core__["Component"])({
            selector: 'buttonbarcontainer',
            template: "\n    <div *ngIf=\"field.editMode\" class=\"form-row\">\n      <div class=\"pull-right col-md-10\">\n      <dmp-field *ngFor=\"let field1 of field.fields\" [field]=\"field1\" [form]=\"form\" class=\"form-row\" [fieldMap]=\"fieldMap\"></dmp-field>\n    </div>\n  "
        })
    ], ButtonBarContainerComponent);
    return ButtonBarContainerComponent;
}(SimpleComponent));

// Break in case of an emergency....
var HtmlRawComponent = /** @class */ (function (_super) {
    __extends(HtmlRawComponent, _super);
    function HtmlRawComponent() {
        return _super !== null && _super.apply(this, arguments) || this;
    }
    HtmlRawComponent = __decorate([
        Object(__WEBPACK_IMPORTED_MODULE_0__angular_core__["Component"])({
            selector: 'htmlraw',
            template: "\n  <span *ngIf=\"field.visible\" [innerHtml]=\"field.value\"></span>\n  ",
        })
    ], HtmlRawComponent);
    return HtmlRawComponent;
}(SimpleComponent));

// For creating text blocks with help sections?
var TextBlockComponent = /** @class */ (function (_super) {
    __extends(TextBlockComponent, _super);
    function TextBlockComponent() {
        return _super !== null && _super.apply(this, arguments) || this;
    }
    TextBlockComponent.clName = 'TextBlockComponent';
    TextBlockComponent = __decorate([
        Object(__WEBPACK_IMPORTED_MODULE_0__angular_core__["Component"])({
            selector: 'text-block',
            template: "\n  <div *ngIf=\"field.visible\" [ngSwitch]=\"field.type\">\n    <h1 *ngSwitchCase=\"'h1'\" [ngClass]=\"field.cssClasses\">{{field.value}}</h1>\n    <h2 *ngSwitchCase=\"'h2'\" [ngClass]=\"field.cssClasses\">{{field.value}}</h2>\n    <h3 *ngSwitchCase=\"'h3'\" [ngClass]=\"field.cssClasses\">{{field.value}}</h3>\n    <h4 *ngSwitchCase=\"'h4'\" [ngClass]=\"field.cssClasses\">{{field.value}}</h4>\n    <h5 *ngSwitchCase=\"'h5'\" [ngClass]=\"field.cssClasses\">{{field.value}}</h5>\n    <hr *ngSwitchCase=\"'hr'\" [ngClass]=\"field.cssClasses\">\n    <span *ngSwitchCase=\"'span'\" [ngClass]=\"field.cssClasses\">{{field.value}}</span>\n    <p *ngSwitchDefault [ngClass]=\"field.cssClasses\">{{field.value}}</p>\n  </div>\n  ",
        })
    ], TextBlockComponent);
    return TextBlockComponent;
}(SimpleComponent));

/**
* #### Save Button Component.
*
* Calls the form framework's save function to create or update the record.
*
* #### Usage
* ```
*     {
*          class: "SaveButton",
*          definition: {
*            label: 'Save & Close',
*            closeOnSave: true,
*            redirectLocation: '/@branding/@portal/dashboard'
*          }
*        }
* ```
*
*| Property Name       | Description                                                    | Required | Default |
*|---------------------|----------------------------------------------------------------|----------|---------|
*| label               | The text to display on the button                              | Yes      |         |
*| closeOnSave         | Flag to leave the page on successful save                      | No       | false   |
*| redirectLocation    | The location to redirect to if closeOnSave flag is set to true | No       |         |
*/
var SaveButtonComponent = /** @class */ (function (_super) {
    __extends(SaveButtonComponent, _super);
    function SaveButtonComponent() {
        return _super !== null && _super.apply(this, arguments) || this;
    }
    SaveButtonComponent.prototype.onClick = function (event) {
        if (this.field.confirmationMessage) {
            this.showConfirmDlg();
            return;
        }
        this.doAction();
    };
    SaveButtonComponent.prototype.showConfirmDlg = function () {
        jQuery("#" + this.field.name + "_confirmation").modal('show');
    };
    SaveButtonComponent.prototype.hideConfirmDlg = function () {
        jQuery("#" + this.field.name + "_confirmation").modal('hide');
    };
    SaveButtonComponent.prototype.doAction = function () {
        var _this = this;
        var successObs = null;
        if (this.field.isDelete) {
            successObs = this.fieldMap._rootComp.delete();
        }
        else {
            successObs = this.field.targetStep ?
                this.fieldMap._rootComp.onSubmit(true, this.field.targetStep, false, this.field.additionalData)
                : this.fieldMap._rootComp.onSubmit(false, null, false, this.field.additionalData);
        }
        successObs.subscribe(function (status) {
            if (status) {
                if (_this.field.closeOnSave == true) {
                    window.location.href = _this.field.redirectLocation;
                }
            }
            if (_this.field.confirmationMessage) {
                _this.hideConfirmDlg();
            }
        });
    };
    SaveButtonComponent = __decorate([
        Object(__WEBPACK_IMPORTED_MODULE_0__angular_core__["Component"])({
            selector: 'save-button',
            template: "\n    <button type=\"button\" (click)=\"onClick($event)\" class=\"btn\" [ngClass]=\"field.cssClasses\" [disabled]=\"!fieldMap._rootComp.needsSave || fieldMap._rootComp.isSaving()\">{{field.label}}</button>\n    <div *ngIf=\"field.confirmationMessage\" class=\"modal fade\" id=\"{{ field.name }}_confirmation\" tabindex=\"-1\" role=\"dialog\" >\n      <div class=\"modal-dialog\" role=\"document\">\n        <div class=\"modal-content\">\n          <div class=\"modal-header\">\n            <button type=\"button\" class=\"close\" data-dismiss=\"modal\" aria-label=\"Close\"><span aria-hidden=\"true\">&times;</span></button>\n            <h4 class=\"modal-title\" id=\"{{ field.name }}_confirmation_label\" [innerHtml]=\"field.confirmationTitle\"></h4>\n          </div>\n          <div class=\"modal-body\" [innerHtml]=\"field.confirmationMessage\"></div>\n          <div class=\"modal-footer\">\n            <button (click)=\"hideConfirmDlg()\" type=\"button\" class=\"btn btn-default\" data-dismiss=\"modal\" [innerHtml]=\"field.cancelButtonMessage\"></button>\n            <button (click)=\"doAction()\" type=\"button\" class=\"btn btn-primary\" [innerHtml]=\"field.confirmButtonMessage\"></button>\n          </div>\n        </div>\n      </div>\n    </div>\n  ",
        })
    ], SaveButtonComponent);
    return SaveButtonComponent;
}(SimpleComponent));

/**
* # Cancel Button Component
*
* #### Button designed to
*  @param  {CancelButton} cancelButton
*   @return {FormControl}
*/
var CancelButtonComponent = /** @class */ (function (_super) {
    __extends(CancelButtonComponent, _super);
    function CancelButtonComponent() {
        return _super !== null && _super.apply(this, arguments) || this;
    }
    CancelButtonComponent = __decorate([
        Object(__WEBPACK_IMPORTED_MODULE_0__angular_core__["Component"])({
            selector: 'cancel-button',
            template: "\n    <button type=\"button\" class=\"btn btn-warning\" [disabled]=\"fieldMap._rootComp.isSaving()\" (click)=\"fieldMap._rootComp.onCancel()\">{{field.label}}</button>\n  ",
        })
    ], CancelButtonComponent);
    return CancelButtonComponent;
}(SimpleComponent));

var AnchorOrButtonComponent = /** @class */ (function (_super) {
    __extends(AnchorOrButtonComponent, _super);
    function AnchorOrButtonComponent() {
        return _super !== null && _super.apply(this, arguments) || this;
    }
    AnchorOrButtonComponent.prototype.onClick = function (event) {
        this.fieldMap._rootComp[this.field.onClick_RootFn]();
    };
    AnchorOrButtonComponent.prototype.isDisabled = function () {
        if (this.field.isDisabledFn) {
            return this.fieldMap._rootComp[this.field.isDisabledFn]();
        }
        return false;
    };
    AnchorOrButtonComponent = __decorate([
        Object(__WEBPACK_IMPORTED_MODULE_0__angular_core__["Component"])({
            selector: 'anchor-button',
            template: "\n  <button *ngIf=\"field.controlType=='button'\" type=\"{{field.type}}\" [ngClass]=\"field.cssClasses\" (click)=\"onClick($event)\" [disabled]=\"isDisabled()\">{{field.label}}</button>\n  <a *ngIf=\"field.controlType=='anchor'\" href='{{field.value}}' [ngClass]=\"field.cssClasses\" ><span *ngIf=\"field.showPencil\" class=\"glyphicon glyphicon-pencil\">&nbsp;</span>{{field.label}}</a>\n  <a *ngIf=\"field.controlType=='htmlAnchor'\" href='{{field.value}}' [ngClass]=\"field.cssClasses\" [innerHtml]=\"field.anchorHtml\"></a>\n  ",
        })
    ], AnchorOrButtonComponent);
    return AnchorOrButtonComponent;
}(SimpleComponent));

var TabNavButtonComponent = /** @class */ (function (_super) {
    __extends(TabNavButtonComponent, _super);
    function TabNavButtonComponent(changeRef) {
        var _this = _super.call(this) || this;
        _this.changeRef = changeRef;
        return _this;
    }
    TabNavButtonComponent.prototype.ngOnInit = function () {
        var _this = this;
        this.field.getTabs();
        jQuery('a[data-toggle="tab"]').on('shown.bs.tab', function (e) {
            var tabId = e.target.href.split('#')[1];
            _this.field.currentTab = tabId;
            _this.changeRef.detectChanges();
        });
    };
    TabNavButtonComponent.prototype.stepToTab = function (step) {
        var tabId = this.field.getTabId(step);
        if (tabId) {
            this.fieldMap._rootComp.gotoTab(tabId);
        }
        else {
            console.log("Invalid tab: " + tabId);
        }
    };
    TabNavButtonComponent = __decorate([
        Object(__WEBPACK_IMPORTED_MODULE_0__angular_core__["Component"])({
            selector: 'tab-nav-button',
            template: "\n    <button type='button'[ngClass]='field.cssClasses' [disabled]=\"!field.getTabId(-1)\" (click)=\"stepToTab(-1)\" >{{field.prevLabel}}</button>\n    <button type='button'[ngClass]='field.cssClasses' [disabled]=\"!field.getTabId(1)\" (click)=\"stepToTab(1)\" >{{field.nextLabel}}</button>\n  ",
        }),
        __metadata("design:paramtypes", [__WEBPACK_IMPORTED_MODULE_0__angular_core__["ChangeDetectorRef"]])
    ], TabNavButtonComponent);
    return TabNavButtonComponent;
}(SimpleComponent));

var LinkValueComponent = /** @class */ (function (_super) {
    __extends(LinkValueComponent, _super);
    function LinkValueComponent() {
        return _super !== null && _super.apply(this, arguments) || this;
    }
    LinkValueComponent.prototype.isVisible = function () {
        return !__WEBPACK_IMPORTED_MODULE_3_lodash_es__["isEmpty"](this.field.value);
    };
    LinkValueComponent = __decorate([
        Object(__WEBPACK_IMPORTED_MODULE_0__angular_core__["Component"])({
            selector: 'link-value',
            template: "\n  <li *ngIf=\"!field.editMode && isVisible()\" class=\"key-value-pair padding-bottom-10\">\n    <span class=\"key\" *ngIf=\"field.label\">{{field.label}}</span>\n    <span class=\"value\"><a href='{{field.value}}' target=\"field.target\">{{field.value}}</a></span>\n  </li>\n  ",
        })
    ], LinkValueComponent);
    return LinkValueComponent;
}(SimpleComponent));

var HiddenValueComponent = /** @class */ (function (_super) {
    __extends(HiddenValueComponent, _super);
    function HiddenValueComponent() {
        return _super !== null && _super.apply(this, arguments) || this;
    }
    HiddenValueComponent.prototype.handleChange = function (value, source) {
        var _this = this;
        console.log("Hidden Value change: " + source);
        console.log(value);
        var targetVal = null;
        if (__WEBPACK_IMPORTED_MODULE_3_lodash_es__["isArray"](value)) {
            targetVal = [];
            __WEBPACK_IMPORTED_MODULE_3_lodash_es__["forEach"](value, function (v) {
                var tVal = '';
                __WEBPACK_IMPORTED_MODULE_3_lodash_es__["forEach"](_this.field.onChange.control.subFields, function (subField) {
                    tVal = "" + (__WEBPACK_IMPORTED_MODULE_3_lodash_es__["isEmpty"](tVal) ? tVal : "" + tVal + _this.field.onChange.control.delim) + v[subField];
                });
                targetVal.push(tVal);
            });
        }
        this.getFormControl().setValue(targetVal, this.field.onChange.updateConf);
        console.log("Form now has value:");
        console.log(this.form.value);
    };
    HiddenValueComponent = __decorate([
        Object(__WEBPACK_IMPORTED_MODULE_0__angular_core__["Component"])({
            selector: 'hidden-field',
            template: "\n  <div [formGroup]='form'>\n    <input type=\"hidden\" name=\"{{field.name}}\" [formControl]=\"getFormControl()\" />\n  </div>\n  ",
        })
    ], HiddenValueComponent);
    return HiddenValueComponent;
}(SimpleComponent));

/**
Wrapped: https://github.com/nkalinov/ng2-datetime
Based on: https://bootstrap-datepicker.readthedocs.io/en/stable/
*/
var DateTimeComponent = /** @class */ (function (_super) {
    __extends(DateTimeComponent, _super);
    function DateTimeComponent() {
        return _super !== null && _super.apply(this, arguments) || this;
    }
    /**
     * Component method that formats the value, delegates to field.
     */
    DateTimeComponent.prototype.formatValue = function () {
        return this.field.formatValue(this.getFormControl().value);
    };
    DateTimeComponent = __decorate([
        Object(__WEBPACK_IMPORTED_MODULE_0__angular_core__["Component"])({
            selector: 'date-time',
            template: "\n  <div *ngIf=\"field.editMode\" [formGroup]='form' class=\"form-group\">\n    <label [attr.for]=\"field.name\">\n      {{field.label}} {{ getRequiredLabelStr()}}\n      <button type=\"button\" class=\"btn btn-default\" *ngIf=\"field.help\" (click)=\"toggleHelp()\"><span class=\"glyphicon glyphicon-question-sign\" aria-hidden=\"true\"></span></button>\n    </label><br/>\n    <span id=\"{{ 'helpBlock_' + field.name }}\" class=\"help-block\" *ngIf=\"this.helpShow\" [innerHtml]=\"field.help\"></span>\n    <datetime #dateTime [formControl]=\"getFormControl()\" [timepicker]=\"field.timePickerOpts\" [datepicker]=\"field.datePickerOpts\" [hasClearButton]=\"field.hasClearButton\"></datetime>\n  </div>\n  <li *ngIf=\"!field.editMode\" class=\"key-value-pair\">\n    <span class=\"key\" *ngIf=\"field.label\">{{field.label}}</span>\n    <span class=\"value\">{{field.formatValueForDisplay()}}</span>\n  </li>\n  "
        })
    ], DateTimeComponent);
    return DateTimeComponent;
}(SimpleComponent));

var ParameterRetrieverComponent = /** @class */ (function (_super) {
    __extends(ParameterRetrieverComponent, _super);
    function ParameterRetrieverComponent() {
        return _super !== null && _super.apply(this, arguments) || this;
    }
    ParameterRetrieverComponent.prototype.ngAfterViewInit = function () {
        var paramValue = this.getUrlParameter(this.field.parameterName);
        if (paramValue) {
            this.field.publishParameterValue(paramValue);
        }
    };
    ParameterRetrieverComponent.prototype.getUrlParameter = function (param) {
        var pageURL = decodeURIComponent(window.location.search.substring(1)), urlVariables = pageURL.split('&'), parameterName, i;
        for (i = 0; i < urlVariables.length; i++) {
            parameterName = urlVariables[i].split('=');
            if (parameterName[0] === param) {
                return parameterName[1] === undefined ? true : parameterName[1];
            }
        }
    };
    ParameterRetrieverComponent = __decorate([
        Object(__WEBPACK_IMPORTED_MODULE_0__angular_core__["Component"])({
            selector: 'parameter-retriever',
            template: "\n  <div>\n\n  </div>\n  ",
        })
    ], ParameterRetrieverComponent);
    return ParameterRetrieverComponent;
}(SimpleComponent));

var SpacerComponent = /** @class */ (function (_super) {
    __extends(SpacerComponent, _super);
    function SpacerComponent() {
        return _super !== null && _super.apply(this, arguments) || this;
    }
    SpacerComponent = __decorate([
        Object(__WEBPACK_IMPORTED_MODULE_0__angular_core__["Component"])({
            selector: 'spacer',
            template: "\n  <span [style.display]=\"'inline-block'\" [style.width]=\"field.width\" [style.height]=\"field.height\">&nbsp;</span>\n  ",
        })
    ], SpacerComponent);
    return SpacerComponent;
}(SimpleComponent));

var ToggleComponent = /** @class */ (function (_super) {
    __extends(ToggleComponent, _super);
    function ToggleComponent() {
        return _super !== null && _super.apply(this, arguments) || this;
    }
    ToggleComponent = __decorate([
        Object(__WEBPACK_IMPORTED_MODULE_0__angular_core__["Component"])({
            selector: 'toggle',
            template: "\n    <div *ngIf=\"field.type == 'checkbox'\" [formGroup]='form'>\n      <input type=\"checkbox\" name=\"{{field.name}}\" [id]=\"field.name\" [formControl]=\"getFormControl()\" >\n      <label for=\"{{ field.name }}\" class=\"radio-label\">{{ field.label }}</label>\n    </div>\n  "
        })
    ], ToggleComponent);
    return ToggleComponent;
}(SimpleComponent));



/***/ }),

/***/ "./redbox-portal/angular/shared/form/field-simple.ts":
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "i", function() { return NotInFormField; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "l", function() { return SelectionField; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "d", function() { return Container; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "o", function() { return TabOrAccordionContainer; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "b", function() { return ButtonBarContainer; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "e", function() { return DateTime; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "k", function() { return SaveButton; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "c", function() { return CancelButton; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "n", function() { return TabNavButton; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "a", function() { return AnchorOrButton; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "f", function() { return HiddenValue; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "h", function() { return LinkValue; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "j", function() { return ParameterRetrieverField; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "m", function() { return Spacer; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "p", function() { return Toggle; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "g", function() { return HtmlRaw; });
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__angular_core__ = __webpack_require__("./node_modules/@angular/core/esm5/core.js");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1__field_base__ = __webpack_require__("./redbox-portal/angular/shared/form/field-base.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2__angular_forms__ = __webpack_require__("./node_modules/@angular/forms/esm5/forms.js");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_lodash_es__ = __webpack_require__("./node_modules/lodash-es/lodash.js");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_moment_es6__ = __webpack_require__("./node_modules/moment-es6/index.js");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_moment_es6___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_4_moment_es6__);
var __extends = (this && this.__extends) || (function () {
    var extendStatics = Object.setPrototypeOf ||
        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||
        function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };
    return function (d, b) {
        extendStatics(d, b);
        function __() { this.constructor = d; }
        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
    };
})();
var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {
    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
    if (typeof Reflect === "object" && typeof Reflect.decorate === "function") r = Reflect.decorate(decorators, target, key, desc);
    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;
    return c > 3 && r && Object.defineProperty(target, key, r), r;
};
var __metadata = (this && this.__metadata) || function (k, v) {
    if (typeof Reflect === "object" && typeof Reflect.metadata === "function") return Reflect.metadata(k, v);
};
// Copyright (c) 2017 Queensland Cyber Infrastructure Foundation (http://www.qcif.edu.au/)
//
// GNU GENERAL PUBLIC LICENSE
//    Version 2, June 1991
//
// This program is free software; you can redistribute it and/or modify
// it under the terms of the GNU General Public License as published by
// the Free Software Foundation; either version 2 of the License, or
// (at your option) any later version.
//
// This program is distributed in the hope that it will be useful,
// but WITHOUT ANY WARRANTY; without even the implied warranty of
// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
// GNU General Public License for more details.
//
// You should have received a copy of the GNU General Public License along
// with this program; if not, write to the Free Software Foundation, Inc.,
// 51 Franklin Street, Fifth Floor, Boston, MA 02110-1301 USA.





var NotInFormField = /** @class */ (function (_super) {
    __extends(NotInFormField, _super);
    function NotInFormField(options, injector) {
        return _super.call(this, options, injector) || this;
    }
    NotInFormField.prototype.createFormModel = function (valueElem) {
        if (valueElem === void 0) { valueElem = null; }
    };
    NotInFormField.prototype.getGroup = function (group, fieldMap) {
        this.fieldMap = fieldMap;
        __WEBPACK_IMPORTED_MODULE_3_lodash_es__["set"](fieldMap, this.getFullFieldName() + ".field", this);
    };
    NotInFormField.prototype.reactEvent = function (eventName, eventData, origData) {
    };
    return NotInFormField;
}(__WEBPACK_IMPORTED_MODULE_1__field_base__["a" /* FieldBase */]));

var SelectionField = /** @class */ (function (_super) {
    __extends(SelectionField, _super);
    function SelectionField(options, injector) {
        var _this = _super.call(this, options, injector) || this;
        _this.options = [];
        // this.options = options['options'] || [];
        _this.options = __WEBPACK_IMPORTED_MODULE_3_lodash_es__["map"](options['options'] || [], function (option) {
            option['label'] = _this.getTranslated(option['label'], option['label']);
            option['value'] = _this.getTranslated(option['value'], option['value']);
            return option;
        });
        return _this;
    }
    SelectionField.prototype.createFormModel = function () {
        var _this = this;
        if (this.controlType == 'checkbox') {
            var fgDef_1 = [];
            __WEBPACK_IMPORTED_MODULE_3_lodash_es__["map"](this.options, function (opt) {
                var hasValue = __WEBPACK_IMPORTED_MODULE_3_lodash_es__["find"](_this.value, function (val) {
                    return val == opt.value;
                });
                if (hasValue) {
                    fgDef_1.push(new __WEBPACK_IMPORTED_MODULE_2__angular_forms__["b" /* FormControl */](opt.value));
                }
            });
            // const fg = new FormArray(fgDef);
            // return fg;
            return new __WEBPACK_IMPORTED_MODULE_2__angular_forms__["a" /* FormArray */](fgDef_1);
        }
        else {
            // const model = super.createFormModel();
            // console.log(`Created form model:`);
            // console.log(model);
            // return model;
            return _super.prototype.createFormModel.call(this);
        }
    };
    SelectionField.prototype.nextOption = function () {
        var _this = this;
        if (this.controlType == 'radio') {
            var nextIdx_1 = 0;
            var opt = __WEBPACK_IMPORTED_MODULE_3_lodash_es__["find"](this.options, function (opt, idx) {
                var match = opt.value == _this.value;
                if (match) {
                    nextIdx_1 = ++idx;
                }
                return match;
            });
            if (nextIdx_1 >= this.options.length) {
                nextIdx_1 = 0;
            }
            var value = this.options[nextIdx_1].value;
            this.setValue(value);
        }
        return this.value;
    };
    return SelectionField;
}(__WEBPACK_IMPORTED_MODULE_1__field_base__["a" /* FieldBase */]));

var Container = /** @class */ (function (_super) {
    __extends(Container, _super);
    function Container(options, injector) {
        var _this = _super.call(this, options, injector) || this;
        _this.controlType = 'div';
        _this.content = options['content'] || '';
        _this.active = options['active'] || false;
        _this.type = options['type'] || '';
        _this.isGroup = true;
        _this.hasControl = __WEBPACK_IMPORTED_MODULE_3_lodash_es__["isUndefined"](_this.groupName);
        return _this;
    }
    Container.prototype.getGroup = function (group, fieldMap) {
        this.fieldMap = fieldMap;
        __WEBPACK_IMPORTED_MODULE_3_lodash_es__["set"](fieldMap, this.getFullFieldName() + ".field", this);
        group[this.name] = this.required ? new __WEBPACK_IMPORTED_MODULE_2__angular_forms__["c" /* FormGroup */]({}, __WEBPACK_IMPORTED_MODULE_2__angular_forms__["i" /* Validators */].required) : new __WEBPACK_IMPORTED_MODULE_2__angular_forms__["c" /* FormGroup */]({});
        __WEBPACK_IMPORTED_MODULE_3_lodash_es__["each"](this.fields, function (field) {
            field.getGroup(group, fieldMap);
        });
        return group[this.name];
    };
    Container.prototype.createFormModel = function (valueElem) {
        var _this = this;
        if (valueElem === void 0) { valueElem = null; }
        var grp = {};
        __WEBPACK_IMPORTED_MODULE_3_lodash_es__["each"](this.fields, function (field) {
            var fldVal = null;
            if (_this.value) {
                fldVal = __WEBPACK_IMPORTED_MODULE_3_lodash_es__["get"](_this.value, field.name);
            }
            field.value = fldVal;
            grp[field.name] = field.createFormModel(fldVal);
        });
        this.formModel = this.required ? new __WEBPACK_IMPORTED_MODULE_2__angular_forms__["c" /* FormGroup */](grp, __WEBPACK_IMPORTED_MODULE_2__angular_forms__["i" /* Validators */].required) : new __WEBPACK_IMPORTED_MODULE_2__angular_forms__["c" /* FormGroup */](grp);
        return this.formModel;
    };
    Container.prototype.setValue = function (value, emitEvent) {
        var _this = this;
        if (emitEvent === void 0) { emitEvent = true; }
        this.value = value;
        __WEBPACK_IMPORTED_MODULE_3_lodash_es__["forOwn"](value, function (val, key) {
            var fld = __WEBPACK_IMPORTED_MODULE_3_lodash_es__["find"](_this.fields, function (fldItem) {
                return fldItem.name == key;
            });
            fld.setValue(val, emitEvent);
        });
        // this.formModel.setValue(value, { onlySelf: true, emitEvent: emitEvent });
    };
    return Container;
}(__WEBPACK_IMPORTED_MODULE_1__field_base__["a" /* FieldBase */]));

var TabOrAccordionContainer = /** @class */ (function (_super) {
    __extends(TabOrAccordionContainer, _super);
    function TabOrAccordionContainer(options, injector) {
        var _this = _super.call(this, options, injector) || this;
        _this.onTabChange = new __WEBPACK_IMPORTED_MODULE_0__angular_core__["EventEmitter"]();
        // defaults to nav-pills, nav-stacked, nav size col-md-2, tab content col-md-10
        _this.tabNavContainerClass = options['tabNavContainerClass'] || 'col-md-2';
        _this.tabNavClass = options['tabNavClass'] || 'nav nav-pills nav-stacked';
        _this.tabContentContainerClass = options['tabContentContainerClass'] || 'col-md-10';
        _this.tabContentClass = options['tabContentClass'] || 'tab-content';
        _this.accContainerClass = options['accContainerClass'] || 'col-md-12';
        _this.accClass = options['accClass'] || 'panel panel-default';
        return _this;
    }
    __decorate([
        Object(__WEBPACK_IMPORTED_MODULE_0__angular_core__["Output"])(),
        __metadata("design:type", __WEBPACK_IMPORTED_MODULE_0__angular_core__["EventEmitter"])
    ], TabOrAccordionContainer.prototype, "onTabChange", void 0);
    return TabOrAccordionContainer;
}(Container));

var ButtonBarContainer = /** @class */ (function (_super) {
    __extends(ButtonBarContainer, _super);
    function ButtonBarContainer(options, injector) {
        return _super.call(this, options, injector) || this;
    }
    return ButtonBarContainer;
}(Container));

var DateTime = /** @class */ (function (_super) {
    __extends(DateTime, _super);
    function DateTime(options, injector) {
        var _this = _super.call(this, options, injector) || this;
        _this.datePickerOpts = options['datePickerOpts'] || false;
        _this.timePickerOpts = options['timePickerOpts'] || false;
        _this.hasClearButton = options['hasClearButton'] || false;
        _this.valueFormat = options['valueFormat'] || 'YYYY-MM-DD';
        _this.displayFormat = options['displayFormat'] || 'YYYY-MM-DD';
        _this.controlType = 'datetime';
        _this.value = _this.value ? _this.parseToDate(_this.value) : _this.value;
        return _this;
    }
    DateTime.prototype.formatValue = function (value) {
        // assume local date
        console.log("Formatting value: " + value);
        return value ? __WEBPACK_IMPORTED_MODULE_4_moment_es6___default()(value).local().format(this.valueFormat) : value;
    };
    DateTime.prototype.parseToDate = function (value) {
        return __WEBPACK_IMPORTED_MODULE_4_moment_es6___default()(value, this.valueFormat).local().toDate();
    };
    DateTime.prototype.formatValueForDisplay = function () {
        var locale = window.navigator.language; // commented out, no support for below IE 11: window.navigator.userLanguage || window.navigator.language;
        return this.value ? __WEBPACK_IMPORTED_MODULE_4_moment_es6___default()(this.value).locale(locale).format(this.displayFormat) : '';
    };
    DateTime.prototype.reactEvent = function (eventName, eventData, origData) {
        var thisDate = __WEBPACK_IMPORTED_MODULE_4_moment_es6___default()(eventData);
        var prevStartDate = __WEBPACK_IMPORTED_MODULE_4_moment_es6___default()(this.formModel.value);
        if (!prevStartDate.isValid() || thisDate.isAfter(prevStartDate)) {
            this.formModel.setValue(eventData);
        }
        var newOpts = __WEBPACK_IMPORTED_MODULE_3_lodash_es__["cloneDeep"](this.datePickerOpts);
        newOpts.startDate = eventData;
        this.datePickerOpts = newOpts;
    };
    return DateTime;
}(__WEBPACK_IMPORTED_MODULE_1__field_base__["a" /* FieldBase */]));

var SaveButton = /** @class */ (function (_super) {
    __extends(SaveButton, _super);
    function SaveButton(options, injector) {
        var _this = _super.call(this, options, injector) || this;
        _this.label = _this.getTranslated(options['label'], 'Save');
        _this.closeOnSave = options['closeOnSave'] || false;
        _this.redirectLocation = options['redirectLocation'] || false;
        _this.cssClasses = options['cssClasses'] || "btn-primary";
        _this.targetStep = options['targetStep'] || null;
        _this.additionalData = options['additionalData'] || null;
        _this.confirmationMessage = options['confirmationMessage'] ? _this.getTranslated(options['confirmationMessage'], null) : null;
        _this.confirmationTitle = options['confirmationTitle'] ? _this.getTranslated(options['confirmationTitle'], null) : null;
        _this.cancelButtonMessage = options['cancelButtonMessage'] ? _this.getTranslated(options['cancelButtonMessage'], null) : null;
        _this.confirmButtonMessage = options['confirmButtonMessage'] ? _this.getTranslated(options['confirmButtonMessage'], null) : null;
        _this.isDelete = options['isDelete'];
        return _this;
    }
    return SaveButton;
}(NotInFormField));

var CancelButton = /** @class */ (function (_super) {
    __extends(CancelButton, _super);
    function CancelButton(options, injector) {
        var _this = _super.call(this, options, injector) || this;
        _this.label = _this.getTranslated(options['label'], 'Cancel');
        return _this;
    }
    return CancelButton;
}(__WEBPACK_IMPORTED_MODULE_1__field_base__["a" /* FieldBase */]));

var TabNavButton = /** @class */ (function (_super) {
    __extends(TabNavButton, _super);
    function TabNavButton(options, injector) {
        var _this = _super.call(this, options, injector) || this;
        _this.tabs = [];
        _this.prevLabel = _this.getTranslated(options.prevLabel, 'Previous');
        _this.nextLabel = _this.getTranslated(options.nextLabel, 'Next');
        _this.targetTabContainerId = options.targetTabContainerId;
        return _this;
    }
    TabNavButton.prototype.getTabs = function () {
        var _this = this;
        var targetContainerTab = this.getTargetTab(this.fieldMap._rootComp.formDef.fields);
        if (targetContainerTab) {
            __WEBPACK_IMPORTED_MODULE_3_lodash_es__["each"](targetContainerTab.definition.fields, function (tab) {
                _this.tabs.push(tab.definition.id);
            });
            this.currentTab = this.tabs[0];
        }
        else {
            console.log("Target Container Tab not found: " + this.targetTabContainerId);
        }
    };
    TabNavButton.prototype.getTargetTab = function (fields) {
        var _this = this;
        var targetTab = __WEBPACK_IMPORTED_MODULE_3_lodash_es__["find"](fields, function (f) {
            if (f.definition && f.definition.id == _this.targetTabContainerId) {
                return true;
            }
            if (f.definition && f.definition.fields) {
                return _this.getTargetTab(f.definition.fields);
            }
        });
        return targetTab;
    };
    TabNavButton.prototype.getCurrentTabIdx = function () {
        var _this = this;
        return __WEBPACK_IMPORTED_MODULE_3_lodash_es__["findIndex"](this.tabs, function (curTab) { return curTab == _this.currentTab; });
    };
    TabNavButton.prototype.getTabId = function (step) {
        var curTabIdx = this.getCurrentTabIdx();
        var tabIdx = curTabIdx + step;
        if (tabIdx >= 0 && tabIdx < this.tabs.length) {
            return this.tabs[tabIdx];
        }
        return null;
    };
    return TabNavButton;
}(__WEBPACK_IMPORTED_MODULE_1__field_base__["a" /* FieldBase */]));

var AnchorOrButton = /** @class */ (function (_super) {
    __extends(AnchorOrButton, _super);
    function AnchorOrButton(options, injector) {
        var _this = _super.call(this, options, injector) || this;
        _this.onClick_RootFn = options['onClick_RootFn'] || null;
        _this.isDisabledFn = options['isDisabledFn'] || null;
        _this.type = options['type'] || 'button';
        _this.controlType = options['controlType'] || 'button';
        _this.hasControl = false;
        _this.showPencil = options['showPencil'] || false;
        _this.anchorHtml = options['anchorHtml'] || '';
        return _this;
    }
    return AnchorOrButton;
}(__WEBPACK_IMPORTED_MODULE_1__field_base__["a" /* FieldBase */]));

var HiddenValue = /** @class */ (function (_super) {
    __extends(HiddenValue, _super);
    function HiddenValue(options, injector) {
        var _this = _super.call(this, options, injector) || this;
        _this.controlType = 'hidden';
        return _this;
    }
    return HiddenValue;
}(__WEBPACK_IMPORTED_MODULE_1__field_base__["a" /* FieldBase */]));

var LinkValue = /** @class */ (function (_super) {
    __extends(LinkValue, _super);
    function LinkValue(options, injector) {
        var _this = _super.call(this, options, injector) || this;
        _this.controlType = 'link';
        _this.target = options.target || '_blank';
        return _this;
    }
    return LinkValue;
}(__WEBPACK_IMPORTED_MODULE_1__field_base__["a" /* FieldBase */]));

var ParameterRetrieverField = /** @class */ (function (_super) {
    __extends(ParameterRetrieverField, _super);
    function ParameterRetrieverField(options, injector) {
        var _this = _super.call(this, options, injector) || this;
        _this.parameterName = options.parameterName || '';
        return _this;
    }
    ParameterRetrieverField.prototype.publishParameterValue = function (value) {
        this.onValueUpdate.emit(value);
    };
    return ParameterRetrieverField;
}(__WEBPACK_IMPORTED_MODULE_1__field_base__["a" /* FieldBase */]));

var Spacer = /** @class */ (function (_super) {
    __extends(Spacer, _super);
    function Spacer(options, injector) {
        var _this = _super.call(this, options, injector) || this;
        _this.width = options.width;
        _this.height = options.height;
        return _this;
    }
    return Spacer;
}(NotInFormField));

var Toggle = /** @class */ (function (_super) {
    __extends(Toggle, _super);
    function Toggle(options, injector) {
        var _this = _super.call(this, options, injector) || this;
        _this.type = options['type'] || 'checkbox';
        _this.value = options['value'] || false;
        return _this;
    }
    return Toggle;
}(__WEBPACK_IMPORTED_MODULE_1__field_base__["a" /* FieldBase */]));

var HtmlRaw = /** @class */ (function (_super) {
    __extends(HtmlRaw, _super);
    function HtmlRaw() {
        return _super !== null && _super.apply(this, arguments) || this;
    }
    HtmlRaw.prototype.getGroup = function (group, fieldMap) {
        _super.prototype.getGroup.call(this, group, fieldMap);
        this.value = this.replaceValWithConfig(this.value);
    };
    return HtmlRaw;
}(NotInFormField));



/***/ }),

/***/ "./redbox-portal/angular/shared/form/field-textfield.component.ts":
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "f", function() { return TextField; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "a", function() { return MarkdownTextArea; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "d", function() { return TextArea; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "g", function() { return TextFieldComponent; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "c", function() { return RepeatableTextfieldComponent; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "e", function() { return TextAreaComponent; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "b", function() { return MarkdownTextAreaComponent; });
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__angular_core__ = __webpack_require__("./node_modules/@angular/core/esm5/core.js");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_lodash_es__ = __webpack_require__("./node_modules/lodash-es/lodash.js");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2__field_base__ = __webpack_require__("./redbox-portal/angular/shared/form/field-base.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3__field_repeatable_component__ = __webpack_require__("./redbox-portal/angular/shared/form/field-repeatable.component.ts");
// Copyright (c) 2017 Queensland Cyber Infrastructure Foundation (http://www.qcif.edu.au/)
//
// GNU GENERAL PUBLIC LICENSE
//    Version 2, June 1991
//
// This program is free software; you can redistribute it and/or modify
// it under the terms of the GNU General Public License as published by
// the Free Software Foundation; either version 2 of the License, or
// (at your option) any later version.
//
// This program is distributed in the hope that it will be useful,
// but WITHOUT ANY WARRANTY; without even the implied warranty of
// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
// GNU General Public License for more details.
//
// You should have received a copy of the GNU General Public License along
// with this program; if not, write to the Free Software Foundation, Inc.,
// 51 Franklin Street, Fifth Floor, Boston, MA 02110-1301 USA.
var __extends = (this && this.__extends) || (function () {
    var extendStatics = Object.setPrototypeOf ||
        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||
        function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };
    return function (d, b) {
        extendStatics(d, b);
        function __() { this.constructor = d; }
        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
    };
})();
var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {
    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
    if (typeof Reflect === "object" && typeof Reflect.decorate === "function") r = Reflect.decorate(decorators, target, key, desc);
    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;
    return c > 3 && r && Object.defineProperty(target, key, r), r;
};




/**
 * Text Field Model
 *
 * Author: <a href='https://github.com/shilob' target='_blank'>Shilo Banihit</a>

 */
var TextField = /** @class */ (function (_super) {
    __extends(TextField, _super);
    function TextField(options, injector) {
        var _this = _super.call(this, options, injector) || this;
        _this.type = options['type'] || '';
        _this.controlType = 'textbox';
        _this.cssClasses = __WEBPACK_IMPORTED_MODULE_1_lodash_es__["isEmpty"](_this.cssClasses) ? 'form-control' : _this.cssClasses;
        return _this;
    }
    TextField.prototype.postInit = function (value) {
        if (__WEBPACK_IMPORTED_MODULE_1_lodash_es__["isEmpty"](value)) {
            this.value = this.defaultValue ? this.defaultValue : '';
        }
        else {
            this.value = value;
        }
    };
    return TextField;
}(__WEBPACK_IMPORTED_MODULE_2__field_base__["a" /* FieldBase */]));

var MarkdownTextArea = /** @class */ (function (_super) {
    __extends(MarkdownTextArea, _super);
    function MarkdownTextArea(options, injector) {
        var _this = _super.call(this, options, injector) || this;
        _this.rows = options['rows'] || 5;
        _this.cols = options['cols'] || null;
        _this.controlType = 'textarea';
        return _this;
    }
    MarkdownTextArea.prototype.formatValueForDisplay = function () {
        this.lines = this.value ? this.value.split("\n") : [];
    };
    return MarkdownTextArea;
}(__WEBPACK_IMPORTED_MODULE_2__field_base__["a" /* FieldBase */]));

var TextArea = /** @class */ (function (_super) {
    __extends(TextArea, _super);
    function TextArea(options, injector) {
        var _this = _super.call(this, options, injector) || this;
        _this.rows = options['rows'] || 5;
        _this.cols = options['cols'] || null;
        _this.controlType = 'textarea';
        _this.cssClasses = __WEBPACK_IMPORTED_MODULE_1_lodash_es__["isEmpty"](_this.cssClasses) ? 'form-control' : _this.cssClasses;
        return _this;
    }
    TextArea.prototype.formatValueForDisplay = function () {
        this.lines = this.value ? this.value.split("\n") : [];
    };
    return TextArea;
}(__WEBPACK_IMPORTED_MODULE_2__field_base__["a" /* FieldBase */]));

var TextFieldComponent = /** @class */ (function (_super) {
    __extends(TextFieldComponent, _super);
    function TextFieldComponent() {
        return _super !== null && _super.apply(this, arguments) || this;
    }
    TextFieldComponent = __decorate([
        Object(__WEBPACK_IMPORTED_MODULE_0__angular_core__["Component"])({
            selector: 'textfield',
            template: "\n  <div *ngIf=\"field.editMode && field.visible\" [ngClass]=\"getGroupClass()\">\n    <div *ngIf=\"!isEmbedded\" >\n      <label [attr.for]=\"field.name\">\n        {{field.label}} {{ getRequiredLabelStr() }}\n        <button type=\"button\" class=\"btn btn-default\" *ngIf=\"field.help\" (click)=\"toggleHelp()\"><span class=\"glyphicon glyphicon-question-sign\" aria-hidden=\"true\"></span></button>\n        <span id=\"{{ 'helpBlock_' + field.name }}\" class=\"help-block\" *ngIf=\"this.helpShow\" [innerHtml]=\"field.help\"></span>\n      </label>\n      <input [formGroup]='form' [formControl]=\"getFormControl()\"  [id]=\"field.name\" [type]=\"field.type\" [readonly]=\"field.readOnly\" [ngClass]=\"field.cssClasses\" [attr.aria-describedby]=\"field.help ? 'helpBlock_' + field.name : null\">\n    </div>\n    <div *ngIf=\"isEmbedded\" class=\"input-group padding-bottom-15\">\n      <input [formControl]=\"getFormControl(name, index)\"  [id]=\"field.name\" [type]=\"field.type\" [readonly]=\"field.readOnly\" [ngClass]=\"field.cssClasses\" [attr.aria-describedby]=\"field.help ? 'helpBlock_' + field.name : null\">\n      <span class=\"input-group-btn\">\n        <button type='button' *ngIf=\"removeBtnText\" [disabled]=\"!canRemove\" (click)=\"onRemove($event)\" [ngClass]=\"removeBtnClass\" >{{removeBtnText}}</button>\n        <button [disabled]=\"!canRemove\" type='button' [ngClass]=\"removeBtnClass\" (click)=\"onRemove($event)\"></button>\n      </span>\n    </div>\n    <div *ngIf=\"field.required\" [style.visibility]=\"getFormControl() && getFormControl().hasError('required') && getFormControl().touched ? 'inherit':'hidden'\">\n      <div class=\"text-danger\" *ngIf=\"!field.validationMessages?.required\">{{field.label}} is required</div>\n      <div class=\"text-danger\" *ngIf=\"field.validationMessages?.required\">{{field.validationMessages.required}}</div>\n    </div>\n  </div>\n  <div *ngIf=\"!field.editMode\" class=\"key-value-pair\">\n    <span class=\"key\" *ngIf=\"field.label\">{{field.label}}</span>\n    <span class=\"value\">{{field.value}}</span>\n  </div>\n  ",
        })
    ], TextFieldComponent);
    return TextFieldComponent;
}(__WEBPACK_IMPORTED_MODULE_3__field_repeatable_component__["a" /* EmbeddableComponent */]));

var RepeatableTextfieldComponent = /** @class */ (function (_super) {
    __extends(RepeatableTextfieldComponent, _super);
    function RepeatableTextfieldComponent() {
        return _super !== null && _super.apply(this, arguments) || this;
    }
    RepeatableTextfieldComponent.prototype.ngOnInit = function () {
    };
    RepeatableTextfieldComponent.prototype.addElem = function (event) {
        var newElem = this.field.addElem();
    };
    RepeatableTextfieldComponent.prototype.removeElem = function (event, i) {
        this.field.removeElem(i);
    };
    RepeatableTextfieldComponent.clName = 'RepeatableTextfieldComponent';
    RepeatableTextfieldComponent = __decorate([
        Object(__WEBPACK_IMPORTED_MODULE_0__angular_core__["Component"])({
            selector: 'repeatable-textfield',
            template: "\n  <div *ngIf=\"field.editMode\">\n    <div class=\"row\">\n      <div class=\"col-xs-12\">\n      <label>\n        {{field.label}} {{ getRequiredLabelStr() }}\n        <button type=\"button\" class=\"btn btn-default\" *ngIf=\"field.help\" (click)=\"toggleHelp()\"><span class=\"glyphicon glyphicon-question-sign\" aria-hidden=\"true\"></span></button>\n      </label>\n      <span id=\"{{ 'helpBlock_' + field.name }}\" class=\"help-block\" *ngIf=\"this.helpShow\" [innerHtml]=\"field.help\"></span>\n      </div>\n    </div>\n    <div *ngFor=\"let fieldElem of field.fields; let i = index;\" class=\"row\">\n      <span class=\"col-xs-12\">\n        <textfield [name]=\"field.name\" [field]=\"fieldElem\" [form]=\"form\" [fieldMap]=\"fieldMap\" [isEmbedded]=\"true\" [removeBtnText]=\"field.removeButtonText\" [removeBtnClass]=\"field.removeButtonClass\" [canRemove]=\"field.fields.length > 1\" (onRemoveBtnClick)=\"removeElem($event[0], $event[1])\" [index]=\"i\"></textfield>\n      </span>\n    </div>\n    <div class=\"row\">\n      <span class=\"col-xs-12\">\n        <button *ngIf=\"field.addButtonText\" type='button' (click)=\"addElem($event)\" [ngClass]=\"field.addButtonTextClass\" >{{field.addButtonText}}</button>\n        <button *ngIf=\"!field.addButtonText\" type='button' (click)=\"addElem($event)\" [ngClass]=\"field.addButtonClass\"></button>\n      </span>\n    </div>\n  </div>\n  <li *ngIf=\"!field.editMode\" class=\"key-value-pair\">\n    <span *ngIf=\"field.label\" class=\"key\">{{field.label}}</span>\n    <span class=\"value\">\n      <ul class=\"key-value-list\">\n        <textfield *ngFor=\"let fieldElem of field.fields; let i = index;\"  [field]=\"fieldElem\" [form]=\"form\" [fieldMap]=\"fieldMap\"></textfield>\n      </ul>\n    </span>\n  </li>\n  ",
        })
    ], RepeatableTextfieldComponent);
    return RepeatableTextfieldComponent;
}(__WEBPACK_IMPORTED_MODULE_3__field_repeatable_component__["b" /* RepeatableComponent */]));

/**
 * Component
 * Author: <a href='https://github.com/shilob' target='_blank'>Shilo Banihit</a>
 */
var TextAreaComponent = /** @class */ (function (_super) {
    __extends(TextAreaComponent, _super);
    function TextAreaComponent() {
        return _super !== null && _super.apply(this, arguments) || this;
    }
    TextAreaComponent.prototype.ngOnInit = function () {
        if (!this.field.editMode) {
            this.field.formatValueForDisplay();
        }
    };
    TextAreaComponent = __decorate([
        Object(__WEBPACK_IMPORTED_MODULE_0__angular_core__["Component"])({
            selector: 'text-area',
            template: "\n  <div *ngIf=\"field.editMode\" [formGroup]='form' [ngClass]=\"getGroupClass()\">\n    <label [attr.for]=\"field.name\">\n      {{field.label}} {{ getRequiredLabelStr()}}\n      <button type=\"button\" class=\"btn btn-default\" *ngIf=\"field.help\" (click)=\"toggleHelp()\"><span class=\"glyphicon glyphicon-question-sign\" aria-hidden=\"true\"></span></button>\n    </label>\n    <!-- Normal version -->\n    <ng-container *ngIf=\"!field.isEmbedded\">\n      <ng-container *ngIf=\"this.helpShow\">\n        <br/>\n        <span id=\"{{ 'helpBlock_' + field.name }}\" class=\"help-block\" [innerHtml]=\"field.help\"></span>\n      </ng-container>\n      <textarea [formControl]=\"getFormControl()\"  [attr.rows]=\"field.rows\" [attr.cols]=\"field.cols\" [id]=\"field.name\" [ngClass]=\"field.cssClasses\" >{{field.value}}</textarea>\n    </ng-container>\n    <!-- Embedded version -->\n    <div *ngIf=\"isEmbedded\" class=\"input-group padding-bottom-15\">\n      <textarea [formControl]=\"getFormControl(name, index)\"  [attr.rows]=\"field.rows\" [attr.cols]=\"field.cols\" [id]=\"field.name\" [ngClass]=\"field.cssClasses\">{{field.value}}</textarea>\n    </div>\n    <!-- Validation messages -->\n    <div *ngIf=\"field.required\" [style.visibility]=\"getFormControl() && getFormControl().hasError('required') && getFormControl().touched ? 'inherit':'hidden'\">\n      <div class=\"text-danger\" *ngIf=\"getFormControl().hasError('required') && getFormControl().touched && !field.validationMessages?.required\">{{field.label}} is required</div>\n      <div class=\"text-danger\" *ngIf=\"getFormControl().hasError('required') && getFormControl().touched && field.validationMessages?.required\">{{field.validationMessages.required}}</div>\n    </div>\n  </div>\n  <li *ngIf=\"!field.editMode\" class=\"key-value-pair\">\n    <span class=\"key\" *ngIf=\"field.label\">{{field.label}}</span>\n    <span *ngFor=\"let line of field.lines\">\n      {{line}}\n      <br/>\n    </span>\n    <br/>\n  </li>\n  "
        })
    ], TextAreaComponent);
    return TextAreaComponent;
}(__WEBPACK_IMPORTED_MODULE_3__field_repeatable_component__["a" /* EmbeddableComponent */]));

var MarkdownTextAreaComponent = /** @class */ (function (_super) {
    __extends(MarkdownTextAreaComponent, _super);
    function MarkdownTextAreaComponent() {
        return _super !== null && _super.apply(this, arguments) || this;
    }
    MarkdownTextAreaComponent.prototype.ngOnInit = function () {
        if (!this.field.editMode) {
            this.field.formatValueForDisplay();
        }
    };
    MarkdownTextAreaComponent = __decorate([
        Object(__WEBPACK_IMPORTED_MODULE_0__angular_core__["Component"])({
            selector: 'markdown-text-area',
            template: "\n  <div *ngIf=\"field.editMode\" [formGroup]='form' class=\"form-group\">\n    <label [attr.for]=\"field.name\">\n      {{field.label}} {{ getRequiredLabelStr()}}\n      <button type=\"button\" class=\"btn btn-default\" *ngIf=\"field.help\" (click)=\"toggleHelp()\"><span class=\"glyphicon glyphicon-question-sign\" aria-hidden=\"true\"></span></button>\n    </label><br/>\n    <span id=\"{{ 'helpBlock_' + field.name }}\" class=\"help-block\" *ngIf=\"this.helpShow\" [innerHtml]=\"field.help\"></span>\n    <textarea [formControl]=\"getFormControl()\"  [attr.rows]=\"field.rows\" [attr.cols]=\"field.cols\" [id]=\"field.name\" class=\"form-control\" [(ngModel)]=\"field.value\"></textarea>\n    <div *ngIf=\"field.value\" style='font-weight:bold'>Preview</div>\n    <markdown [data]=\"field.value\"></markdown>\n    <div class=\"text-danger\" *ngIf=\"getFormControl().hasError('required') && getFormControl().touched && !field.validationMessages?.required\">{{field.label}} is required</div>\n    <div class=\"text-danger\" *ngIf=\"getFormControl().hasError('required') && getFormControl().touched && field.validationMessages?.required\">{{field.validationMessages.required}}</div>\n  </div>\n  <li *ngIf=\"!field.editMode\" class=\"key-value-pair\">\n    <span class=\"key\" *ngIf=\"field.label\">{{field.label}}</span>\n    <markdown [data]=\"field.value\"></markdown>\n    <br/>\n  </li>\n  "
        })
    ], MarkdownTextAreaComponent);
    return MarkdownTextAreaComponent;
}(__WEBPACK_IMPORTED_MODULE_3__field_repeatable_component__["a" /* EmbeddableComponent */]));



/***/ }),

/***/ "./redbox-portal/angular/shared/form/field-vocab.component.ts":
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "a", function() { return VocabField; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "c", function() { return VocabFieldLookupService; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "b", function() { return VocabFieldComponent; });
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__angular_core__ = __webpack_require__("./node_modules/@angular/core/esm5/core.js");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1__field_simple_component__ = __webpack_require__("./redbox-portal/angular/shared/form/field-simple.component.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2__field_base__ = __webpack_require__("./redbox-portal/angular/shared/form/field-base.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3__angular_forms__ = __webpack_require__("./node_modules/@angular/forms/esm5/forms.js");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_lodash_es__ = __webpack_require__("./node_modules/lodash-es/lodash.js");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5_rxjs__ = __webpack_require__("./node_modules/rxjs/Rx.js");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5_rxjs___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_5_rxjs__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_6_rxjs_Subject__ = __webpack_require__("./node_modules/rxjs/_esm5/Subject.js");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_7_rxjs_add_operator_toPromise__ = __webpack_require__("./node_modules/rxjs/_esm5/add/operator/toPromise.js");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_7_rxjs_add_operator_toPromise___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_7_rxjs_add_operator_toPromise__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_8_rxjs_add_observable_of__ = __webpack_require__("./node_modules/rxjs/_esm5/add/observable/of.js");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_9_rxjs_add_operator_map__ = __webpack_require__("./node_modules/rxjs/_esm5/add/operator/map.js");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_10__angular_http__ = __webpack_require__("./node_modules/@angular/http/esm5/http.js");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_11__base_service__ = __webpack_require__("./redbox-portal/angular/shared/base-service.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_12__config_service__ = __webpack_require__("./redbox-portal/angular/shared/config-service.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_13_lucene_escape_query__ = __webpack_require__("./node_modules/lucene-escape-query/index.js");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_13_lucene_escape_query___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_13_lucene_escape_query__);
// Copyright (c) 2017 Queensland Cyber Infrastructure Foundation (http://www.qcif.edu.au/)
//
// GNU GENERAL PUBLIC LICENSE
//    Version 2, June 1991
//
// This program is free software; you can redistribute it and/or modify
// it under the terms of the GNU General Public License as published by
// the Free Software Foundation; either version 2 of the License, or
// (at your option) any later version.
//
// This program is distributed in the hope that it will be useful,
// but WITHOUT ANY WARRANTY; without even the implied warranty of
// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
// GNU General Public License for more details.
//
// You should have received a copy of the GNU General Public License along
// with this program; if not, write to the Free Software Foundation, Inc.,
// 51 Franklin Street, Fifth Floor, Boston, MA 02110-1301 USA.
var __extends = (this && this.__extends) || (function () {
    var extendStatics = Object.setPrototypeOf ||
        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||
        function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };
    return function (d, b) {
        extendStatics(d, b);
        function __() { this.constructor = d; }
        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
    };
})();
var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {
    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
    if (typeof Reflect === "object" && typeof Reflect.decorate === "function") r = Reflect.decorate(decorators, target, key, desc);
    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;
    return c > 3 && r && Object.defineProperty(target, key, r), r;
};
var __metadata = (this && this.__metadata) || function (k, v) {
    if (typeof Reflect === "object" && typeof Reflect.metadata === "function") return Reflect.metadata(k, v);
};
var __param = (this && this.__param) || function (paramIndex, decorator) {
    return function (target, key) { decorator(target, key, paramIndex); }
};














/**
 * Vocabulary Field
 *
 * Author: <a href='https://github.com/shilob' target='_blank'>Shilo Banihit</a>
 *
 */
var VocabField = /** @class */ (function (_super) {
    __extends(VocabField, _super);
    function VocabField(options, injector) {
        var _this = _super.call(this, options, injector) || this;
        _this.clName = 'VocabField';
        _this.hasLookup = true;
        _this.vocabId = options['vocabId'] || '';
        _this.controlType = 'textbox';
        _this.titleFieldName = options['titleFieldName'] || 'title';
        _this.titleFieldArr = options['titleFieldArr'] || [];
        _this.searchFields = options['searchFields'] || '';
        _this.titleFieldDelim = options['titleFieldDelim'] || ' - ';
        _this.fieldNames = options['fieldNames'] || [];
        _this.sourceType = options['sourceType'] || 'vocab';
        _this.placeHolder = options['placeHolder'] || 'Select a valid value';
        _this.disableEditAfterSelect = options['disableEditAfterSelect'] == undefined ? true : options['disableEditAfterSelect'];
        _this.stringLabelToField = options['stringLabelToField'] ? options['stringLabelToField'] : 'dc_title';
        return _this;
    }
    VocabField.prototype.createFormModel = function (valueElem, createFormGroup) {
        var _this = this;
        if (valueElem === void 0) { valueElem = undefined; }
        if (createFormGroup === void 0) { createFormGroup = false; }
        if (valueElem) {
            this.value = valueElem;
        }
        if (createFormGroup) {
            var flds_1 = {};
            __WEBPACK_IMPORTED_MODULE_4_lodash_es__["forEach"](this.fieldNames, function (fld) {
                __WEBPACK_IMPORTED_MODULE_4_lodash_es__["forOwn"](fld, function (srcFld, targetFld) {
                    flds_1[targetFld] = new __WEBPACK_IMPORTED_MODULE_3__angular_forms__["b" /* FormControl */](_this.value[targetFld] || '');
                });
            });
            this.formModel = new __WEBPACK_IMPORTED_MODULE_3__angular_forms__["c" /* FormGroup */](flds_1);
        }
        else {
            this.formModel = new __WEBPACK_IMPORTED_MODULE_3__angular_forms__["b" /* FormControl */](this.value || '');
        }
        if (this.value) {
            var init = __WEBPACK_IMPORTED_MODULE_4_lodash_es__["cloneDeep"](this.value);
            init.title = this.getTitle(this.value);
            this.initialValue = init;
        }
        if (this.required) {
            this.formModel.setValidators([__WEBPACK_IMPORTED_MODULE_3__angular_forms__["i" /* Validators */].required]);
        }
        return this.formModel;
    };
    VocabField.prototype.postInit = function (value) {
        if (value) {
            this.value = value;
        }
        else {
            this.setEmptyValue();
        }
        this.initLookupData();
    };
    VocabField.prototype.setEmptyValue = function () {
        this.value = null;
        return this.value;
    };
    VocabField.prototype.setLookupServices = function (completerService, lookupService) {
        this.completerService = completerService;
        this.lookupService = lookupService;
    };
    VocabField.prototype.initLookupData = function () {
        var _this = this;
        if (this.sourceType == "vocab") {
            // Hack for creating the intended title...
            __WEBPACK_IMPORTED_MODULE_4_lodash_es__["forEach"](this.sourceData, function (data) {
                data.title = _this.getTitle(data);
            });
            this.dataService = this.completerService.local(this.sourceData, this.searchFields, 'title');
        }
        else if (this.sourceType == "collection" || this.sourceType == "user") {
            var url = this.lookupService.getCollectionRootUrl(this.vocabId);
            if (this.sourceType == "user") {
                url = this.lookupService.getUserLookupUrl();
            }
            console.log("Using: " + url);
            // at the moment, multiple titles arrays are not supported
            // TODO: consider replacing with ngx-bootstrap typeahead
            var title = this.titleFieldArr.length == 1 ? this.titleFieldArr[0] : 'title';
            console.log("Using title: " + title);
            this.dataService = this.completerService.remote(url, this.searchFields, title);
        }
        else if (this.sourceType == "mint") {
            var url = this.lookupService.getMintRootUrl(this.vocabId);
            console.log("Using: " + url);
            this.dataService = new MintLookupDataService(url, this.lookupService.http, this.fieldNames, this.titleFieldName, this.titleFieldArr, this.titleFieldDelim, this.searchFields);
        }
    };
    VocabField.prototype.getTitle = function (data) {
        var _this = this;
        var title = '';
        if (data) {
            if (__WEBPACK_IMPORTED_MODULE_4_lodash_es__["isString"](this.titleFieldDelim)) {
                __WEBPACK_IMPORTED_MODULE_4_lodash_es__["forEach"](this.titleFieldArr, function (titleFld) {
                    var titleVal = data[titleFld];
                    if (titleVal) {
                        title = "" + title + (__WEBPACK_IMPORTED_MODULE_4_lodash_es__["isEmpty"](title) ? '' : _this.titleFieldDelim) + titleVal;
                    }
                });
            }
            else {
                // expecting a delim pair array, 'prefix', 'suffix'
                __WEBPACK_IMPORTED_MODULE_4_lodash_es__["forEach"](this.titleFieldArr, function (titleFld, idx) {
                    var delimPair = _this.titleFieldDelim[idx];
                    var titleVal = data[titleFld];
                    if (titleVal) {
                        title = "" + title + (__WEBPACK_IMPORTED_MODULE_4_lodash_es__["isEmpty"](title) ? '' : delimPair.prefix) + titleVal + (__WEBPACK_IMPORTED_MODULE_4_lodash_es__["isEmpty"](title) ? '' : delimPair.suffix);
                    }
                });
            }
        }
        return title;
    };
    VocabField.prototype.getValue = function (data) {
        var _this = this;
        var valObj = {};
        if (!__WEBPACK_IMPORTED_MODULE_4_lodash_es__["isUndefined"](data) && !__WEBPACK_IMPORTED_MODULE_4_lodash_es__["isEmpty"](data)) {
            if (__WEBPACK_IMPORTED_MODULE_4_lodash_es__["isString"](data)) {
                console.log("Data is string...");
                valObj[this.stringLabelToField] = data;
                return valObj;
            }
            __WEBPACK_IMPORTED_MODULE_4_lodash_es__["forEach"](this.fieldNames, function (fldName) {
                if (data.originalObject) {
                    _this.getFieldValuePair(fldName, data.originalObject, valObj);
                }
                else {
                    _this.getFieldValuePair(fldName, data, valObj);
                }
            });
        }
        return valObj;
    };
    VocabField.prototype.getFieldValuePair = function (fldName, data, valObj) {
        if (__WEBPACK_IMPORTED_MODULE_4_lodash_es__["isString"](fldName)) {
            valObj[fldName] = __WEBPACK_IMPORTED_MODULE_4_lodash_es__["get"](data, fldName);
        }
        else {
            // expects a value pair
            __WEBPACK_IMPORTED_MODULE_4_lodash_es__["forOwn"](fldName, function (srcFld, targetFld) {
                if (__WEBPACK_IMPORTED_MODULE_4_lodash_es__["get"](data, srcFld)) {
                    valObj[targetFld] = __WEBPACK_IMPORTED_MODULE_4_lodash_es__["get"](data, srcFld);
                }
                else {
                    valObj[targetFld] = __WEBPACK_IMPORTED_MODULE_4_lodash_es__["get"](data, targetFld);
                }
            });
        }
    };
    VocabField.prototype.setValue = function (value, emitEvent, updateTitle) {
        if (emitEvent === void 0) { emitEvent = true; }
        if (updateTitle === void 0) { updateTitle = false; }
        this.formModel.setValue(value, { emitEvent: emitEvent });
        if (updateTitle) {
            this.component.ngCompleter.ctrInput.nativeElement.value = this.getTitle(value);
        }
    };
    return VocabField;
}(__WEBPACK_IMPORTED_MODULE_2__field_base__["a" /* FieldBase */]));

var MintLookupDataService = /** @class */ (function (_super) {
    __extends(MintLookupDataService, _super);
    function MintLookupDataService(url, http, fields, compositeTitleName, titleFieldArr, titleFieldDelim, searchFieldStr) {
        var _this = _super.call(this) || this;
        _this.url = url;
        _this.http = http;
        _this.fields = fields;
        _this.compositeTitleName = compositeTitleName;
        _this.titleFieldArr = titleFieldArr;
        _this.titleFieldDelim = titleFieldDelim;
        _this.searchFields = searchFieldStr.split(',');
        return _this;
    }
    MintLookupDataService.prototype.search = function (term) {
        var _this = this;
        term = __WEBPACK_IMPORTED_MODULE_4_lodash_es__["trim"](__WEBPACK_IMPORTED_MODULE_13_lucene_escape_query__["escape"](term));
        var searchString = '';
        if (!__WEBPACK_IMPORTED_MODULE_4_lodash_es__["isEmpty"](term)) {
            term = __WEBPACK_IMPORTED_MODULE_4_lodash_es__["toLower"](term);
            __WEBPACK_IMPORTED_MODULE_4_lodash_es__["forEach"](this.searchFields, function (searchFld) {
                searchString = "" + searchString + (__WEBPACK_IMPORTED_MODULE_4_lodash_es__["isEmpty"](searchString) ? '' : ' OR ') + searchFld + ":" + term + "*";
            });
        }
        var searchUrl = "" + this.url + searchString;
        this.http.get("" + searchUrl).map(function (res, index) {
            // Convert the result to CompleterItem[]
            var data = res.json();
            var matches = __WEBPACK_IMPORTED_MODULE_4_lodash_es__["map"](data, function (mintDataItem) { return _this.convertToItem(mintDataItem); });
            _this.next(matches);
        }).subscribe();
    };
    MintLookupDataService.prototype.cancel = function () {
        // Handle cancel
    };
    MintLookupDataService.prototype.convertToItem = function (data) {
        if (!data) {
            return null;
        }
        var item = {};
        __WEBPACK_IMPORTED_MODULE_4_lodash_es__["forEach"](this.fields, function (fieldName) {
            if (__WEBPACK_IMPORTED_MODULE_4_lodash_es__["isString"](fieldName)) {
                item[fieldName] = data[fieldName];
            }
            else {
                // expects a value pair
                __WEBPACK_IMPORTED_MODULE_4_lodash_es__["forOwn"](fieldName, function (srcFld, targetFld) {
                    if (__WEBPACK_IMPORTED_MODULE_4_lodash_es__["get"](data, srcFld)) {
                        item[srcFld] = __WEBPACK_IMPORTED_MODULE_4_lodash_es__["get"](data, srcFld);
                    }
                    else {
                        item[targetFld] = __WEBPACK_IMPORTED_MODULE_4_lodash_es__["get"](data, targetFld);
                    }
                });
            }
        });
        // build the title,
        item[this.compositeTitleName] = this.getTitle(data);
        return item;
    };
    MintLookupDataService.prototype.getTitle = function (data) {
        var _this = this;
        var title = '';
        if (data) {
            if (__WEBPACK_IMPORTED_MODULE_4_lodash_es__["isString"](this.titleFieldDelim)) {
                __WEBPACK_IMPORTED_MODULE_4_lodash_es__["forEach"](this.titleFieldArr, function (titleFld) {
                    var titleVal = data[titleFld];
                    if (titleVal) {
                        title = "" + title + (__WEBPACK_IMPORTED_MODULE_4_lodash_es__["isEmpty"](title) ? '' : _this.titleFieldDelim) + data[titleFld];
                    }
                });
            }
            else {
                // expecting a delim pair array, 'prefix', 'suffix'
                __WEBPACK_IMPORTED_MODULE_4_lodash_es__["forEach"](this.titleFieldArr, function (titleFld, idx) {
                    var delimPair = _this.titleFieldDelim[idx];
                    var titleVal = data[titleFld];
                    if (titleVal) {
                        title = "" + title + delimPair.prefix + titleVal + delimPair.suffix;
                    }
                });
            }
        }
        return title;
    };
    return MintLookupDataService;
}(__WEBPACK_IMPORTED_MODULE_6_rxjs_Subject__["a" /* Subject */]));
var VocabFieldLookupService = /** @class */ (function (_super) {
    __extends(VocabFieldLookupService, _super);
    function VocabFieldLookupService(http, configService) {
        var _this = _super.call(this, http, configService) || this;
        _this.configService = configService;
        return _this;
    }
    VocabFieldLookupService.prototype.getLookupData = function (field) {
        var _this = this;
        var vocabId = field.vocabId;
        // only retrieving static data when on vocab mode
        if (field.sourceType == "vocab") {
            var url = this.brandingAndPortalUrl + "/" + this.config.vocabRootUrl + "/" + vocabId;
            return this.http.get(url, this.options)
                .flatMap(function (res) {
                var data = _this.extractData(res);
                field.sourceData = data;
                field.postInit(field.value);
                return __WEBPACK_IMPORTED_MODULE_5_rxjs__["Observable"].of(field);
            });
        }
        field.postInit(field.value);
        return __WEBPACK_IMPORTED_MODULE_5_rxjs__["Observable"].of(field);
    };
    VocabFieldLookupService.prototype.getCollectionRootUrl = function (collectionId) {
        return this.brandingAndPortalUrl + "/" + this.config.collectionRootUri + "/" + collectionId + "/?search=";
    };
    VocabFieldLookupService.prototype.getUserLookupUrl = function (searchSource) {
        if (searchSource === void 0) { searchSource = ''; }
        return this.brandingAndPortalUrl + "/" + this.config.userRootUri + "/?source=" + searchSource + "&name=";
    };
    VocabFieldLookupService.prototype.findLookupData = function (field, search) {
    };
    VocabFieldLookupService.prototype.getMintRootUrl = function (source) {
        return this.brandingAndPortalUrl + "/" + this.config.mintRootUri + "/" + source + "/?search=";
    };
    VocabFieldLookupService = __decorate([
        Object(__WEBPACK_IMPORTED_MODULE_0__angular_core__["Injectable"])(),
        __param(0, Object(__WEBPACK_IMPORTED_MODULE_0__angular_core__["Inject"])(__WEBPACK_IMPORTED_MODULE_10__angular_http__["b" /* Http */])), __param(1, Object(__WEBPACK_IMPORTED_MODULE_0__angular_core__["Inject"])(__WEBPACK_IMPORTED_MODULE_12__config_service__["a" /* ConfigService */])),
        __metadata("design:paramtypes", [__WEBPACK_IMPORTED_MODULE_10__angular_http__["b" /* Http */], __WEBPACK_IMPORTED_MODULE_12__config_service__["a" /* ConfigService */]])
    ], VocabFieldLookupService);
    return VocabFieldLookupService;
}(__WEBPACK_IMPORTED_MODULE_11__base_service__["a" /* BaseService */]));

var VocabFieldComponent = /** @class */ (function (_super) {
    __extends(VocabFieldComponent, _super);
    function VocabFieldComponent() {
        var _this = _super.call(this) || this;
        _this.isEmbedded = false;
        _this.canRemove = false;
        _this.removeBtnText = null;
        _this.removeBtnClass = 'fa fa-minus-circle btn text-20 pull-right btn-danger';
        _this.disableEditAfterSelect = true;
        _this.onRemoveBtnClick = new __WEBPACK_IMPORTED_MODULE_0__angular_core__["EventEmitter"]();
        return _this;
    }
    VocabFieldComponent.prototype.ngOnInit = function () {
        this.field.component = this;
    };
    VocabFieldComponent.prototype.getGroupClass = function (fldName) {
        if (fldName === void 0) { fldName = null; }
        return "col-xs-12 form-group " + (this.hasRequiredError() ? 'has-error' : '');
    };
    VocabFieldComponent.prototype.onSelect = function (selected, emitEvent, updateTitle) {
        if (emitEvent === void 0) { emitEvent = true; }
        if (updateTitle === void 0) { updateTitle = false; }
        var disableEditAfterSelect = this.disableEditAfterSelect && this.field.disableEditAfterSelect;
        if (selected) {
            this.field.setValue(this.field.getValue(selected), emitEvent, updateTitle);
            if (disableEditAfterSelect)
                this.disableInput = true;
        }
        else {
            if (disableEditAfterSelect) {
                // means user can't edit, so no worries!
                this.field.setValue(null, emitEvent, updateTitle);
            }
            else {
                // set whatever value on the searchStr, let the fields decide how to parse the string...
                this.field.setValue(this.field.getValue(this.field.searchStr), emitEvent, updateTitle);
            }
        }
    };
    VocabFieldComponent.prototype.onKeyup = function (value) {
        var disableEditAfterSelect = this.disableEditAfterSelect && this.field.disableEditAfterSelect;
        if (!disableEditAfterSelect) {
            this.field.formModel.setValue(this.field.getValue(this.field.searchStr));
        }
    };
    VocabFieldComponent.prototype.onRemove = function (event) {
        this.onRemoveBtnClick.emit([event, this.index]);
    };
    VocabFieldComponent.prototype.getTitle = function () {
        return this.field && __WEBPACK_IMPORTED_MODULE_4_lodash_es__["isFunction"](this.field.getTitle) ? this.field.getTitle(this.field.value) : '';
    };
    __decorate([
        Object(__WEBPACK_IMPORTED_MODULE_0__angular_core__["Input"])(),
        __metadata("design:type", VocabField)
    ], VocabFieldComponent.prototype, "field", void 0);
    __decorate([
        Object(__WEBPACK_IMPORTED_MODULE_0__angular_core__["Input"])(),
        __metadata("design:type", Boolean)
    ], VocabFieldComponent.prototype, "isEmbedded", void 0);
    __decorate([
        Object(__WEBPACK_IMPORTED_MODULE_0__angular_core__["Input"])(),
        __metadata("design:type", Boolean)
    ], VocabFieldComponent.prototype, "canRemove", void 0);
    __decorate([
        Object(__WEBPACK_IMPORTED_MODULE_0__angular_core__["Input"])(),
        __metadata("design:type", String)
    ], VocabFieldComponent.prototype, "removeBtnText", void 0);
    __decorate([
        Object(__WEBPACK_IMPORTED_MODULE_0__angular_core__["Input"])(),
        __metadata("design:type", String)
    ], VocabFieldComponent.prototype, "removeBtnClass", void 0);
    __decorate([
        Object(__WEBPACK_IMPORTED_MODULE_0__angular_core__["Input"])(),
        __metadata("design:type", Number)
    ], VocabFieldComponent.prototype, "index", void 0);
    __decorate([
        Object(__WEBPACK_IMPORTED_MODULE_0__angular_core__["Input"])(),
        __metadata("design:type", Boolean)
    ], VocabFieldComponent.prototype, "disableEditAfterSelect", void 0);
    __decorate([
        Object(__WEBPACK_IMPORTED_MODULE_0__angular_core__["Output"])(),
        __metadata("design:type", __WEBPACK_IMPORTED_MODULE_0__angular_core__["EventEmitter"])
    ], VocabFieldComponent.prototype, "onRemoveBtnClick", void 0);
    __decorate([
        Object(__WEBPACK_IMPORTED_MODULE_0__angular_core__["ViewChild"])('ngCompleter'),
        __metadata("design:type", __WEBPACK_IMPORTED_MODULE_0__angular_core__["ElementRef"])
    ], VocabFieldComponent.prototype, "ngCompleter", void 0);
    VocabFieldComponent = __decorate([
        Object(__WEBPACK_IMPORTED_MODULE_0__angular_core__["Component"])({
            selector: 'rb-vocab',
            template: "\n  <div *ngIf=\"field.editMode && !isEmbedded\" [formGroup]='form' [ngClass]=\"getGroupClass()\">\n    <label>\n      {{field.label}} {{getRequiredLabelStr()}}\n      <button type=\"button\" class=\"btn btn-default\" *ngIf=\"field.help\" (click)=\"toggleHelp()\"><span class=\"glyphicon glyphicon-question-sign\" aria-hidden=\"true\"></span></button>\n    </label>\n    <span id=\"{{ 'helpBlock_' + field.name }}\" class=\"help-block\" *ngIf=\"this.helpShow\" >{{field.help}}</span>\n    <ng2-completer #ngCompleter [(ngModel)]=\"field.searchStr\" [ngModelOptions]=\"{standalone: true}\" [disableInput]=\"disableInput\" [placeholder]=\"field.placeHolder\" [clearUnselected]=\"disableEditAfterSelect && field.disableEditAfterSelect\" (keyup)=\"onKeyup($event)\" (selected)=\"onSelect($event)\" [datasource]=\"field.dataService\" [minSearchLength]=\"0\" [inputClass]=\"'form-control'\" [initialValue]=\"field.initialValue\"></ng2-completer>\n    <div class=\"text-danger\" *ngIf=\"hasRequiredError()\">{{field.validationMessages.required}}</div>\n  </div>\n  <div *ngIf=\"field.editMode && isEmbedded\" [formGroup]='form' [ngClass]=\"getGroupClass()\">\n    <div class=\"row\">\n      <span id=\"{{ 'helpBlock_' + field.name }}\" class=\"help-block\" *ngIf=\"this.helpShow\" >{{field.help}}</span>\n      <div class=\"col-xs-11 padding-remove\">\n        <ng2-completer #ngCompleter [(ngModel)]=\"field.searchStr\" [ngModelOptions]=\"{standalone: true}\" [disableInput]=\"disableInput\" [placeholder]=\"field.placeHolder\" [clearUnselected]=\"disableEditAfterSelect && field.disableEditAfterSelect\" (keyup)=\"onKeyup($event)\" (selected)=\"onSelect($event)\" [datasource]=\"field.dataService\" [minSearchLength]=\"0\" [inputClass]=\"'form-control'\" [initialValue]=\"field.initialValue\"></ng2-completer>\n      </div>\n      <div class=\"col-xs-1 padding-remove\">\n        <button type='button' *ngIf=\"removeBtnText\" [disabled]=\"!canRemove\" (click)=\"onRemove($event)\" [ngClass]=\"removeBtnClass\" >{{removeBtnText}}</button>\n        <button [disabled]=\"!canRemove\" type='button' [ngClass]=\"removeBtnClass\" (click)=\"onRemove($event)\"></button>\n      </div>\n    </div>\n    <div class=\"row\">\n      <div class=\"col-xs-12 text-danger\" *ngIf=\"hasRequiredError()\">{{field.validationMessages.required}}</div>\n    </div>\n  </div>\n\n  <li *ngIf=\"!field.editMode\" class=\"key-value-pair\">\n    <span *ngIf=\"field.label\" class=\"key\">{{field.label}}</span>\n    <span class=\"value\">{{getTitle()}}</span>\n  </li>\n  ",
        }),
        __metadata("design:paramtypes", [])
    ], VocabFieldComponent);
    return VocabFieldComponent;
}(__WEBPACK_IMPORTED_MODULE_1__field_simple_component__["l" /* SimpleComponent */]));



/***/ }),

/***/ "./redbox-portal/angular/shared/form/record-meta.component.ts":
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "b", function() { return RecordMetadataRetrieverField; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "a", function() { return RecordMetadataRetrieverComponent; });
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__angular_core__ = __webpack_require__("./node_modules/@angular/core/esm5/core.js");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1__field_base__ = __webpack_require__("./redbox-portal/angular/shared/form/field-base.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2__records_service__ = __webpack_require__("./redbox-portal/angular/shared/form/records.service.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3__field_simple_component__ = __webpack_require__("./redbox-portal/angular/shared/form/field-simple.component.ts");
var __extends = (this && this.__extends) || (function () {
    var extendStatics = Object.setPrototypeOf ||
        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||
        function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };
    return function (d, b) {
        extendStatics(d, b);
        function __() { this.constructor = d; }
        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
    };
})();
var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {
    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
    if (typeof Reflect === "object" && typeof Reflect.decorate === "function") r = Reflect.decorate(decorators, target, key, desc);
    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;
    return c > 3 && r && Object.defineProperty(target, key, r), r;
};
// Copyright (c) 2017 Queensland Cyber Infrastructure Foundation (http://www.qcif.edu.au/)
//
// GNU GENERAL PUBLIC LICENSE
//    Version 2, June 1991
//
// This program is free software; you can redistribute it and/or modify
// it under the terms of the GNU General Public License as published by
// the Free Software Foundation; either version 2 of the License, or
// (at your option) any later version.
//
// This program is distributed in the hope that it will be useful,
// but WITHOUT ANY WARRANTY; without even the implied warranty of
// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
// GNU General Public License for more details.
//
// You should have received a copy of the GNU General Public License along
// with this program; if not, write to the Free Software Foundation, Inc.,
// 51 Franklin Street, Fifth Floor, Boston, MA 02110-1301 USA.




var RecordMetadataRetrieverField = /** @class */ (function (_super) {
    __extends(RecordMetadataRetrieverField, _super);
    function RecordMetadataRetrieverField(options, injector) {
        var _this = _super.call(this, options, injector) || this;
        _this.recordsService = _this.getFromInjector(__WEBPACK_IMPORTED_MODULE_2__records_service__["a" /* RecordsService */]);
        _this.parameterName = options.parameterName || '';
        return _this;
    }
    RecordMetadataRetrieverField.prototype.publishMetadata = function (oid, config) {
        var _this = this;
        this.recordsService.getRecordMeta(oid).then(function (data) {
            _this.onValueUpdate.emit(data);
        });
    };
    return RecordMetadataRetrieverField;
}(__WEBPACK_IMPORTED_MODULE_1__field_base__["a" /* FieldBase */]));

var RecordMetadataRetrieverComponent = /** @class */ (function (_super) {
    __extends(RecordMetadataRetrieverComponent, _super);
    function RecordMetadataRetrieverComponent() {
        return _super !== null && _super.apply(this, arguments) || this;
    }
    RecordMetadataRetrieverComponent = __decorate([
        Object(__WEBPACK_IMPORTED_MODULE_0__angular_core__["Component"])({
            selector: 'record-metadata-retriever',
            template: "\n  ",
        })
    ], RecordMetadataRetrieverComponent);
    return RecordMetadataRetrieverComponent;
}(__WEBPACK_IMPORTED_MODULE_3__field_simple_component__["l" /* SimpleComponent */]));



/***/ }),

/***/ "./redbox-portal/angular/shared/form/records.service.ts":
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "a", function() { return RecordsService; });
/* unused harmony export RecordActionResult */
/* unused harmony export RecordSearchRefiner */
/* unused harmony export RecordSearchParams */
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__angular_core__ = __webpack_require__("./node_modules/@angular/core/esm5/core.js");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1__base_service__ = __webpack_require__("./redbox-portal/angular/shared/base-service.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2__angular_http__ = __webpack_require__("./node_modules/@angular/http/esm5/http.js");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_rxjs_add_operator_toPromise__ = __webpack_require__("./node_modules/rxjs/_esm5/add/operator/toPromise.js");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_rxjs_add_operator_toPromise___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_3_rxjs_add_operator_toPromise__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4__field_control_meta_service__ = __webpack_require__("./redbox-portal/angular/shared/form/field-control-meta.service.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5_rxjs_Observable__ = __webpack_require__("./node_modules/rxjs/_esm5/Observable.js");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_6_lodash_es__ = __webpack_require__("./node_modules/lodash-es/lodash.js");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_7__config_service__ = __webpack_require__("./redbox-portal/angular/shared/config-service.ts");
// Copyright (c) 2017 Queensland Cyber Infrastructure Foundation (http://www.qcif.edu.au/)
//
// GNU GENERAL PUBLIC LICENSE
//    Version 2, June 1991
//
// This program is free software; you can redistribute it and/or modify
// it under the terms of the GNU General Public License as published by
// the Free Software Foundation; either version 2 of the License, or
// (at your option) any later version.
//
// This program is distributed in the hope that it will be useful,
// but WITHOUT ANY WARRANTY; without even the implied warranty of
// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
// GNU General Public License for more details.
//
// You should have received a copy of the GNU General Public License along
// with this program; if not, write to the Free Software Foundation, Inc.,
// 51 Franklin Street, Fifth Floor, Boston, MA 02110-1301 USA.
var __extends = (this && this.__extends) || (function () {
    var extendStatics = Object.setPrototypeOf ||
        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||
        function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };
    return function (d, b) {
        extendStatics(d, b);
        function __() { this.constructor = d; }
        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
    };
})();
var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {
    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
    if (typeof Reflect === "object" && typeof Reflect.decorate === "function") r = Reflect.decorate(decorators, target, key, desc);
    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;
    return c > 3 && r && Object.defineProperty(target, key, r), r;
};
var __metadata = (this && this.__metadata) || function (k, v) {
    if (typeof Reflect === "object" && typeof Reflect.metadata === "function") return Reflect.metadata(k, v);
};
var __param = (this && this.__param) || function (paramIndex, decorator) {
    return function (target, key) { decorator(target, key, paramIndex); }
};








/**
 * Plan Client-side services
 *
 *
 *
 * Author: <a href='https://github.com/shilob' target='_blank'>Shilo Banihit</a>
 */
var RecordsService = /** @class */ (function (_super) {
    __extends(RecordsService, _super);
    function RecordsService(http, fcmetaService, configService, app) {
        var _this = _super.call(this, http, configService) || this;
        _this.fcmetaService = fcmetaService;
        _this.configService = configService;
        _this.app = app;
        return _this;
    }
    RecordsService.prototype.getForm = function (oid, recordType, editable) {
        var _this = this;
        if (oid === void 0) { oid = null; }
        if (recordType === void 0) { recordType = null; }
        if (editable === void 0) { editable = true; }
        if (__WEBPACK_IMPORTED_MODULE_6_lodash_es__["isEmpty"](oid)) {
            oid = null;
        }
        return this.getFormFieldsMeta(recordType, editable, oid).then(function (form) {
            return _this.fcmetaService.getLookupData(form.fieldsMeta).flatMap(function (fields) {
                form.fieldsMata = fields;
                return __WEBPACK_IMPORTED_MODULE_5_rxjs_Observable__["a" /* Observable */].of(form);
            });
        });
    };
    RecordsService.prototype.addRenderCompleteElement = function (fieldsMeta) {
        var renderCompleteElement = {
            "class": "Container",
            "compClass": "TextBlockComponent",
            "definition": {
                "value": "",
                "type": "span",
                "cssClasses": "form-render-complete"
            }
        };
        fieldsMeta.push(renderCompleteElement);
    };
    RecordsService.prototype.getFormFields = function (recordType, oid, editable) {
        var _this = this;
        if (oid === void 0) { oid = null; }
        var ts = new Date().getTime();
        console.log("Oid is: " + oid);
        var url = oid ? this.brandingAndPortalUrl + "/record/form/auto/" + oid + "?edit=" + editable + "&ts=" + ts : this.brandingAndPortalUrl + "/record/form/" + recordType + "?edit=" + editable + "&ts=" + ts;
        console.log("URL is: " + url);
        return this.http.get(url, this.options)
            .toPromise()
            .then(function (res) { return _this.extractData(res); });
    };
    RecordsService.prototype.getFormFieldsMeta = function (recordType, editable, oid) {
        var _this = this;
        if (oid === void 0) { oid = null; }
        return this.getFormFields(recordType, oid, editable).then(function (form) {
            if (form && form.fields) {
                if (!editable) {
                    // Add an empty element to the end of the form so a screenshot tool can detect the rendered form reliably
                    _this.addRenderCompleteElement(form.fields);
                }
                form.fieldsMeta = _this.fcmetaService.getFieldsMeta(form.fields);
            }
            else {
                console.error("Error loading form:" + recordType);
                throw form;
            }
            return form;
        });
    };
    RecordsService.prototype.create = function (record, recordType) {
        var _this = this;
        return this.http.post(this.brandingAndPortalUrl + "/recordmeta/" + recordType, record, this.getOptionsClient())
            .map(function (res) { return _this.extractData(res); });
    };
    RecordsService.prototype.update = function (oid, record) {
        var _this = this;
        return this.http.put(this.brandingAndPortalUrl + "/recordmeta/" + oid, record, this.getOptionsClient())
            .map(function (res) { return _this.extractData(res); });
    };
    RecordsService.prototype.stepTo = function (oid, record, targetStep) {
        var _this = this;
        return this.http.post(this.brandingAndPortalUrl + "/record/workflow/step/" + targetStep + "/" + oid, record, this.getOptionsClient())
            .map(function (res) { return _this.extractData(res); });
    };
    RecordsService.prototype.getDashboardUrl = function (recType) {
        if (recType === void 0) { recType = 'rdmp'; }
        return this.brandingAndPortalUrl + "/dashboard/" + recType;
    };
    RecordsService.prototype.getAttachments = function (oid) {
        var _this = this;
        return this.http.get(this.brandingAndPortalUrl + "/record/" + oid + "/attachments", this.getOptionsClient()).toPromise()
            .then(function (res) { return _this.extractData(res); });
    };
    RecordsService.prototype.modifyEditors = function (records, username, email) {
        var _this = this;
        return this.http.post(this.brandingAndPortalUrl + "/record/editors/modify", { records: records, username: username, email: email }, this.getOptionsClient())
            .toPromise()
            .then(function (res) { return _this.extractData(res); });
    };
    RecordsService.prototype.updateResponsibilities = function (records, role, email, name) {
        var _this = this;
        return this.http.post(this.brandingAndPortalUrl + "/record/responsibility/update", { records: records, role: role, email: email, name: name }, this.getOptionsClient())
            .toPromise()
            .then(function (res) { return _this.extractData(res); });
    };
    RecordsService.prototype.getTransferResponsibility = function (recordType) {
        var _this = this;
        return this.http.get(this.brandingAndPortalUrl + "/transferconfig/" + recordType, this.getOptionsClient())
            .toPromise()
            .then(function (res) { return _this.extractData(res); });
    };
    RecordsService.prototype.search = function (params) {
        var _this = this;
        var refinedSearchStr = '';
        params.filterActiveRefinersWithNoData();
        if (__WEBPACK_IMPORTED_MODULE_6_lodash_es__["size"](params.activeRefiners) > 0) {
            var exactSearchNames_1 = '';
            var exactSearchValues_1 = '';
            var facetSearchNames_1 = '';
            var facetSearchValues_1 = '';
            __WEBPACK_IMPORTED_MODULE_6_lodash_es__["forEach"](params.activeRefiners, function (refiner) {
                switch (refiner.type) {
                    case "exact":
                        exactSearchNames_1 = "" + (__WEBPACK_IMPORTED_MODULE_6_lodash_es__["isEmpty"](exactSearchNames_1) ? "&exactNames=" : exactSearchNames_1 + ",") + refiner.name;
                        exactSearchValues_1 = exactSearchValues_1 + "&exact_" + refiner.name + "=" + refiner.value;
                        break;
                    case "facet":
                        facetSearchNames_1 = "" + (__WEBPACK_IMPORTED_MODULE_6_lodash_es__["isEmpty"](facetSearchNames_1) ? "&facetNames=" : facetSearchNames_1 + ",") + refiner.name;
                        if (!__WEBPACK_IMPORTED_MODULE_6_lodash_es__["isEmpty"](refiner.activeValue)) {
                            facetSearchValues_1 = facetSearchValues_1 + "&facet_" + refiner.name + "=" + refiner.activeValue;
                        }
                        break;
                }
            });
            refinedSearchStr = "" + exactSearchNames_1 + exactSearchValues_1 + facetSearchNames_1 + facetSearchValues_1;
        }
        return this.http.get(this.brandingAndPortalUrl + "/record/search/" + params.recordType + "/?searchStr=" + params.basicSearch + refinedSearchStr, this.getOptionsClient())
            .toPromise()
            .then(function (res) { return _this.extractData(res); });
    };
    RecordsService.prototype.getType = function (name) {
        var _this = this;
        return this.http.get(this.brandingAndPortalUrl + "/record/type/" + name, this.getOptionsClient())
            .toPromise()
            .then(function (res) { return _this.extractData(res); });
    };
    RecordsService.prototype.getAllTypes = function () {
        var _this = this;
        return this.http.get(this.brandingAndPortalUrl + "/record/type/", this.getOptionsClient())
            .toPromise()
            .then(function (res) { return _this.extractData(res); });
    };
    RecordsService.prototype.getWorkflowSteps = function (name) {
        var _this = this;
        return this.http.get(this.brandingAndPortalUrl + "/record/wfSteps/" + name, this.getOptionsClient())
            .toPromise()
            .then(function (res) { return _this.extractData(res); });
    };
    RecordsService.prototype.getRecordMeta = function (oid) {
        var _this = this;
        if (oid === void 0) { oid = null; }
        return this.http.get(this.brandingAndPortalUrl + "/record/metadata/" + oid, this.options)
            .toPromise()
            .then(function (res) { return _this.extractData(res); });
    };
    RecordsService.prototype.executeAction = function (action, params) {
        var _this = this;
        return this.http.post(this.brandingAndPortalUrl + "/action/" + action, params, this.options)
            .toPromise()
            .then(function (res) { return _this.extractData(res); });
    };
    RecordsService.prototype.getAsyncProgress = function (fq) {
        var _this = this;
        return this.http.get(this.brandingAndPortalUrl + "/asynch?fq=" + fq, this.options)
            .toPromise()
            .then(function (res) { return _this.extractData(res); });
    };
    RecordsService.prototype.subscribeToAsyncProgress = function (oid, connectCb) {
        if (oid === void 0) { oid = null; }
        io.socket.get(this.brandingAndPortalUrl + "/asynch/subscribe/" + oid, connectCb);
    };
    RecordsService.prototype.delete = function (oid) {
        var _this = this;
        return this.http.delete(this.brandingAndPortalUrl + "/record/delete/" + oid, this.getOptionsClient())
            .map(function (res) { return _this.extractData(res); });
    };
    RecordsService = __decorate([
        Object(__WEBPACK_IMPORTED_MODULE_0__angular_core__["Injectable"])(),
        __param(0, Object(__WEBPACK_IMPORTED_MODULE_0__angular_core__["Inject"])(__WEBPACK_IMPORTED_MODULE_2__angular_http__["b" /* Http */])),
        __param(1, Object(__WEBPACK_IMPORTED_MODULE_0__angular_core__["Inject"])(__WEBPACK_IMPORTED_MODULE_4__field_control_meta_service__["a" /* FieldControlMetaService */])),
        __param(2, Object(__WEBPACK_IMPORTED_MODULE_0__angular_core__["Inject"])(__WEBPACK_IMPORTED_MODULE_7__config_service__["a" /* ConfigService */])),
        __metadata("design:paramtypes", [__WEBPACK_IMPORTED_MODULE_2__angular_http__["b" /* Http */],
            __WEBPACK_IMPORTED_MODULE_4__field_control_meta_service__["a" /* FieldControlMetaService */],
            __WEBPACK_IMPORTED_MODULE_7__config_service__["a" /* ConfigService */],
            __WEBPACK_IMPORTED_MODULE_0__angular_core__["ApplicationRef"]])
    ], RecordsService);
    return RecordsService;
}(__WEBPACK_IMPORTED_MODULE_1__base_service__["a" /* BaseService */]));

var RecordActionResult = /** @class */ (function () {
    function RecordActionResult() {
    }
    return RecordActionResult;
}());

var RecordSearchRefiner = /** @class */ (function () {
    function RecordSearchRefiner(opts) {
        if (opts === void 0) { opts = {}; }
        this.name = opts.name;
        this.title = opts.title;
        this.type = opts.type;
        this.value = opts.value;
        this.typeLabel = opts.typeLabel;
        this.alwaysActive = opts.alwaysActive;
    }
    RecordSearchRefiner.prototype.setCurrentValue = function (value) {
        if (this.type == "facet") {
            this.activeValue = value;
        }
        else {
            this.value = value;
        }
    };
    return RecordSearchRefiner;
}());

var RecordSearchParams = /** @class */ (function () {
    function RecordSearchParams(recType) {
        this.recordType = recType;
        this.activeRefiners = [];
        this.clear();
    }
    RecordSearchParams.prototype.clear = function () {
        this.basicSearch = null;
        __WEBPACK_IMPORTED_MODULE_6_lodash_es__["remove"](this.activeRefiners, function (refiner) {
            refiner.value = null;
            refiner.activeValue = null;
            return !refiner.alwaysActive;
        });
    };
    RecordSearchParams.prototype.getRefinerConfig = function (name) {
        return __WEBPACK_IMPORTED_MODULE_6_lodash_es__["find"](this.refinerConfig, function (config) {
            return config.name == name;
        });
    };
    RecordSearchParams.prototype.setRefinerConfig = function (config) {
        var _this = this;
        this.refinerConfig = config;
        // parse through and activate those set as active...
        __WEBPACK_IMPORTED_MODULE_6_lodash_es__["forEach"](this.refinerConfig, function (refinerConfig) {
            if (refinerConfig.alwaysActive) {
                _this.addActiveRefiner(refinerConfig);
            }
        });
    };
    RecordSearchParams.prototype.getHttpQuery = function (searchUrl) {
        var refinerValues = '';
        __WEBPACK_IMPORTED_MODULE_6_lodash_es__["forEach"](this.activeRefiners, function (refiner) {
            if (refiner.type == "facet") {
                refinerValues = refinerValues + "&refiner|" + refiner.name + "=" + (__WEBPACK_IMPORTED_MODULE_6_lodash_es__["isEmpty"](refiner.activeValue) ? '' : refiner.activeValue);
            }
            else {
                refinerValues = refinerValues + "&refiner|" + refiner.name + "=" + (__WEBPACK_IMPORTED_MODULE_6_lodash_es__["isEmpty"](refiner.value) ? '' : refiner.value);
            }
        });
        return searchUrl + "?q=" + this.basicSearch + "&type=" + this.recordType + refinerValues;
    };
    RecordSearchParams.prototype.getRefinerConfigs = function () {
        return this.refinerConfig;
    };
    RecordSearchParams.prototype.addActiveRefiner = function (refiner) {
        var existingRefiner = __WEBPACK_IMPORTED_MODULE_6_lodash_es__["find"](this.activeRefiners, function (activeRefiner) {
            return activeRefiner.name == refiner.name;
        });
        if (existingRefiner) {
            existingRefiner.value = refiner.value;
        }
        else {
            this.activeRefiners.push(refiner);
        }
    };
    RecordSearchParams.prototype.parseQueryStr = function (queryStr) {
        var _this = this;
        queryStr = decodeURI(queryStr);
        var refinerValues = {};
        __WEBPACK_IMPORTED_MODULE_6_lodash_es__["forEach"](queryStr.split('&'), function (q) {
            var qObj = q.split('=');
            if (__WEBPACK_IMPORTED_MODULE_6_lodash_es__["startsWith"](qObj[0], "q")) {
                _this.basicSearch = qObj[1];
            }
            if (__WEBPACK_IMPORTED_MODULE_6_lodash_es__["startsWith"](qObj[0], "refiner|")) {
                var refinerName = qObj[0].split('|')[1];
                refinerValues[refinerName] = qObj[1];
            }
        });
        __WEBPACK_IMPORTED_MODULE_6_lodash_es__["forOwn"](refinerValues, function (value, name) {
            var config = _this.getRefinerConfig(name);
            config.setCurrentValue(value);
            _this.addActiveRefiner(config);
        });
    };
    RecordSearchParams.prototype.filterActiveRefinersWithNoData = function () {
        var removed = __WEBPACK_IMPORTED_MODULE_6_lodash_es__["remove"](this.activeRefiners, function (refiner) {
            var value = refiner.type == 'exact' ? refiner.value : refiner.activeValue;
            return !refiner.alwaysActive && (__WEBPACK_IMPORTED_MODULE_6_lodash_es__["isEmpty"](value) || __WEBPACK_IMPORTED_MODULE_6_lodash_es__["isUndefined"](value));
        });
    };
    RecordSearchParams.prototype.hasActiveRefiners = function () {
        var hasActive = false;
        __WEBPACK_IMPORTED_MODULE_6_lodash_es__["forEach"](this.activeRefiners, function (refiner) {
            if (!hasActive && (!__WEBPACK_IMPORTED_MODULE_6_lodash_es__["isEmpty"](refiner.value))) {
                hasActive = true;
            }
        });
        return hasActive;
    };
    RecordSearchParams.prototype.setFacetValues = function (facets) {
        var _this = this;
        __WEBPACK_IMPORTED_MODULE_6_lodash_es__["forEach"](facets, function (facet) {
            var refiner = __WEBPACK_IMPORTED_MODULE_6_lodash_es__["find"](_this.activeRefiners, function (refinerConfig) {
                return refinerConfig.name == facet.name;
            });
            if (refiner) {
                refiner.value = facet.values;
            }
        });
    };
    return RecordSearchParams;
}());



/***/ }),

/***/ "./redbox-portal/angular/shared/form/workflow-button.component.ts":
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "a", function() { return WorkflowStepButton; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "b", function() { return WorkflowStepButtonComponent; });
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__angular_core__ = __webpack_require__("./node_modules/@angular/core/esm5/core.js");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1__field_simple_component__ = __webpack_require__("./redbox-portal/angular/shared/form/field-simple.component.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2__field_simple__ = __webpack_require__("./redbox-portal/angular/shared/form/field-simple.ts");
var __extends = (this && this.__extends) || (function () {
    var extendStatics = Object.setPrototypeOf ||
        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||
        function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };
    return function (d, b) {
        extendStatics(d, b);
        function __() { this.constructor = d; }
        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
    };
})();
var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {
    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
    if (typeof Reflect === "object" && typeof Reflect.decorate === "function") r = Reflect.decorate(decorators, target, key, desc);
    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;
    return c > 3 && r && Object.defineProperty(target, key, r), r;
};



var WorkflowStepButton = /** @class */ (function (_super) {
    __extends(WorkflowStepButton, _super);
    function WorkflowStepButton(options, injector) {
        var _this = _super.call(this, options, injector) || this;
        _this.targetStep = options['targetStep'] || null;
        return _this;
    }
    return WorkflowStepButton;
}(__WEBPACK_IMPORTED_MODULE_2__field_simple__["a" /* AnchorOrButton */]));

// For workflow buttons
var WorkflowStepButtonComponent = /** @class */ (function (_super) {
    __extends(WorkflowStepButtonComponent, _super);
    function WorkflowStepButtonComponent() {
        return _super !== null && _super.apply(this, arguments) || this;
    }
    WorkflowStepButtonComponent.prototype.gotoTargetStep = function (event) {
        return this.fieldMap._rootComp.stepTo(this.field.targetStep);
    };
    WorkflowStepButtonComponent = __decorate([
        Object(__WEBPACK_IMPORTED_MODULE_0__angular_core__["Component"])({
            selector: 'workflowstep-button',
            template: "\n  <button type=\"{{field.type}}\" [ngClass]=\"field.cssClasses\" (click)=\"gotoTargetStep($event)\" [disabled]=\"isDisabled()\">{{field.label}}</button>\n  ",
        })
    ], WorkflowStepButtonComponent);
    return WorkflowStepButtonComponent;
}(__WEBPACK_IMPORTED_MODULE_1__field_simple_component__["a" /* AnchorOrButtonComponent */]));



/***/ }),

/***/ "./redbox-portal/angular/shared/form/workspace-field.component.ts":
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "a", function() { return WorkspaceFieldComponent; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "b", function() { return WorkspaceSelectorField; });
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__angular_core__ = __webpack_require__("./node_modules/@angular/core/esm5/core.js");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1__field_base__ = __webpack_require__("./redbox-portal/angular/shared/form/field-base.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2__angular_forms__ = __webpack_require__("./node_modules/@angular/forms/esm5/forms.js");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_lodash_es__ = __webpack_require__("./node_modules/lodash-es/lodash.js");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4__workspace_service__ = __webpack_require__("./redbox-portal/angular/shared/workspace-service.ts");
var __extends = (this && this.__extends) || (function () {
    var extendStatics = Object.setPrototypeOf ||
        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||
        function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };
    return function (d, b) {
        extendStatics(d, b);
        function __() { this.constructor = d; }
        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
    };
})();
var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {
    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
    if (typeof Reflect === "object" && typeof Reflect.decorate === "function") r = Reflect.decorate(decorators, target, key, desc);
    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;
    return c > 3 && r && Object.defineProperty(target, key, r), r;
};
var __metadata = (this && this.__metadata) || function (k, v) {
    if (typeof Reflect === "object" && typeof Reflect.metadata === "function") return Reflect.metadata(k, v);
};
var __param = (this && this.__param) || function (paramIndex, decorator) {
    return function (target, key) { decorator(target, key, paramIndex); }
};





/**
 * Base component for a Workspace field.
 *
 * Author: <a href='https://github.com/moisbo' target='_blank'>moisbo</a>
 *
 */
var WorkspaceFieldComponent = /** @class */ (function () {
    /**
     * For DI'ing...
     */
    function WorkspaceFieldComponent(componentFactoryResolver, app) {
        this.componentFactoryResolver = componentFactoryResolver;
        this.app = app;
        this.disabledElements = [];
    }
    Object.defineProperty(WorkspaceFieldComponent.prototype, "isValid", {
        /**
         * If the form is valid.
         */
        get: function () {
            if (this.form && this.form.controls) {
                return this.form.controls[this.field.name].valid;
            }
            return false;
        },
        enumerable: true,
        configurable: true
    });
    /**
     *
     */
    WorkspaceFieldComponent.prototype.isDisabled = function () {
        var disabledExpression = this.field.options['disabledExpression'];
        if (disabledExpression != null) {
            var imports = this.fieldAnchor;
            var variables = {};
            variables['imports'] = this.fieldMap._rootComp;
            var compiled = __WEBPACK_IMPORTED_MODULE_3_lodash_es__["template"](disabledExpression, variables);
            var parentElement = jQuery(this.fieldElement.nativeElement.parentElement);
            if (compiled() == "true") {
                //take note of which elements where already disabled as we dont want to enable them if whole component becomes enabled again
                this.disabledElements = parentElement.find('*:disabled');
                parentElement.find('input').prop("disabled", true);
                return 'disabled';
            }
            else {
                if (jQuery(this.fieldElement.nativeElement).prop('disabled') == 'disabled') {
                    //previously disabled so lets re-enable
                    parentElement.find('input').prop("disabled", false);
                    __WEBPACK_IMPORTED_MODULE_3_lodash_es__["each"](this.disabledElements, function (disabledElement) { return disabledElement.prop("disabled", true); });
                }
                return null;
            }
        }
        return null;
    };
    /**
     * Change handler, instantiates the field component.
     */
    WorkspaceFieldComponent.prototype.ngOnChanges = function () {
        if (!this.field || !this.componentFactoryResolver) {
            return;
        }
        this.fieldAnchor.clear();
        var compFactory = this.componentFactoryResolver.resolveComponentFactory(this.field.compClass);
        var fieldCompRef = this.fieldAnchor.createComponent(compFactory, undefined, this.app['_injector']);
        fieldCompRef.instance.injector = this.app['_injector'];
        fieldCompRef.instance.field = this.field;
        fieldCompRef.instance.form = this.form;
        fieldCompRef.instance.fieldMap = this.fieldMap;
        fieldCompRef.instance.parentId = this.parentId;
        this.fieldMap[this.field.name].instance = fieldCompRef.instance;
    };
    __decorate([
        Object(__WEBPACK_IMPORTED_MODULE_0__angular_core__["Input"])(),
        __metadata("design:type", __WEBPACK_IMPORTED_MODULE_1__field_base__["a" /* FieldBase */])
    ], WorkspaceFieldComponent.prototype, "field", void 0);
    __decorate([
        Object(__WEBPACK_IMPORTED_MODULE_0__angular_core__["Input"])(),
        __metadata("design:type", __WEBPACK_IMPORTED_MODULE_2__angular_forms__["c" /* FormGroup */])
    ], WorkspaceFieldComponent.prototype, "form", void 0);
    __decorate([
        Object(__WEBPACK_IMPORTED_MODULE_0__angular_core__["Input"])(),
        __metadata("design:type", Object)
    ], WorkspaceFieldComponent.prototype, "value", void 0);
    __decorate([
        Object(__WEBPACK_IMPORTED_MODULE_0__angular_core__["Input"])(),
        __metadata("design:type", Object)
    ], WorkspaceFieldComponent.prototype, "fieldMap", void 0);
    __decorate([
        Object(__WEBPACK_IMPORTED_MODULE_0__angular_core__["ViewChild"])('field', { read: __WEBPACK_IMPORTED_MODULE_0__angular_core__["ViewContainerRef"] }),
        __metadata("design:type", __WEBPACK_IMPORTED_MODULE_0__angular_core__["ViewContainerRef"])
    ], WorkspaceFieldComponent.prototype, "fieldAnchor", void 0);
    __decorate([
        Object(__WEBPACK_IMPORTED_MODULE_0__angular_core__["Input"])(),
        __metadata("design:type", String)
    ], WorkspaceFieldComponent.prototype, "parentId", void 0);
    __decorate([
        Object(__WEBPACK_IMPORTED_MODULE_0__angular_core__["ViewChild"])('field'),
        __metadata("design:type", Object)
    ], WorkspaceFieldComponent.prototype, "fieldElement", void 0);
    WorkspaceFieldComponent = __decorate([
        Object(__WEBPACK_IMPORTED_MODULE_0__angular_core__["Component"])({
            selector: 'ws-field',
            template: '<span [attr.disabled]="isDisabled()" #field></span>'
        }),
        __param(0, Object(__WEBPACK_IMPORTED_MODULE_0__angular_core__["Inject"])(__WEBPACK_IMPORTED_MODULE_0__angular_core__["ComponentFactoryResolver"])),
        __metadata("design:paramtypes", [__WEBPACK_IMPORTED_MODULE_0__angular_core__["ComponentFactoryResolver"], __WEBPACK_IMPORTED_MODULE_0__angular_core__["ApplicationRef"]])
    ], WorkspaceFieldComponent);
    return WorkspaceFieldComponent;
}());

var WorkspaceSelectorField = /** @class */ (function (_super) {
    __extends(WorkspaceSelectorField, _super);
    function WorkspaceSelectorField(options, injector) {
        var _this = _super.call(this, options, injector) || this;
        _this.workspaceApps = [];
        _this.workspaceTypeService = _this.getFromInjector(__WEBPACK_IMPORTED_MODULE_4__workspace_service__["a" /* WorkspaceTypeService */]);
        _this.open = _this.getTranslated(options['open'], options['open']);
        _this.saveFirst = _this.getTranslated(options['saveFirst'], options['saveFirst']);
        _this.rdmp = undefined;
        // this.options = options['options'] || [];
        _this.workspaceApps = __WEBPACK_IMPORTED_MODULE_3_lodash_es__["map"](options['defaultSelection'] || [], function (option) {
            option['label'] = _this.getTranslated(option['label'], option['label']);
            option['name'] = '';
            return option;
        });
        _this.appLink = _this.workspaceTypeService.getBrand() + '/record/';
        _this.workspaceTypeService.getWorkspaceTypes().then(function (response) {
            if (response['status']) {
                //append results from database into workspaceApps
                _this.workspaceApps = __WEBPACK_IMPORTED_MODULE_3_lodash_es__["concat"](_this.workspaceApps, response['workspaceTypes']);
            }
            else {
                throw new Error('cannot get workspaces');
            }
        }).catch(function (error) {
            console.log(error);
        });
        return _this;
    }
    WorkspaceSelectorField.prototype.init = function () {
        this.rdmp = this.fieldMap._rootComp.oid || undefined;
    };
    WorkspaceSelectorField.prototype.registerEvents = function () {
        this.fieldMap._rootComp.recordCreated.subscribe(this.setOid.bind(this));
        this.fieldMap._rootComp.recordSaved.subscribe(this.setOid.bind(this));
    };
    WorkspaceSelectorField.prototype.setOid = function (o) {
        this.rdmp = o.oid;
    };
    WorkspaceSelectorField.prototype.loadWorkspaceDetails = function (value) {
        //GET me the value from the database
        if (!value) {
            this.workspaceApp = null;
        }
        else {
            this.workspaceApp = __WEBPACK_IMPORTED_MODULE_3_lodash_es__["find"](this.workspaceApps, function (w) {
                return w['name'] == value;
            });
        }
    };
    WorkspaceSelectorField.prototype.createFormModel = function () {
        var _this = this;
        if (this.controlType == 'checkbox') {
            var fgDef_1 = [];
            __WEBPACK_IMPORTED_MODULE_3_lodash_es__["map"](this.options, function (opt) {
                var hasValue = __WEBPACK_IMPORTED_MODULE_3_lodash_es__["find"](_this.value, function (val) {
                    return val == opt.value;
                });
                if (hasValue) {
                    fgDef_1.push(new __WEBPACK_IMPORTED_MODULE_2__angular_forms__["b" /* FormControl */](opt.value));
                }
            });
            // const fg = new FormArray(fgDef);
            // return fg;
            return new __WEBPACK_IMPORTED_MODULE_2__angular_forms__["a" /* FormArray */](fgDef_1);
        }
        else {
            // const model = super.createFormModel();
            // console.log(`Created form model:`);
            // console.log(model);
            // return model;
            return _super.prototype.createFormModel.call(this);
        }
    };
    return WorkspaceSelectorField;
}(__WEBPACK_IMPORTED_MODULE_1__field_base__["a" /* FieldBase */]));



/***/ }),

/***/ "./redbox-portal/angular/shared/form/workspace-selector.component.ts":
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "a", function() { return WorkspaceSelectorComponent; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "b", function() { return WorkspaceSelectorFieldComponent; });
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__angular_core__ = __webpack_require__("./node_modules/@angular/core/esm5/core.js");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1__field_simple_component__ = __webpack_require__("./redbox-portal/angular/shared/form/field-simple.component.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_lodash_es__ = __webpack_require__("./node_modules/lodash-es/lodash.js");
var __extends = (this && this.__extends) || (function () {
    var extendStatics = Object.setPrototypeOf ||
        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||
        function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };
    return function (d, b) {
        extendStatics(d, b);
        function __() { this.constructor = d; }
        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
    };
})();
var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {
    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
    if (typeof Reflect === "object" && typeof Reflect.decorate === "function") r = Reflect.decorate(decorators, target, key, desc);
    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;
    return c > 3 && r && Object.defineProperty(target, key, r), r;
};



var WorkspaceSelectorComponent = /** @class */ (function (_super) {
    __extends(WorkspaceSelectorComponent, _super);
    function WorkspaceSelectorComponent() {
        return _super !== null && _super.apply(this, arguments) || this;
    }
    WorkspaceSelectorComponent.prototype.getLabel = function (val) {
        var opt = __WEBPACK_IMPORTED_MODULE_2_lodash_es__["find"](this.field.options, function (opt) {
            return opt.value == val;
        });
        if (opt) {
            return opt.label;
        }
        else {
            return '';
        }
    };
    WorkspaceSelectorComponent.clName = 'WorkspaceSelectorComponent';
    WorkspaceSelectorComponent = __decorate([
        Object(__WEBPACK_IMPORTED_MODULE_0__angular_core__["Component"])({
            selector: 'workspace-selector-parent',
            template: ''
        })
    ], WorkspaceSelectorComponent);
    return WorkspaceSelectorComponent;
}(__WEBPACK_IMPORTED_MODULE_1__field_simple_component__["l" /* SimpleComponent */]));

var WorkspaceSelectorFieldComponent = /** @class */ (function (_super) {
    __extends(WorkspaceSelectorFieldComponent, _super);
    function WorkspaceSelectorFieldComponent() {
        return _super !== null && _super.apply(this, arguments) || this;
    }
    WorkspaceSelectorFieldComponent.prototype.ngOnInit = function () {
        this.field.init();
        this.field.registerEvents();
    };
    WorkspaceSelectorFieldComponent.prototype.saveAndOpenWorkspace = function () {
        var _this = this;
        this.fieldMap._rootComp.onSubmit().subscribe(function (response) {
            window.location.href = "" + _this.field.appLink + _this.field.workspaceApp.name + "/edit?rdmp=" + _this.field.rdmp;
        });
    };
    WorkspaceSelectorFieldComponent.clName = 'WorkspaceSelectorFieldComponent';
    WorkspaceSelectorFieldComponent = __decorate([
        Object(__WEBPACK_IMPORTED_MODULE_0__angular_core__["Component"])({
            selector: 'workspace-selector',
            template: "\n  <div [formGroup]='form' *ngIf=\"field.editMode\" [ngClass]=\"getGroupClass()\">\n  <label [attr.for]=\"field.name\">\n    {{field.label}} {{ getRequiredLabelStr()}}\n    <button type=\"button\" class=\"btn btn-default\" *ngIf=\"field.help\" (click)=\"toggleHelp()\"><span\n      class=\"glyphicon glyphicon-question-sign\" aria-hidden=\"true\"></span></button>\n  </label>\n  <br/>\n  <span id=\"{{ 'helpBlock_' + field.name }}\" class=\"help-block\" *ngIf=\"this.helpShow\" [innerHtml]=\"field.help\"></span>\n  <select [formControl]=\"getFormControl()\" [ngClass]=\"field.cssClasses\"\n          (change)=\"field.loadWorkspaceDetails($event.target.value)\">\n    <option *ngFor=\"let opt of field.workspaceApps; let i = index\"\n     [ngValue]=\"opt\" [selected]=\"i == 0\"\n     [value]=\"opt.name\">{{opt.label}}\n    </option>\n  </select>\n  <div class=\"text-danger\"\n       *ngIf=\"getFormControl().hasError('required') && getFormControl().touched && !field.validationMessages?.required\">\n    {{field.label}} is required\n  </div>\n  <div class=\"text-danger\"\n       *ngIf=\"getFormControl().hasError('required') && getFormControl().touched && field.validationMessages?.required\">\n    {{field.validationMessages.required}}\n  </div>\n  <br/><br/><br/>\n  <div class=\"row\">\n    <div *ngIf=\"field.workspaceApp\" class=\"panel panel-default\">\n      <div class=\"panel-heading\">\n        <h4 class=\"panel-title\">{{ field.workspaceApp.name | uppercase }}</h4>\n      </div>\n      <div class=\"panel-body\">\n        <div class=\"row\">\n          <div class=\"col-md-8 col-sm-8 col-xs-8 col-lg-8\">\n            <h5>{{ field.workspaceApp.subtitle }}</h5>\n            <p>{{ field.workspaceApp.description }}</p>\n            <span *ngIf=\"field.rdmp\">\n              <button (click)=\"saveAndOpenWorkspace()\"  class=\"btn btn-primary\">{{ field.open }}</button>\n            </span>\n            <span *ngIf=\"!field.rdmp\">\n              <a disabled href=\"#\" class=\"btn btn-default\">{{ field.saveFirst }}</a>\n            </span>\n          </div>\n          <div class=\"col-md-4 col-sm-4 col-xs-4 col-lg-4\">\n            <img src=\"{{ field.workspaceApp.logo }}\" alt=\"{{field.workspaceApp.name}}\">\n          </div>\n        </div>\n      </div>\n    </div>\n  </div>\n</div>\n  ",
        })
    ], WorkspaceSelectorFieldComponent);
    return WorkspaceSelectorFieldComponent;
}(WorkspaceSelectorComponent));



/***/ }),

/***/ "./redbox-portal/angular/shared/loadable.component.ts":
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "a", function() { return LoadableComponent; });
/**
 * Convenience class to wrap JQuery calls ...
 *
 * Author: <a href='https://github.com/shilob' target='_blank'>Shilo Banihit</a>
 *
 */
var LoadableComponent = /** @class */ (function () {
    function LoadableComponent() {
        this.spinnerElem = "<i class=\"fa fa-spinner fa-pulse fa-1x fa-fw\"></i>";
        this.isLoading = true;
        this.synchLoading();
    }
    LoadableComponent.prototype.initTranslator = function (translationService) {
        var _this = this;
        this.translationService = translationService;
        translationService.isReady(function (tService) {
            _this.translatorReady = true;
        });
    };
    LoadableComponent.prototype.translatorLoaded = function () {
        this.translatorReady = true;
        this.checkIfHasLoaded();
    };
    LoadableComponent.prototype.checkIfHasLoaded = function () {
        if (this.hasLoaded()) {
            this.setLoading(false);
        }
    };
    LoadableComponent.prototype.hasLoaded = function () {
        return this.isLoading && (this.translationService ? this.translatorReady : true);
    };
    LoadableComponent.prototype.setLoading = function (loading) {
        if (loading === void 0) { loading = true; }
        this.isLoading = loading;
        this.synchLoading();
    };
    LoadableComponent.prototype.synchLoading = function () {
        if (this.isLoading) {
            jQuery("#loading").removeClass("hidden");
        }
        else {
            jQuery("#loading").addClass("hidden");
        }
    };
    return LoadableComponent;
}());



/***/ }),

/***/ "./redbox-portal/angular/shared/roles-service.ts":
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "a", function() { return RolesService; });
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__angular_core__ = __webpack_require__("./node_modules/@angular/core/esm5/core.js");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1__angular_http__ = __webpack_require__("./node_modules/@angular/http/esm5/http.js");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_rxjs_add_operator_map__ = __webpack_require__("./node_modules/rxjs/_esm5/add/operator/map.js");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_rxjs_add_operator_toPromise__ = __webpack_require__("./node_modules/rxjs/_esm5/add/operator/toPromise.js");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_rxjs_add_operator_toPromise___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_3_rxjs_add_operator_toPromise__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4__shared_base_service__ = __webpack_require__("./redbox-portal/angular/shared/base-service.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5__config_service__ = __webpack_require__("./redbox-portal/angular/shared/config-service.ts");
// Copyright (c) 2017 Queensland Cyber Infrastructure Foundation (http://www.qcif.edu.au/)
//
// GNU GENERAL PUBLIC LICENSE
//    Version 2, June 1991
//
// This program is free software; you can redistribute it and/or modify
// it under the terms of the GNU General Public License as published by
// the Free Software Foundation; either version 2 of the License, or
// (at your option) any later version.
//
// This program is distributed in the hope that it will be useful,
// but WITHOUT ANY WARRANTY; without even the implied warranty of
// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
// GNU General Public License for more details.
//
// You should have received a copy of the GNU General Public License along
// with this program; if not, write to the Free Software Foundation, Inc.,
// 51 Franklin Street, Fifth Floor, Boston, MA 02110-1301 USA.
var __extends = (this && this.__extends) || (function () {
    var extendStatics = Object.setPrototypeOf ||
        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||
        function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };
    return function (d, b) {
        extendStatics(d, b);
        function __() { this.constructor = d; }
        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
    };
})();
var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {
    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
    if (typeof Reflect === "object" && typeof Reflect.decorate === "function") r = Reflect.decorate(decorators, target, key, desc);
    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;
    return c > 3 && r && Object.defineProperty(target, key, r), r;
};
var __metadata = (this && this.__metadata) || function (k, v) {
    if (typeof Reflect === "object" && typeof Reflect.metadata === "function") return Reflect.metadata(k, v);
};
var __param = (this && this.__param) || function (paramIndex, decorator) {
    return function (target, key) { decorator(target, key, paramIndex); }
};






/**
 * Role related service
 *
 * Author: <a href='https://github.com/shilob' target='_blank'>Shilo Banihit</a>
 */
var RolesService = /** @class */ (function (_super) {
    __extends(RolesService, _super);
    function RolesService(http, configService) {
        var _this = _super.call(this, http, configService) || this;
        _this.configService = configService;
        return _this;
    }
    RolesService.prototype.getBrandRoles = function () {
        var _this = this;
        return this.http.get(this.brandingAndPortalUrl + "/admin/roles/get", this.options)
            .toPromise()
            .then(function (res) { return _this.extractData(res); });
    };
    RolesService.prototype.updateUserRoles = function (userid, roleIds) {
        var _this = this;
        return this.http.post(this.brandingAndPortalUrl + "/admin/roles/user", { userid: userid, roles: roleIds }, this.options)
            .toPromise()
            .then(function (res) { return _this.extractData(res); });
    };
    RolesService = __decorate([
        Object(__WEBPACK_IMPORTED_MODULE_0__angular_core__["Injectable"])(),
        __param(0, Object(__WEBPACK_IMPORTED_MODULE_0__angular_core__["Inject"])(__WEBPACK_IMPORTED_MODULE_1__angular_http__["b" /* Http */])), __param(1, Object(__WEBPACK_IMPORTED_MODULE_0__angular_core__["Inject"])(__WEBPACK_IMPORTED_MODULE_5__config_service__["a" /* ConfigService */])),
        __metadata("design:paramtypes", [__WEBPACK_IMPORTED_MODULE_1__angular_http__["b" /* Http */], __WEBPACK_IMPORTED_MODULE_5__config_service__["a" /* ConfigService */]])
    ], RolesService);
    return RolesService;
}(__WEBPACK_IMPORTED_MODULE_4__shared_base_service__["a" /* BaseService */]));



/***/ }),

/***/ "./redbox-portal/angular/shared/shared.module.ts":
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "a", function() { return SharedModule; });
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__angular_core__ = __webpack_require__("./node_modules/@angular/core/esm5/core.js");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_angular2_markdown__ = __webpack_require__("./node_modules/angular2-markdown/index.js");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2__angular_forms__ = __webpack_require__("./node_modules/@angular/forms/esm5/forms.js");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3__angular_platform_browser__ = __webpack_require__("./node_modules/@angular/platform-browser/esm5/platform-browser.js");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4__form_records_service__ = __webpack_require__("./redbox-portal/angular/shared/form/records.service.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5__form_field_control_service__ = __webpack_require__("./redbox-portal/angular/shared/form/field-control.service.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_6__form_field_textfield_component__ = __webpack_require__("./redbox-portal/angular/shared/form/field-textfield.component.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_7__form_field_simple_component__ = __webpack_require__("./redbox-portal/angular/shared/form/field-simple.component.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_8__form_record_meta_component__ = __webpack_require__("./redbox-portal/angular/shared/form/record-meta.component.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_9__form_field_vocab_component__ = __webpack_require__("./redbox-portal/angular/shared/form/field-vocab.component.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_10__form_field_repeatable_component__ = __webpack_require__("./redbox-portal/angular/shared/form/field-repeatable.component.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_11__form_field_contributor_component__ = __webpack_require__("./redbox-portal/angular/shared/form/field-contributor.component.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_12__form_field_pdflist_component__ = __webpack_require__("./redbox-portal/angular/shared/form/field-pdflist.component.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_13__form_field_relatedobjectdata_component__ = __webpack_require__("./redbox-portal/angular/shared/form/field-relatedobjectdata.component.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_14__form_field_relatedobjectselector_component__ = __webpack_require__("./redbox-portal/angular/shared/form/field-relatedobjectselector.component.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_15__form_field_datalocation_component__ = __webpack_require__("./redbox-portal/angular/shared/form/field-datalocation.component.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_16__form_field_publishdatalocationselector_component__ = __webpack_require__("./redbox-portal/angular/shared/form/field-publishdatalocationselector.component.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_17__form_field_andsvocab_component__ = __webpack_require__("./redbox-portal/angular/shared/form/field-andsvocab.component.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_18__form_field_map_component__ = __webpack_require__("./redbox-portal/angular/shared/form/field-map.component.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_19__form_workflow_button_component__ = __webpack_require__("./redbox-portal/angular/shared/form/workflow-button.component.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_20__form_action_button_component__ = __webpack_require__("./redbox-portal/angular/shared/form/action-button.component.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_21__config_service__ = __webpack_require__("./redbox-portal/angular/shared/config-service.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_22__translation_service__ = __webpack_require__("./redbox-portal/angular/shared/translation-service.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_23_ng2_datetime_ng2_datetime__ = __webpack_require__("./node_modules/ng2-datetime/ng2-datetime.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_24_ng2_completer__ = __webpack_require__("./node_modules/ng2-completer/index.js");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_25_ngx_i18next__ = __webpack_require__("./node_modules/ngx-i18next/index.js");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_25_ngx_i18next___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_25_ngx_i18next__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_26__asymmetrik_ngx_leaflet__ = __webpack_require__("./node_modules/@asymmetrik/ngx-leaflet/dist/index.js");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_27__asymmetrik_ngx_leaflet_draw__ = __webpack_require__("./node_modules/@asymmetrik/ngx-leaflet-draw/dist/index.js");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_28__form_dmp_field_component__ = __webpack_require__("./redbox-portal/angular/shared/form/dmp-field.component.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_29__user_service_simple__ = __webpack_require__("./redbox-portal/angular/shared/user.service-simple.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_30__dashboard_service__ = __webpack_require__("./redbox-portal/angular/shared/dashboard-service.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_31__ands_service__ = __webpack_require__("./redbox-portal/angular/shared/ands-service.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_32__StringTemplatePipe__ = __webpack_require__("./redbox-portal/angular/shared/StringTemplatePipe.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_33__roles_service__ = __webpack_require__("./redbox-portal/angular/shared/roles-service.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_34__util_service__ = __webpack_require__("./redbox-portal/angular/shared/util-service.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_35__email_service__ = __webpack_require__("./redbox-portal/angular/shared/email-service.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_36__form_field_group_component__ = __webpack_require__("./redbox-portal/angular/shared/form/field-group.component.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_37__form_workspace_selector_component__ = __webpack_require__("./redbox-portal/angular/shared/form/workspace-selector.component.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_38__workspace_service__ = __webpack_require__("./redbox-portal/angular/shared/workspace-service.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_39__form_workspace_field_component__ = __webpack_require__("./redbox-portal/angular/shared/form/workspace-field.component.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_40__form_field_control_meta_service__ = __webpack_require__("./redbox-portal/angular/shared/form/field-control-meta.service.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_41_angular_tree_component__ = __webpack_require__("./node_modules/angular-tree-component/dist/angular-tree-component.js");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_42__form_field_asynch_component__ = __webpack_require__("./redbox-portal/angular/shared/form/field-asynch.component.ts");
var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {
    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
    if (typeof Reflect === "object" && typeof Reflect.decorate === "function") r = Reflect.decorate(decorators, target, key, desc);
    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;
    return c > 3 && r && Object.defineProperty(target, key, r), r;
};












































var SharedModule = /** @class */ (function () {
    function SharedModule() {
    }
    SharedModule = __decorate([
        Object(__WEBPACK_IMPORTED_MODULE_0__angular_core__["NgModule"])({
            imports: [__WEBPACK_IMPORTED_MODULE_3__angular_platform_browser__["a" /* BrowserModule */], __WEBPACK_IMPORTED_MODULE_2__angular_forms__["d" /* FormsModule */], __WEBPACK_IMPORTED_MODULE_2__angular_forms__["h" /* ReactiveFormsModule */], __WEBPACK_IMPORTED_MODULE_23_ng2_datetime_ng2_datetime__["a" /* NKDatetimeModule */], __WEBPACK_IMPORTED_MODULE_24_ng2_completer__["b" /* Ng2CompleterModule */], __WEBPACK_IMPORTED_MODULE_25_ngx_i18next__["TranslateI18NextModule"], __WEBPACK_IMPORTED_MODULE_26__asymmetrik_ngx_leaflet__["c" /* LeafletModule */].forRoot(), __WEBPACK_IMPORTED_MODULE_27__asymmetrik_ngx_leaflet_draw__["a" /* LeafletDrawModule */].forRoot(), __WEBPACK_IMPORTED_MODULE_1_angular2_markdown__["a" /* MarkdownModule */].forRoot(), __WEBPACK_IMPORTED_MODULE_41_angular_tree_component__["b" /* TreeModule */]],
            exports: [__WEBPACK_IMPORTED_MODULE_23_ng2_datetime_ng2_datetime__["a" /* NKDatetimeModule */], __WEBPACK_IMPORTED_MODULE_24_ng2_completer__["b" /* Ng2CompleterModule */], __WEBPACK_IMPORTED_MODULE_25_ngx_i18next__["TranslateI18NextModule"], __WEBPACK_IMPORTED_MODULE_28__form_dmp_field_component__["a" /* DmpFieldComponent */], __WEBPACK_IMPORTED_MODULE_6__form_field_textfield_component__["g" /* TextFieldComponent */], __WEBPACK_IMPORTED_MODULE_7__form_field_simple_component__["e" /* DropdownFieldComponent */], __WEBPACK_IMPORTED_MODULE_7__form_field_simple_component__["o" /* TabOrAccordionContainerComponent */], __WEBPACK_IMPORTED_MODULE_7__form_field_simple_component__["b" /* ButtonBarContainerComponent */], __WEBPACK_IMPORTED_MODULE_7__form_field_simple_component__["p" /* TextBlockComponent */], __WEBPACK_IMPORTED_MODULE_6__form_field_textfield_component__["b" /* MarkdownTextAreaComponent */], __WEBPACK_IMPORTED_MODULE_6__form_field_textfield_component__["e" /* TextAreaComponent */], __WEBPACK_IMPORTED_MODULE_7__form_field_simple_component__["d" /* DateTimeComponent */], __WEBPACK_IMPORTED_MODULE_7__form_field_simple_component__["a" /* AnchorOrButtonComponent */], __WEBPACK_IMPORTED_MODULE_9__form_field_vocab_component__["b" /* VocabFieldComponent */], __WEBPACK_IMPORTED_MODULE_10__form_field_repeatable_component__["g" /* RepeatableVocabComponent */], __WEBPACK_IMPORTED_MODULE_11__form_field_contributor_component__["a" /* ContributorComponent */], __WEBPACK_IMPORTED_MODULE_10__form_field_repeatable_component__["e" /* RepeatableContributorComponent */], __WEBPACK_IMPORTED_MODULE_7__form_field_simple_component__["g" /* HtmlRawComponent */], __WEBPACK_IMPORTED_MODULE_7__form_field_simple_component__["f" /* HiddenValueComponent */], __WEBPACK_IMPORTED_MODULE_19__form_workflow_button_component__["b" /* WorkflowStepButtonComponent */], __WEBPACK_IMPORTED_MODULE_20__form_action_button_component__["b" /* ActionButtonComponent */], __WEBPACK_IMPORTED_MODULE_7__form_field_simple_component__["h" /* LinkValueComponent */], __WEBPACK_IMPORTED_MODULE_7__form_field_simple_component__["k" /* SelectionFieldComponent */], __WEBPACK_IMPORTED_MODULE_6__form_field_textfield_component__["c" /* RepeatableTextfieldComponent */], __WEBPACK_IMPORTED_MODULE_32__StringTemplatePipe__["a" /* StringTemplatePipe */], __WEBPACK_IMPORTED_MODULE_36__form_field_group_component__["a" /* GenericGroupComponent */], __WEBPACK_IMPORTED_MODULE_36__form_field_group_component__["b" /* RepeatableGroupComponent */], __WEBPACK_IMPORTED_MODULE_18__form_field_map_component__["a" /* MapComponent */], __WEBPACK_IMPORTED_MODULE_7__form_field_simple_component__["i" /* ParameterRetrieverComponent */], __WEBPACK_IMPORTED_MODULE_8__form_record_meta_component__["a" /* RecordMetadataRetrieverComponent */], __WEBPACK_IMPORTED_MODULE_14__form_field_relatedobjectselector_component__["a" /* RelatedObjectSelectorComponent */], __WEBPACK_IMPORTED_MODULE_15__form_field_datalocation_component__["a" /* DataLocationComponent */], __WEBPACK_IMPORTED_MODULE_16__form_field_publishdatalocationselector_component__["a" /* PublishDataLocationSelectorComponent */], __WEBPACK_IMPORTED_MODULE_37__form_workspace_selector_component__["b" /* WorkspaceSelectorFieldComponent */], __WEBPACK_IMPORTED_MODULE_7__form_field_simple_component__["n" /* TabNavButtonComponent */], __WEBPACK_IMPORTED_MODULE_7__form_field_simple_component__["m" /* SpacerComponent */], __WEBPACK_IMPORTED_MODULE_39__form_workspace_field_component__["a" /* WorkspaceFieldComponent */], __WEBPACK_IMPORTED_MODULE_37__form_workspace_selector_component__["a" /* WorkspaceSelectorComponent */], __WEBPACK_IMPORTED_MODULE_17__form_field_andsvocab_component__["a" /* ANDSVocabComponent */], __WEBPACK_IMPORTED_MODULE_12__form_field_pdflist_component__["a" /* PDFListComponent */], __WEBPACK_IMPORTED_MODULE_41_angular_tree_component__["b" /* TreeModule */], __WEBPACK_IMPORTED_MODULE_42__form_field_asynch_component__["a" /* AsynchComponent */], __WEBPACK_IMPORTED_MODULE_7__form_field_simple_component__["q" /* ToggleComponent */]],
            declarations: [__WEBPACK_IMPORTED_MODULE_28__form_dmp_field_component__["a" /* DmpFieldComponent */], __WEBPACK_IMPORTED_MODULE_6__form_field_textfield_component__["g" /* TextFieldComponent */], __WEBPACK_IMPORTED_MODULE_7__form_field_simple_component__["e" /* DropdownFieldComponent */], __WEBPACK_IMPORTED_MODULE_7__form_field_simple_component__["o" /* TabOrAccordionContainerComponent */], __WEBPACK_IMPORTED_MODULE_7__form_field_simple_component__["b" /* ButtonBarContainerComponent */], __WEBPACK_IMPORTED_MODULE_7__form_field_simple_component__["p" /* TextBlockComponent */], __WEBPACK_IMPORTED_MODULE_6__form_field_textfield_component__["b" /* MarkdownTextAreaComponent */], __WEBPACK_IMPORTED_MODULE_6__form_field_textfield_component__["e" /* TextAreaComponent */], __WEBPACK_IMPORTED_MODULE_7__form_field_simple_component__["d" /* DateTimeComponent */], __WEBPACK_IMPORTED_MODULE_7__form_field_simple_component__["a" /* AnchorOrButtonComponent */], __WEBPACK_IMPORTED_MODULE_7__form_field_simple_component__["j" /* SaveButtonComponent */], __WEBPACK_IMPORTED_MODULE_7__form_field_simple_component__["c" /* CancelButtonComponent */], __WEBPACK_IMPORTED_MODULE_9__form_field_vocab_component__["b" /* VocabFieldComponent */], __WEBPACK_IMPORTED_MODULE_10__form_field_repeatable_component__["g" /* RepeatableVocabComponent */], __WEBPACK_IMPORTED_MODULE_11__form_field_contributor_component__["a" /* ContributorComponent */], __WEBPACK_IMPORTED_MODULE_10__form_field_repeatable_component__["e" /* RepeatableContributorComponent */], __WEBPACK_IMPORTED_MODULE_7__form_field_simple_component__["g" /* HtmlRawComponent */], __WEBPACK_IMPORTED_MODULE_7__form_field_simple_component__["f" /* HiddenValueComponent */], __WEBPACK_IMPORTED_MODULE_19__form_workflow_button_component__["b" /* WorkflowStepButtonComponent */], __WEBPACK_IMPORTED_MODULE_20__form_action_button_component__["b" /* ActionButtonComponent */], __WEBPACK_IMPORTED_MODULE_7__form_field_simple_component__["h" /* LinkValueComponent */], __WEBPACK_IMPORTED_MODULE_7__form_field_simple_component__["k" /* SelectionFieldComponent */], __WEBPACK_IMPORTED_MODULE_6__form_field_textfield_component__["c" /* RepeatableTextfieldComponent */], __WEBPACK_IMPORTED_MODULE_13__form_field_relatedobjectdata_component__["a" /* RelatedObjectDataComponent */], __WEBPACK_IMPORTED_MODULE_32__StringTemplatePipe__["a" /* StringTemplatePipe */], __WEBPACK_IMPORTED_MODULE_36__form_field_group_component__["a" /* GenericGroupComponent */], __WEBPACK_IMPORTED_MODULE_36__form_field_group_component__["b" /* RepeatableGroupComponent */], __WEBPACK_IMPORTED_MODULE_18__form_field_map_component__["a" /* MapComponent */], __WEBPACK_IMPORTED_MODULE_7__form_field_simple_component__["i" /* ParameterRetrieverComponent */], __WEBPACK_IMPORTED_MODULE_8__form_record_meta_component__["a" /* RecordMetadataRetrieverComponent */], __WEBPACK_IMPORTED_MODULE_14__form_field_relatedobjectselector_component__["a" /* RelatedObjectSelectorComponent */], __WEBPACK_IMPORTED_MODULE_15__form_field_datalocation_component__["a" /* DataLocationComponent */], __WEBPACK_IMPORTED_MODULE_16__form_field_publishdatalocationselector_component__["a" /* PublishDataLocationSelectorComponent */], __WEBPACK_IMPORTED_MODULE_37__form_workspace_selector_component__["b" /* WorkspaceSelectorFieldComponent */], __WEBPACK_IMPORTED_MODULE_7__form_field_simple_component__["n" /* TabNavButtonComponent */], __WEBPACK_IMPORTED_MODULE_7__form_field_simple_component__["m" /* SpacerComponent */], __WEBPACK_IMPORTED_MODULE_39__form_workspace_field_component__["a" /* WorkspaceFieldComponent */], __WEBPACK_IMPORTED_MODULE_37__form_workspace_selector_component__["a" /* WorkspaceSelectorComponent */], __WEBPACK_IMPORTED_MODULE_17__form_field_andsvocab_component__["a" /* ANDSVocabComponent */], __WEBPACK_IMPORTED_MODULE_12__form_field_pdflist_component__["a" /* PDFListComponent */], __WEBPACK_IMPORTED_MODULE_42__form_field_asynch_component__["a" /* AsynchComponent */], __WEBPACK_IMPORTED_MODULE_7__form_field_simple_component__["q" /* ToggleComponent */]],
            providers: [__WEBPACK_IMPORTED_MODULE_5__form_field_control_service__["a" /* FieldControlService */], __WEBPACK_IMPORTED_MODULE_4__form_records_service__["a" /* RecordsService */], __WEBPACK_IMPORTED_MODULE_9__form_field_vocab_component__["c" /* VocabFieldLookupService */], __WEBPACK_IMPORTED_MODULE_21__config_service__["a" /* ConfigService */], __WEBPACK_IMPORTED_MODULE_22__translation_service__["a" /* TranslationService */], __WEBPACK_IMPORTED_MODULE_29__user_service_simple__["a" /* UserSimpleService */], __WEBPACK_IMPORTED_MODULE_30__dashboard_service__["a" /* DashboardService */], __WEBPACK_IMPORTED_MODULE_33__roles_service__["a" /* RolesService */], __WEBPACK_IMPORTED_MODULE_35__email_service__["a" /* EmailNotificationService */], __WEBPACK_IMPORTED_MODULE_34__util_service__["a" /* UtilityService */], __WEBPACK_IMPORTED_MODULE_38__workspace_service__["a" /* WorkspaceTypeService */], __WEBPACK_IMPORTED_MODULE_40__form_field_control_meta_service__["a" /* FieldControlMetaService */], __WEBPACK_IMPORTED_MODULE_31__ands_service__["a" /* ANDSService */]],
            bootstrap: [],
            entryComponents: [__WEBPACK_IMPORTED_MODULE_28__form_dmp_field_component__["a" /* DmpFieldComponent */], __WEBPACK_IMPORTED_MODULE_6__form_field_textfield_component__["g" /* TextFieldComponent */], __WEBPACK_IMPORTED_MODULE_7__form_field_simple_component__["e" /* DropdownFieldComponent */], __WEBPACK_IMPORTED_MODULE_7__form_field_simple_component__["o" /* TabOrAccordionContainerComponent */], __WEBPACK_IMPORTED_MODULE_7__form_field_simple_component__["b" /* ButtonBarContainerComponent */], __WEBPACK_IMPORTED_MODULE_7__form_field_simple_component__["p" /* TextBlockComponent */], __WEBPACK_IMPORTED_MODULE_6__form_field_textfield_component__["b" /* MarkdownTextAreaComponent */], __WEBPACK_IMPORTED_MODULE_6__form_field_textfield_component__["e" /* TextAreaComponent */], __WEBPACK_IMPORTED_MODULE_7__form_field_simple_component__["d" /* DateTimeComponent */], __WEBPACK_IMPORTED_MODULE_7__form_field_simple_component__["a" /* AnchorOrButtonComponent */], __WEBPACK_IMPORTED_MODULE_7__form_field_simple_component__["j" /* SaveButtonComponent */], __WEBPACK_IMPORTED_MODULE_7__form_field_simple_component__["c" /* CancelButtonComponent */], __WEBPACK_IMPORTED_MODULE_9__form_field_vocab_component__["b" /* VocabFieldComponent */], __WEBPACK_IMPORTED_MODULE_10__form_field_repeatable_component__["g" /* RepeatableVocabComponent */], __WEBPACK_IMPORTED_MODULE_11__form_field_contributor_component__["a" /* ContributorComponent */], __WEBPACK_IMPORTED_MODULE_10__form_field_repeatable_component__["e" /* RepeatableContributorComponent */], __WEBPACK_IMPORTED_MODULE_7__form_field_simple_component__["g" /* HtmlRawComponent */], __WEBPACK_IMPORTED_MODULE_7__form_field_simple_component__["f" /* HiddenValueComponent */], __WEBPACK_IMPORTED_MODULE_19__form_workflow_button_component__["b" /* WorkflowStepButtonComponent */], __WEBPACK_IMPORTED_MODULE_20__form_action_button_component__["b" /* ActionButtonComponent */], __WEBPACK_IMPORTED_MODULE_7__form_field_simple_component__["h" /* LinkValueComponent */], __WEBPACK_IMPORTED_MODULE_7__form_field_simple_component__["k" /* SelectionFieldComponent */], __WEBPACK_IMPORTED_MODULE_6__form_field_textfield_component__["c" /* RepeatableTextfieldComponent */], __WEBPACK_IMPORTED_MODULE_13__form_field_relatedobjectdata_component__["a" /* RelatedObjectDataComponent */], __WEBPACK_IMPORTED_MODULE_36__form_field_group_component__["a" /* GenericGroupComponent */], __WEBPACK_IMPORTED_MODULE_36__form_field_group_component__["b" /* RepeatableGroupComponent */], __WEBPACK_IMPORTED_MODULE_18__form_field_map_component__["a" /* MapComponent */], __WEBPACK_IMPORTED_MODULE_7__form_field_simple_component__["i" /* ParameterRetrieverComponent */], __WEBPACK_IMPORTED_MODULE_8__form_record_meta_component__["a" /* RecordMetadataRetrieverComponent */], __WEBPACK_IMPORTED_MODULE_14__form_field_relatedobjectselector_component__["a" /* RelatedObjectSelectorComponent */], __WEBPACK_IMPORTED_MODULE_15__form_field_datalocation_component__["a" /* DataLocationComponent */], __WEBPACK_IMPORTED_MODULE_16__form_field_publishdatalocationselector_component__["a" /* PublishDataLocationSelectorComponent */], __WEBPACK_IMPORTED_MODULE_37__form_workspace_selector_component__["b" /* WorkspaceSelectorFieldComponent */], __WEBPACK_IMPORTED_MODULE_7__form_field_simple_component__["n" /* TabNavButtonComponent */], __WEBPACK_IMPORTED_MODULE_7__form_field_simple_component__["m" /* SpacerComponent */], __WEBPACK_IMPORTED_MODULE_39__form_workspace_field_component__["a" /* WorkspaceFieldComponent */], __WEBPACK_IMPORTED_MODULE_37__form_workspace_selector_component__["a" /* WorkspaceSelectorComponent */], __WEBPACK_IMPORTED_MODULE_17__form_field_andsvocab_component__["a" /* ANDSVocabComponent */], __WEBPACK_IMPORTED_MODULE_12__form_field_pdflist_component__["a" /* PDFListComponent */], __WEBPACK_IMPORTED_MODULE_42__form_field_asynch_component__["a" /* AsynchComponent */], __WEBPACK_IMPORTED_MODULE_7__form_field_simple_component__["q" /* ToggleComponent */]]
        })
    ], SharedModule);
    return SharedModule;
}());



/***/ }),

/***/ "./redbox-portal/angular/shared/translation-service.ts":
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "a", function() { return TranslationService; });
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__angular_core__ = __webpack_require__("./node_modules/@angular/core/esm5/core.js");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_ngx_i18next__ = __webpack_require__("./node_modules/ngx-i18next/index.js");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_ngx_i18next___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_1_ngx_i18next__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_rxjs_Subject__ = __webpack_require__("./node_modules/rxjs/_esm5/Subject.js");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3__config_service__ = __webpack_require__("./redbox-portal/angular/shared/config-service.ts");
// Copyright (c) 2017 Queensland Cyber Infrastructure Foundation (http://www.qcif.edu.au/)
//
// GNU GENERAL PUBLIC LICENSE
//    Version 2, June 1991
//
// This program is free software; you can redistribute it and/or modify
// it under the terms of the GNU General Public License as published by
// the Free Software Foundation; either version 2 of the License, or
// (at your option) any later version.
//
// This program is distributed in the hope that it will be useful,
// but WITHOUT ANY WARRANTY; without even the implied warranty of
// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
// GNU General Public License for more details.
//
// You should have received a copy of the GNU General Public License along
// with this program; if not, write to the Free Software Foundation, Inc.,
// 51 Franklin Street, Fifth Floor, Boston, MA 02110-1301 USA.
var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {
    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
    if (typeof Reflect === "object" && typeof Reflect.decorate === "function") r = Reflect.decorate(decorators, target, key, desc);
    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;
    return c > 3 && r && Object.defineProperty(target, key, r), r;
};
var __metadata = (this && this.__metadata) || function (k, v) {
    if (typeof Reflect === "object" && typeof Reflect.metadata === "function") return Reflect.metadata(k, v);
};




/**
 * Translation service...
 *
 * Author: <a href='https://github.com/shilob' target='_blank'>Shilo Banihit</a>
 *
 */
var TranslationService = /** @class */ (function () {
    function TranslationService(translateI18Next, configService) {
        this.translateI18Next = translateI18Next;
        this.configService = configService;
        this.subjects = {};
        this.initTranslator();
    }
    TranslationService.prototype.initTranslator = function () {
        var _this = this;
        this.subjects['init'] = new __WEBPACK_IMPORTED_MODULE_2_rxjs_Subject__["a" /* Subject */]();
        var ts = new Date().getTime();
        this.translateI18Next.init({
            debug: true,
            returnNull: false,
            returnEmptyString: true,
            // mapping: {"specific_backend_message": "message_for_translate"},     // optional
            // browserLanguageDetector: injectableCustomLanguageDetectorService,   // optional - the specific application language detector (allows you to return the language of the user.
            //                                                                     //            If it is absent, the service uses default "angular2 locale detector" behaviour using LOCALE_ID.
            // // supportedLanguages: ['en', 'pt'],                                //            Therefore you can pass the optional supportedLanguages parameter which indicates your supported languages.
            //                                                                     //            For example, LOCALE_ID = 'en-AU' or 'en-US' or 'en', you can pass only ['en'] -> locales/en/translation.json
            //                                                                     //                         LOCALE_ID = 'pt-BR' or 'pt', you can pass only ['pt'] -> locales/pt/translation.json
            // backend: injectableBackendConfigFactory                             // optional - allows to change "loadPath" i18next parameter
            lng: 'en',
            fallbackLng: 'en',
            backend: { loadPath: "/locales/{{lng}}/{{ns}}.json?ts=" + ts }
        }).then(function () {
            console.log("Translator loaded...");
            _this.translatorReady = true;
            _this.translatorLoaded();
        });
    };
    TranslationService.prototype.translatorLoaded = function () {
        if (this.translatorReady) {
            this.subjects['init'].next(this);
        }
    };
    TranslationService.prototype.isReady = function (handler) {
        var subs = this.subjects['init'].subscribe(handler);
        this.translatorLoaded();
        return subs;
    };
    TranslationService.prototype.t = function (key) {
        return this.translateI18Next.translate(key);
    };
    TranslationService = __decorate([
        Object(__WEBPACK_IMPORTED_MODULE_0__angular_core__["Injectable"])(),
        __metadata("design:paramtypes", [__WEBPACK_IMPORTED_MODULE_1_ngx_i18next__["TranslateI18Next"], __WEBPACK_IMPORTED_MODULE_3__config_service__["a" /* ConfigService */]])
    ], TranslationService);
    return TranslationService;
}());



/***/ }),

/***/ "./redbox-portal/angular/shared/user.service-simple.ts":
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "a", function() { return UserSimpleService; });
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__angular_core__ = __webpack_require__("./node_modules/@angular/core/esm5/core.js");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1__angular_http__ = __webpack_require__("./node_modules/@angular/http/esm5/http.js");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_rxjs_add_operator_map__ = __webpack_require__("./node_modules/rxjs/_esm5/add/operator/map.js");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_rxjs_add_operator_toPromise__ = __webpack_require__("./node_modules/rxjs/_esm5/add/operator/toPromise.js");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_rxjs_add_operator_toPromise___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_3_rxjs_add_operator_toPromise__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4__shared_base_service__ = __webpack_require__("./redbox-portal/angular/shared/base-service.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5__shared_config_service__ = __webpack_require__("./redbox-portal/angular/shared/config-service.ts");
// Copyright (c) 2017 Queensland Cyber Infrastructure Foundation (http://www.qcif.edu.au/)
//
// GNU GENERAL PUBLIC LICENSE
//    Version 2, June 1991
//
// This program is free software; you can redistribute it and/or modify
// it under the terms of the GNU General Public License as published by
// the Free Software Foundation; either version 2 of the License, or
// (at your option) any later version.
//
// This program is distributed in the hope that it will be useful,
// but WITHOUT ANY WARRANTY; without even the implied warranty of
// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
// GNU General Public License for more details.
//
// You should have received a copy of the GNU General Public License along
// with this program; if not, write to the Free Software Foundation, Inc.,
// 51 Franklin Street, Fifth Floor, Boston, MA 02110-1301 USA.
var __extends = (this && this.__extends) || (function () {
    var extendStatics = Object.setPrototypeOf ||
        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||
        function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };
    return function (d, b) {
        extendStatics(d, b);
        function __() { this.constructor = d; }
        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
    };
})();
var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {
    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
    if (typeof Reflect === "object" && typeof Reflect.decorate === "function") r = Reflect.decorate(decorators, target, key, desc);
    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;
    return c > 3 && r && Object.defineProperty(target, key, r), r;
};
var __metadata = (this && this.__metadata) || function (k, v) {
    if (typeof Reflect === "object" && typeof Reflect.metadata === "function") return Reflect.metadata(k, v);
};
var __param = (this && this.__param) || function (paramIndex, decorator) {
    return function (target, key) { decorator(target, key, paramIndex); }
};






/**
 * User related service...
 *
 * Author: <a href='https://github.com/shilob' target='_blank'>Shilo Banihit</a>
 *
 */
var UserSimpleService = /** @class */ (function (_super) {
    __extends(UserSimpleService, _super);
    function UserSimpleService(http, configService) {
        var _this = _super.call(this, http, configService) || this;
        _this.configService = configService;
        return _this;
    }
    UserSimpleService.prototype.getInfo = function () {
        var _this = this;
        return this.http.get(this.baseUrl + "/user/info")
            .toPromise()
            .then(function (res) { return _this.extractData(res, 'user'); });
    };
    UserSimpleService.prototype.loginLocal = function (username, password) {
        console.log("Loggin in locally using brand: " + this.config.branding + ", portal: " + this.config.portal);
        return this.http.post(this.baseUrl + "/user/login_local", { username: username, password: password, branding: this.config.branding, portal: this.config.portal }, this.getOptionsClient())
            .toPromise()
            .then(this.extractData);
    };
    UserSimpleService.prototype.getUsers = function () {
        var _this = this;
        return this.http.get(this.brandingAndPortalUrl + "/admin/users/get", this.options)
            .toPromise()
            .then(function (res) { return _this.extractData(res); });
    };
    UserSimpleService.prototype.updateUserDetails = function (userid, details) {
        var _this = this;
        return this.http.post(this.brandingAndPortalUrl + "/admin/users/update", { userid: userid, details: details }, this.options)
            .toPromise()
            .then(function (res) { return _this.extractData(res); });
    };
    UserSimpleService.prototype.addLocalUser = function (username, details) {
        var _this = this;
        return this.http.post(this.brandingAndPortalUrl + "/admin/users/newUser", { username: username, details: details }, this.options)
            .toPromise()
            .then(function (res) { return _this.extractData(res); });
    };
    UserSimpleService.prototype.genKey = function (userid) {
        var _this = this;
        return this.http.post(this.brandingAndPortalUrl + "/admin/users/genKey", { userid: userid }, this.options)
            .toPromise()
            .then(function (res) { return _this.extractData(res); });
    };
    UserSimpleService.prototype.revokeKey = function (userid) {
        var _this = this;
        return this.http.post(this.brandingAndPortalUrl + "/admin/users/revokeKey", { userid: userid }, this.options)
            .toPromise()
            .then(function (res) { return _this.extractData(res); });
    };
    UserSimpleService.prototype.updateUserProfile = function (details) {
        var _this = this;
        return this.http.post(this.brandingAndPortalUrl + "/user/update", { details: details }, this.options)
            .toPromise()
            .then(function (res) { return _this.extractData(res); });
    };
    UserSimpleService.prototype.genUserKey = function () {
        var _this = this;
        return this.http.post(this.brandingAndPortalUrl + "/user/genKey", {}, this.options)
            .toPromise()
            .then(function (res) { return _this.extractData(res); });
    };
    UserSimpleService.prototype.revokeUserKey = function () {
        var _this = this;
        return this.http.post(this.brandingAndPortalUrl + "/user/revokeKey", {}, this.options)
            .toPromise()
            .then(function (res) { return _this.extractData(res); });
    };
    UserSimpleService = __decorate([
        Object(__WEBPACK_IMPORTED_MODULE_0__angular_core__["Injectable"])(),
        __param(0, Object(__WEBPACK_IMPORTED_MODULE_0__angular_core__["Inject"])(__WEBPACK_IMPORTED_MODULE_1__angular_http__["b" /* Http */])), __param(1, Object(__WEBPACK_IMPORTED_MODULE_0__angular_core__["Inject"])(__WEBPACK_IMPORTED_MODULE_5__shared_config_service__["a" /* ConfigService */])),
        __metadata("design:paramtypes", [__WEBPACK_IMPORTED_MODULE_1__angular_http__["b" /* Http */], __WEBPACK_IMPORTED_MODULE_5__shared_config_service__["a" /* ConfigService */]])
    ], UserSimpleService);
    return UserSimpleService;
}(__WEBPACK_IMPORTED_MODULE_4__shared_base_service__["a" /* BaseService */]));



/***/ }),

/***/ "./redbox-portal/angular/shared/util-service.ts":
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "a", function() { return UtilityService; });
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__angular_core__ = __webpack_require__("./node_modules/@angular/core/esm5/core.js");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_lodash_es__ = __webpack_require__("./node_modules/lodash-es/lodash.js");
// Copyright (c) 2017 Queensland Cyber Infrastructure Foundation (http://www.qcif.edu.au/)
//
// GNU GENERAL PUBLIC LICENSE
//    Version 2, June 1991
//
// This program is free software; you can redistribute it and/or modify
// it under the terms of the GNU General Public License as published by
// the Free Software Foundation; either version 2 of the License, or
// (at your option) any later version.
//
// This program is distributed in the hope that it will be useful,
// but WITHOUT ANY WARRANTY; without even the implied warranty of
// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
// GNU General Public License for more details.
//
// You should have received a copy of the GNU General Public License along
// with this program; if not, write to the Free Software Foundation, Inc.,
// 51 Franklin Street, Fifth Floor, Boston, MA 02110-1301 USA.
var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {
    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
    if (typeof Reflect === "object" && typeof Reflect.decorate === "function") r = Reflect.decorate(decorators, target, key, desc);
    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;
    return c > 3 && r && Object.defineProperty(target, key, r), r;
};


/**
 * Utility service...
 *
 * Author: <a href='https://github.com/shilob' target='_blank'>Shilo Banihit</a>
 *
 */
var UtilityService = /** @class */ (function () {
    function UtilityService() {
    }
    /**
     * returns concatenated string
     *
     * Author: <a href='https://github.com/shilob' target='_blank'>Shilo Banihit</a>
     * @param  {any} config
     * @return {string}
     */
    UtilityService.prototype.concatenate = function (data, config) {
        var result = '';
        __WEBPACK_IMPORTED_MODULE_1_lodash_es__["each"](config.fields, function (f) {
            if (__WEBPACK_IMPORTED_MODULE_1_lodash_es__["isArray"](data)) {
                result = [];
                var itemResult_1 = '';
                __WEBPACK_IMPORTED_MODULE_1_lodash_es__["each"](data, function (d) {
                    var fldData = __WEBPACK_IMPORTED_MODULE_1_lodash_es__["get"](d, f);
                    // checking if field has data, otherwise will be skipping concat
                    if (fldData) {
                        itemResult_1 = "" + itemResult_1 + (__WEBPACK_IMPORTED_MODULE_1_lodash_es__["isEmpty"](itemResult_1) ? '' : config.delim) + fldData;
                    }
                });
                result.push(itemResult_1);
            }
            else {
                var fldData = __WEBPACK_IMPORTED_MODULE_1_lodash_es__["get"](data, f);
                if (fldData) {
                    result = "" + result + (__WEBPACK_IMPORTED_MODULE_1_lodash_es__["isEmpty"](result) ? '' : config.delim) + fldData;
                }
            }
        });
        return result;
    };
    /**
     * returns a property from the provided object.
     *
     * Author: <a href='https://github.com/andrewbrazzatti' target='_blank'>Andrew Brazzatti</a>
     * @param  {any} config
     * @return {string}
     */
    UtilityService.prototype.getPropertyFromObject = function (data, config) {
        var fieldPath = config.field;
        return __WEBPACK_IMPORTED_MODULE_1_lodash_es__["get"](data, fieldPath);
    };
    /**
     * returns value based on mapping
     *
     * Author: <a href='https://github.com/shilob' target='_blank'>Shilo Banihit</a>
     * @param {any} data
     * @param  {any} config - dict of field: field path of data, mapping - array of dict with 'key', the value and the actual mapping value 'val', 'default' - the value if there's no match
     * @return {any}
     */
    UtilityService.prototype.getPropertyFromObjectMapping = function (data, config) {
        var fieldPath = config.field;
        var val = __WEBPACK_IMPORTED_MODULE_1_lodash_es__["isUndefined"](fieldPath) ? data : __WEBPACK_IMPORTED_MODULE_1_lodash_es__["get"](data, fieldPath);
        var foundMapping = __WEBPACK_IMPORTED_MODULE_1_lodash_es__["find"](config.mapping, function (mapEntry) {
            return "" + mapEntry.key == "" + val;
        });
        return foundMapping ? foundMapping.value : config.default;
    };
    /**
     * returns true if value is not null, undefined, empty
     *
     * Author: <a href='https://github.com/shilob' target='_blank'>Shilo Banihit</a>
     * @param {any} data
     * @param  {any} config
     * @return {string}
     */
    UtilityService.prototype.hasValue = function (data, config) {
        if (config === void 0) { config = null; }
        return !__WEBPACK_IMPORTED_MODULE_1_lodash_es__["isEmpty"](data) && !__WEBPACK_IMPORTED_MODULE_1_lodash_es__["isUndefined"](data) && !__WEBPACK_IMPORTED_MODULE_1_lodash_es__["isNull"](data);
    };
    /**
     * returns an array of concatenated values
     *
     * Author: <a href='https://github.com/shilob' target='_blank'>Shilo Banihit</a>
     * @param {any} data
     * @param  {any} config - dict of field: array of field paths to concat
     * @return {string}
     */
    UtilityService.prototype.getPropertyFromObjectConcat = function (data, config) {
        var values = [];
        __WEBPACK_IMPORTED_MODULE_1_lodash_es__["each"](config.field, function (f) {
            values.push(__WEBPACK_IMPORTED_MODULE_1_lodash_es__["get"](data, f));
        });
        return __WEBPACK_IMPORTED_MODULE_1_lodash_es__["concat"].apply(__WEBPACK_IMPORTED_MODULE_1_lodash_es__, [[]].concat(values));
    };
    UtilityService = __decorate([
        Object(__WEBPACK_IMPORTED_MODULE_0__angular_core__["Injectable"])()
    ], UtilityService);
    return UtilityService;
}());



/***/ }),

/***/ "./redbox-portal/angular/shared/workspace-service.ts":
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "a", function() { return WorkspaceTypeService; });
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__angular_core__ = __webpack_require__("./node_modules/@angular/core/esm5/core.js");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1__angular_http__ = __webpack_require__("./node_modules/@angular/http/esm5/http.js");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_rxjs_add_operator_map__ = __webpack_require__("./node_modules/rxjs/_esm5/add/operator/map.js");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_rxjs_add_operator_toPromise__ = __webpack_require__("./node_modules/rxjs/_esm5/add/operator/toPromise.js");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_rxjs_add_operator_toPromise___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_3_rxjs_add_operator_toPromise__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4__shared_base_service__ = __webpack_require__("./redbox-portal/angular/shared/base-service.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5__config_service__ = __webpack_require__("./redbox-portal/angular/shared/config-service.ts");
// Copyright (c) 2017 Queensland Cyber Infrastructure Foundation (http://www.qcif.edu.au/)
//
// GNU GENERAL PUBLIC LICENSE
//    Version 2, June 1991
//
// This program is free software; you can redistribute it and/or modify
// it under the terms of the GNU General Public License as published by
// the Free Software Foundation; either version 2 of the License, or
// (at your option) any later version.
//
// This program is distributed in the hope that it will be useful,
// but WITHOUT ANY WARRANTY; without even the implied warranty of
// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
// GNU General Public License for more details.
//
// You should have received a copy of the GNU General Public License along
// with this program; if not, write to the Free Software Foundation, Inc.,
// 51 Franklin Street, Fifth Floor, Boston, MA 02110-1301 USA.
var __extends = (this && this.__extends) || (function () {
    var extendStatics = Object.setPrototypeOf ||
        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||
        function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };
    return function (d, b) {
        extendStatics(d, b);
        function __() { this.constructor = d; }
        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
    };
})();
var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {
    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
    if (typeof Reflect === "object" && typeof Reflect.decorate === "function") r = Reflect.decorate(decorators, target, key, desc);
    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;
    return c > 3 && r && Object.defineProperty(target, key, r), r;
};
var __metadata = (this && this.__metadata) || function (k, v) {
    if (typeof Reflect === "object" && typeof Reflect.metadata === "function") return Reflect.metadata(k, v);
};
var __param = (this && this.__param) || function (paramIndex, decorator) {
    return function (target, key) { decorator(target, key, paramIndex); }
};






/**
 * Role related service
 *
 * Author: <a href='https://github.com/moisbo' target='_blank'>moisbo</a>
 */
var WorkspaceTypeService = /** @class */ (function (_super) {
    __extends(WorkspaceTypeService, _super);
    function WorkspaceTypeService(http, configService) {
        var _this = _super.call(this, http, configService) || this;
        _this.configService = configService;
        return _this;
    }
    WorkspaceTypeService.prototype.getBrand = function () {
        return this.brandingAndPortalUrl;
    };
    WorkspaceTypeService.prototype.getWorkspaceTypes = function () {
        var _this = this;
        return this.http.get(this.brandingAndPortalUrl + "/workspace/types", this.options)
            .toPromise()
            .then(function (res) { return _this.extractData(res); });
    };
    WorkspaceTypeService.prototype.getWorkspaceType = function (name) {
        var _this = this;
        return this.http.get(this.brandingAndPortalUrl + "/workspace/types/" + name, this.options)
            .toPromise()
            .then(function (res) { return _this.extractData(res); });
    };
    WorkspaceTypeService = __decorate([
        Object(__WEBPACK_IMPORTED_MODULE_0__angular_core__["Injectable"])(),
        __param(0, Object(__WEBPACK_IMPORTED_MODULE_0__angular_core__["Inject"])(__WEBPACK_IMPORTED_MODULE_1__angular_http__["b" /* Http */])), __param(1, Object(__WEBPACK_IMPORTED_MODULE_0__angular_core__["Inject"])(__WEBPACK_IMPORTED_MODULE_5__config_service__["a" /* ConfigService */])),
        __metadata("design:paramtypes", [__WEBPACK_IMPORTED_MODULE_1__angular_http__["b" /* Http */], __WEBPACK_IMPORTED_MODULE_5__config_service__["a" /* ConfigService */]])
    ], WorkspaceTypeService);
    return WorkspaceTypeService;
}(__WEBPACK_IMPORTED_MODULE_4__shared_base_service__["a" /* BaseService */]));



/***/ }),

/***/ "./src/$$_lazy_route_resource lazy recursive":
/***/ (function(module, exports) {

function webpackEmptyAsyncContext(req) {
	// Here Promise.resolve().then() is used instead of new Promise() to prevent
	// uncatched exception popping up in devtools
	return Promise.resolve().then(function() {
		throw new Error("Cannot find module '" + req + "'.");
	});
}
webpackEmptyAsyncContext.keys = function() { return []; };
webpackEmptyAsyncContext.resolve = webpackEmptyAsyncContext;
module.exports = webpackEmptyAsyncContext;
webpackEmptyAsyncContext.id = "./src/$$_lazy_route_resource lazy recursive";

/***/ }),

/***/ "./src/app/components/create-workspace.component.ts":
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "b", function() { return CreateWorkspaceField; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "a", function() { return CreateWorkspaceComponent; });
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__angular_core__ = __webpack_require__("./node_modules/@angular/core/esm5/core.js");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1__shared_form_field_simple_component__ = __webpack_require__("./redbox-portal/angular/shared/form/field-simple.component.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2__shared_form_field_base__ = __webpack_require__("./redbox-portal/angular/shared/form/field-base.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3__angular_forms__ = __webpack_require__("./node_modules/@angular/forms/esm5/forms.js");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4__omero_service__ = __webpack_require__("./src/app/omero.service.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5__shared__ = __webpack_require__("./src/app/components/shared.ts");
var __extends = (this && this.__extends) || (function () {
    var extendStatics = Object.setPrototypeOf ||
        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||
        function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };
    return function (d, b) {
        extendStatics(d, b);
        function __() { this.constructor = d; }
        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
    };
})();
var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {
    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
    if (typeof Reflect === "object" && typeof Reflect.decorate === "function") r = Reflect.decorate(decorators, target, key, desc);
    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;
    return c > 3 && r && Object.defineProperty(target, key, r), r;
};
var __metadata = (this && this.__metadata) || function (k, v) {
    if (typeof Reflect === "object" && typeof Reflect.metadata === "function") return Reflect.metadata(k, v);
};






/**
 * Contributor Model
 *
 * @author <a target='_' href='https://github.com/moisbo'>moisbo</a>
 *
 */
var CreateWorkspaceField = /** @class */ (function (_super) {
    __extends(CreateWorkspaceField, _super);
    function CreateWorkspaceField(options, injector) {
        var _this = _super.call(this, options, injector) || this;
        _this.processing = false;
        _this.listWorkspaces = new __WEBPACK_IMPORTED_MODULE_0__angular_core__["EventEmitter"]();
        _this.omeroService = _this.getFromInjector(__WEBPACK_IMPORTED_MODULE_4__omero_service__["a" /* OMEROService */]);
        _this.checks = new __WEBPACK_IMPORTED_MODULE_5__shared__["a" /* Checks */]();
        _this.currentWorkspace = new __WEBPACK_IMPORTED_MODULE_5__shared__["d" /* CurrentWorkspace */]();
        _this.workspaceUser = new __WEBPACK_IMPORTED_MODULE_5__shared__["e" /* WorkspaceUser */]();
        _this.creation = new __WEBPACK_IMPORTED_MODULE_5__shared__["b" /* Creation */]();
        _this.creationAlert = new __WEBPACK_IMPORTED_MODULE_5__shared__["c" /* CreationAlert */]();
        _this.createLabel = options['createLabel'] || '';
        _this.dismissLabel = options['dismissLabel'] || '';
        _this.createWorkspaceLabel = options['createWorkspaceLabel'] || '';
        _this.workspaceDetailsLabel = options['workspaceDetailsLabel'] || '';
        _this.selectSpace = options['selectSpace'] || '';
        _this.nameWorkspace = options['nameWorkspace'] || '';
        _this.addDescription = options['addDescription'] || '';
        _this.selectTemplate = options['selectTemplate'] || '';
        _this.recordMap = options['recordMap'] || [];
        _this.branch = options['branch'] || '';
        _this.nameWorkspaceValidation = options['nameWorkspaceValidation'] || '';
        _this.nameHasSpacesValidation = options['nameHasSpacesValidation'] || '';
        _this.descriptionWorkspaceValidation = options['descriptionWorkspaceValidation'] || '';
        _this.workspaceCreated = options['workspaceCreated'] || '';
        _this.linkingWorkspace = options['linkingWorkspace'] || '';
        _this.creatingWorkspace = options['creatingWorkspace'] || '';
        _this.workspaceLink = options['workspaceLink'] || '';
        return _this;
    }
    CreateWorkspaceField.prototype.init = function () {
        this.rdmp = this.fieldMap._rootComp.rdmp;
    };
    CreateWorkspaceField.prototype.registerEvents = function () {
        this.fieldMap['ListWorkspaces'].field['checkLoggedIn'].subscribe(this.checkLogin.bind(this));
    };
    CreateWorkspaceField.prototype.checkLogin = function (status) {
        this.loggedIn = this.fieldMap._rootComp.loggedIn = status;
    };
    CreateWorkspaceField.prototype.createFormModel = function (valueElem) {
        if (valueElem === void 0) { valueElem = undefined; }
        if (valueElem) {
            this.value = valueElem;
        }
        this.formModel = new __WEBPACK_IMPORTED_MODULE_3__angular_forms__["b" /* FormControl */](this.value || []);
        if (this.value) {
            this.setValue(this.value);
        }
        return this.formModel;
    };
    CreateWorkspaceField.prototype.setValue = function (value) {
        this.formModel.patchValue(value, { emitEvent: false });
        this.formModel.markAsTouched();
    };
    CreateWorkspaceField.prototype.setEmptyValue = function () {
        this.value = [];
        return this.value;
    };
    CreateWorkspaceField.prototype.loadCreateWorkspaceModal = function () {
        this.workspaceUser = this.fieldMap._rootComp.workspaceUser;
        this.creation.clear();
        this.creationAlert.clear();
        console.log('clear');
        jQuery('#createModal').modal({ show: true, keyboard: false, backdrop: 'static' });
    };
    CreateWorkspaceField.prototype.create = function () {
        this.validations = this.validateWorkspace();
        this.creationAlert.clear();
        if (this.validations.length <= 0) {
            this.createWorkspace();
        }
    };
    CreateWorkspaceField.prototype.validateWorkspace = function () {
        var validateWorkspace = [];
        if (!this.creation.name) {
            validateWorkspace.push({ message: this.nameWorkspaceValidation });
        }
        if (this.creation.nameHasSpaces()) {
            validateWorkspace.push({ message: this.nameHasSpacesValidation });
        }
        if (!this.creation.description) {
            validateWorkspace.push({ message: this.descriptionWorkspaceValidation });
        }
        return validateWorkspace;
    };
    CreateWorkspaceField.prototype.createWorkspace = function () {
        var _this = this;
        this.creationAlert.set({ message: this.creatingWorkspace, status: 'working', className: 'warning' });
        this.omeroService.createWorkspace(this.creation)
            .then(function (response) {
            if (!response.status) {
                //TODO: improve this assignment in case of error.
                throw new Error('Error creating workspace');
            }
            else {
                _this.creationAlert.set({ message: _this.linkingWorkspace, status: 'working', className: 'warning' });
                _this.creation.id = response.create['@id'];
                _this.creation.description = response.create['Description'];
                _this.creation.location = _this.workspaceLink + _this.creation.id;
                return _this.omeroService.link({
                    rdmp: _this.rdmp, project: _this.creation, recordMap: _this.recordMap
                });
            }
        }).then(function (response) {
            if (!response.status) {
                throw new Error(response.message.description);
            }
            _this.creationAlert.set({ message: _this.workspaceCreated, status: 'done', className: 'success' });
            _this.listWorkspaces.emit();
        })
            .catch(function (error) {
            _this.creationAlert.set({ message: error, status: 'done', className: 'danger' });
        });
    };
    __decorate([
        Object(__WEBPACK_IMPORTED_MODULE_0__angular_core__["Output"])(),
        __metadata("design:type", __WEBPACK_IMPORTED_MODULE_0__angular_core__["EventEmitter"])
    ], CreateWorkspaceField.prototype, "listWorkspaces", void 0);
    return CreateWorkspaceField;
}(__WEBPACK_IMPORTED_MODULE_2__shared_form_field_base__["a" /* FieldBase */]));

/**
 * Component that CreateModal to a workspace app
 */
var CreateWorkspaceComponent = /** @class */ (function (_super) {
    __extends(CreateWorkspaceComponent, _super);
    function CreateWorkspaceComponent() {
        return _super !== null && _super.apply(this, arguments) || this;
    }
    CreateWorkspaceComponent.prototype.ngOnInit = function () {
        this.field.init();
        this.field.registerEvents();
    };
    CreateWorkspaceComponent = __decorate([
        Object(__WEBPACK_IMPORTED_MODULE_0__angular_core__["Component"])({
            selector: 'ws-createworkspace',
            template: __webpack_require__("./src/app/components/field-createworkspace.html")
        })
    ], CreateWorkspaceComponent);
    return CreateWorkspaceComponent;
}(__WEBPACK_IMPORTED_MODULE_1__shared_form_field_simple_component__["l" /* SimpleComponent */]));



/***/ }),

/***/ "./src/app/components/field-createworkspace.html":
/***/ (function(module, exports) {

module.exports = "<div *ngIf=\"field.loggedIn\" class='padding-bottom-10'>\n  <div class=\"\">\n    <button type=\"button\" class=\"btn btn-success\" (click)=\"field.loadCreateWorkspaceModal()\"><i class=\"fa fa-plus-square\"></i>&nbsp;{{ field.createLabel }}</button>\n  </div>\n</div>\n<div id=\"createModal\" class=\"modal fade\" data-keyboard=\"false\">\n  <div class=\"modal-dialog\" role=\"document\">\n    <div class=\"modal-content\">\n      <div class=\"modal-header\">\n        <h4 class=\"modal-title\">{{ field.createWorkspaceLabel }}</h4>\n      </div>\n      <div class=\"modal-body\">\n        <div *ngIf=\"field.loadingModal\" class=\"row\">\n          <img class=\"center-block\" src=\"/images/loading.svg\">\n        </div>\n        <div *ngIf=\"!field.loadingModal\">\n          <h5>{{ field.workspaceDetailsLabel }}</h5>\n          <form *ngIf=\"!field.processing\" #form=\"ngForm\" novalidate autocomplete=\"off\">\n            <div class=\"form-group\">\n              <h4>{{ field.nameWorkspace }}</h4>\n              <input required minlength=\"4\" type=\"text\" class=\"form-control\" name=\"creationName\" [(ngModel)]=\"field.creation.name\">\n            </div>\n            <div class=\"form-group\">\n              <h4>{{ field.addDescription }}</h4>\n              <input required minlength=\"4\" type=\"text\" class=\"form-control\" name=\"description\" [(ngModel)]=\"field.creation.description\">\n            </div>\n          </form>\n          <form *ngIf=\"!field.processing\" #form=\"ngForm\" novalidate autocomplete=\"off\">\n            <div class=\"form-group\">\n              <div *ngFor=\"let validation of field.validations\" class=\"alert alert-danger\">\n                <span><i class=\"fa fa-times\"></i> </span>{{ validation.message }}\n              </div>\n            </div>\n            <div class=\"form-group\">\n              <div *ngIf=\"field.creationAlert.message\" class=\"alert alert-{{ field.creationAlert.className  || 'alert' }}\">\n                <span *ngIf=\"field.creationAlert.status === 'success'; then isDone; else isWorking;\"></span>\n                <ng-template #isDone>\n                  <i class=\"fa fa-check-circle\"></i>{{ field.creationAlert.message }}\n                </ng-template>\n                <ng-template #isWorking>\n                  <i class=\"fa fa-spin-circle\"></i>{{ field.creationAlert.message }}\n                </ng-template>\n              </div>\n            </div>\n\n          </form>\n        </div>\n      </div>\n      <div class=\"modal-footer\">\n        <span *ngIf=\"field.creationAlert.status !== ('working' || 'done'); then buttonsCreate else buttonsBlocked;\"></span>\n        <ng-template #buttonsCreate>\n          <button *ngIf=\"field.creationAlert.status !== 'done'\" class=\"btn btn-primary\" (click)=\"field.create()\" type=\"submit\">{{ field.createLabel }}</button>\n          <button type=\"button\" class=\"btn btn-secondary\" data-dismiss=\"modal\">{{ field.dismissLabel }}</button>\n        </ng-template>\n        <ng-template #buttonsBlocked>\n          <button disabled class=\"btn btn-primary\"  type=\"submit\">{{ field.createLabel }}</button>\n          <button disabled class=\"btn btn-secondary\" type=\"button\">{{ field.dismissLabel }}</button>\n        </ng-template>\n      </div>\n    </div>\n  </div>\n</div>\n"

/***/ }),

/***/ "./src/app/components/field-listworkspaces.html":
/***/ (function(module, exports) {

module.exports = "<div *ngIf=\"field.loggedIn\" class=\"padding-bottom-10\">\n  <div class=\"\">\n    <table class=\"table\">\n      <thead>\n        <tr>\n          <ng-container *ngFor=\"let header of field.columns\"><th>{{ header.label }}</th></ng-container>\n          <th>{{ field.rdmpLinkLabel }}</th>\n        </tr>\n      </thead>\n      <tbody>\n        <tr *ngFor=\"let item of field.workspaces\">\n          <ng-container *ngFor=\"let column of field.columns\">\n          <td *ngIf=\"column.show != false\">\n            <span *ngIf=\"column.link; else noProcessing\"><a target=\"_blank\" class=\"{{column.classes || ''}}\" rel=\"noopener noreferrer\" href=\"{{ field.workspaceLink + item[column.property] }}\">{{ column.label || ''}}</a></span>\n            <ng-template #multivalue></ng-template>\n            <ng-template #noProcessing><span >{{ item[column.property] }}</span></ng-template>\n          </td>\n          </ng-container>\n          <td>\n            <span *ngIf=\"!item['linkedState']\">\n              <button type=\"button\" disabled class=\"btn btn-info btn-block\" [name]=\"item['@id']\"><span><i class=\"fa fa-spinner fa-spin\"></i></span></button>\n            </span>\n            <span *ngIf=\"item['linkedState'] === 'linked'\">\n              <button type=\"button\" disabled class=\"btn btn-success btn-block\" [name]=\"item['@id']\">{{ field.linkedLabel }}</button>\n            </span>\n            <span *ngIf=\"item['linkedState'] === 'another'\">\n              <button type=\"button\" disabled class=\"btn btn-info btn-block\" [name]=\"item['@id']\">{{ field.linkedAnotherLabel }}</button>\n            </span>\n            <span *ngIf=\"item['linkedState'] === 'link'\">\n              <button type=\"button\" class=\"btn btn-info btn-block\" [name]=\"item['@id']\" (click)=\"field.linkWorkspace(item)\">{{ field.linkLabel }}</button>\n            </span>\n            <span *ngIf=\"item['linkedState'] === 'problem'\">\n              <button type=\"button\" disabled class=\"btn btn-warning btn-block\" [name]=\"item['@id']\" >{{ field.linkProblem }}</button>\n            </span>\n          </td>\n        </tr>\n      </tbody>\n    </table>\n    <pagination [directionLinks]=\"false\" [boundaryLinks]=\"true\" [totalItems]=\"field.workspacesMeta.totalCount\"\n                [(ngModel)]=\"field.currentPage\" (pageChanged)=\"field.pageChanged($event)\" class=\"pagination-sm\"></pagination>\n    <div *ngIf=\"field.loading\" class=\"\">\n      <img class=\"center-block\" src=\"/images/loading.svg\">\n    </div>\n    <p *ngIf=\"field.failedObjects.length > 0\">There were {{ field.failedObjects.length }} records that failed to load</p>\n    <p *ngIf=\"field.accessDeniedObjects.length > 0\">There were {{ field.accessDeniedObjects.length }} records that you do not have access to</p>\n  </div>\n  <div class=\"\">\n    <button type=\"button\" class=\"btn btn-default\" (click)=\"field.listWorkspaces()\"><i class=\"fa fa-refresh\"></i>&nbsp;{{ field.syncLabel }}</button>\n  </div>\n</div>\n"

/***/ }),

/***/ "./src/app/components/linkmodal-workspace.component.ts":
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "b", function() { return LinkModalWorkspaceField; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "a", function() { return LinkModalWorkspaceComponent; });
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__angular_core__ = __webpack_require__("./node_modules/@angular/core/esm5/core.js");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1__shared_form_field_simple_component__ = __webpack_require__("./redbox-portal/angular/shared/form/field-simple.component.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2__shared_form_field_base__ = __webpack_require__("./redbox-portal/angular/shared/form/field-base.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3__angular_forms__ = __webpack_require__("./node_modules/@angular/forms/esm5/forms.js");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4__shared__ = __webpack_require__("./src/app/components/shared.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5__omero_service__ = __webpack_require__("./src/app/omero.service.ts");
var __extends = (this && this.__extends) || (function () {
    var extendStatics = Object.setPrototypeOf ||
        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||
        function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };
    return function (d, b) {
        extendStatics(d, b);
        function __() { this.constructor = d; }
        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
    };
})();
var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {
    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
    if (typeof Reflect === "object" && typeof Reflect.decorate === "function") r = Reflect.decorate(decorators, target, key, desc);
    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;
    return c > 3 && r && Object.defineProperty(target, key, r), r;
};
var __metadata = (this && this.__metadata) || function (k, v) {
    if (typeof Reflect === "object" && typeof Reflect.metadata === "function") return Reflect.metadata(k, v);
};






/**
 * Contributor Model
 *
 * @author <a target='_' href='https://github.com/moisbo'>moisbo</a>
 *
 */
var LinkModalWorkspaceField = /** @class */ (function (_super) {
    __extends(LinkModalWorkspaceField, _super);
    function LinkModalWorkspaceField(options, injector) {
        var _this = _super.call(this, options, injector) || this;
        _this.listWorkspaces = new __WEBPACK_IMPORTED_MODULE_0__angular_core__["EventEmitter"]();
        _this.omeroService = _this.getFromInjector(__WEBPACK_IMPORTED_MODULE_5__omero_service__["a" /* OMEROService */]);
        _this.linkModalTitle = options['linkModalTitle'] || '';
        _this.workspaceDetailsTitle = options['workspaceDetailsTitle'] || '';
        _this.processingLabel = options['processingLabel'] || '';
        _this.processingMessage = options['processingMessage'] || '';
        _this.comparingLabel = options['comparingLabel'] || '';
        _this.statusLabel = options['statusLabel'] || '';
        _this.processingSuccess = options['processingSuccess'] || '';
        _this.processingFail = options['processingFail'] || '';
        _this.closeLabel = options['closeLabel'] || '';
        _this.checks = new __WEBPACK_IMPORTED_MODULE_4__shared__["a" /* Checks */]();
        _this.currentWorkspace = new __WEBPACK_IMPORTED_MODULE_4__shared__["d" /* CurrentWorkspace */]();
        _this.workspaceDefinition = options['workspaceDefinition'] || [];
        _this.checkField = options['checkField'] || '';
        _this.recordMap = options['recordMap'] || [];
        _this.workspaceLink = options['workspaceLink'] || '';
        return _this;
    }
    LinkModalWorkspaceField.prototype.registerEvents = function () {
        this.fieldMap['ListWorkspaces'].field['linkModal'].subscribe(this.linkModal.bind(this));
    };
    LinkModalWorkspaceField.prototype.createFormModel = function (valueElem) {
        if (valueElem === void 0) { valueElem = undefined; }
        if (valueElem) {
            this.value = valueElem;
        }
        this.formModel = new __WEBPACK_IMPORTED_MODULE_3__angular_forms__["b" /* FormControl */](this.value || []);
        if (this.value) {
            this.setValue(this.value);
        }
        return this.formModel;
    };
    LinkModalWorkspaceField.prototype.setValue = function (value) {
        this.formModel.patchValue(value, { emitEvent: false });
        this.formModel.markAsTouched();
    };
    LinkModalWorkspaceField.prototype.setEmptyValue = function () {
        this.value = [];
        return this.value;
    };
    LinkModalWorkspaceField.prototype.linkModal = function (_a) {
        var _this = this;
        var rdmp = _a.rdmp, workspace = _a.workspace;
        this.currentWorkspace = workspace;
        this.currentWorkspace.location = this.workspaceLink + workspace['@id'];
        this.checks.clear();
        jQuery('#linkModal').modal({ show: true, keyboard: false, backdrop: 'static' });
        this.processing = true;
        this.checks.master = true;
        return this.omeroService.link({
            rdmp: rdmp,
            project: this.currentWorkspace,
            recordMap: this.recordMap
        }).then(function (response) {
            if (!response.status) {
                _this.processingStatus = 'done';
                _this.processingFail = response.error.message;
            }
            else {
                _this.checks.linkCreated = true;
            }
            _this.processing = false;
            _this.listWorkspaces.emit();
        })
            .catch(function (error) {
            _this.processingStatus = 'done';
            _this.processingFail = error.error.message;
            _this.processing = false;
        });
    };
    __decorate([
        Object(__WEBPACK_IMPORTED_MODULE_0__angular_core__["Output"])(),
        __metadata("design:type", __WEBPACK_IMPORTED_MODULE_0__angular_core__["EventEmitter"])
    ], LinkModalWorkspaceField.prototype, "listWorkspaces", void 0);
    return LinkModalWorkspaceField;
}(__WEBPACK_IMPORTED_MODULE_2__shared_form_field_base__["a" /* FieldBase */]));

/**
 * Component that Links Workspaces to Workspace Records in Stash
 */
var LinkModalWorkspaceComponent = /** @class */ (function (_super) {
    __extends(LinkModalWorkspaceComponent, _super);
    function LinkModalWorkspaceComponent() {
        return _super !== null && _super.apply(this, arguments) || this;
    }
    LinkModalWorkspaceComponent.prototype.ngOnInit = function () {
        this.field.registerEvents();
    };
    LinkModalWorkspaceComponent = __decorate([
        Object(__WEBPACK_IMPORTED_MODULE_0__angular_core__["Component"])({
            selector: 'ws-linkmodal',
            template: "\n    <div id=\"linkModal\" class=\"modal fade\" data-keyboard=\"false\">\n      <div class=\"modal-dialog\" role=\"document\">\n        <div class=\"modal-content\">\n          <div class=\"modal-header\">\n            <h4 class=\"modal-title\">{{ field.linkModalTitle }}</h4>\n          </div>\n          <div class=\"modal-body\">\n            <h5>{{ field.workspaceDetailsTitle }}</h5>\n            <p *ngFor=\"let item of field.workspaceDefinition\">{{ item.label }} : {{ field.currentWorkspace[item.name]}}</p>\n            <h5>{{ field.processingLabel }}</h5>\n            <p>{{ field.processingMessage }}&nbsp;<span\n              *ngIf=\"field.checks.master; then isDone; else isSpinning\"></span></p>\n            <p *ngIf=\"field.checks.comparing\">{{ field.comparingLabel }}&nbsp;<span\n              *ngIf=\"field.checks.link; then isDone; else isSpinning\"></span></p>\n            <p *ngIf=\"field.checks.link == false\">{{ field.statusLabel }}&nbsp;<span\n              *ngIf=\"field.checks.rdmp; then isDone; else isSpinning\"></span></p>\n            <p class=\"alert alert-success\" *ngIf=\"field.checks.linkCreated\">{{ field.processingSuccess }}</p>\n            <p class=\"alert alert-danger\" *ngIf=\"field.checks.linkWithOther\">{{ field.processingFail }}</p>\n            <p class=\"alert alert-danger\" *ngIf=\"field.processingStatus === 'done' && field.processingFail\">\n              {{ field.processingFail }}</p>\n            <ng-template #isDone>\n              <i class=\"fa fa-check-circle\"></i>\n            </ng-template>\n            <ng-template #isSpinning>\n              <i class=\"fa fa-spinner fa-spin\"></i>\n            </ng-template>\n          </div>\n          <div class=\"modal-footer\">\n            <span *ngIf=\"field.processing; then waitForProcessing; else finishProcessing\"></span>\n            <ng-template #finishProcessing>\n              <button type=\"button\" class=\"btn btn-secondary\" data-dismiss=\"modal\">{{ field.closeLabel }}</button>\n            </ng-template>\n            <ng-template #waitForProcessing>\n              <button type=\"button\" class=\"btn btn-secondary disabled\" data-dismiss=\"modal\">{{ field.closeLabel }}\n              </button>\n            </ng-template>\n          </div>\n        </div>\n      </div>\n    </div>\n  "
        })
    ], LinkModalWorkspaceComponent);
    return LinkModalWorkspaceComponent;
}(__WEBPACK_IMPORTED_MODULE_1__shared_form_field_simple_component__["l" /* SimpleComponent */]));



/***/ }),

/***/ "./src/app/components/list-workspaces.component.ts":
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "b", function() { return ListWorkspaceDataField; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "a", function() { return ListWorkspaceDataComponent; });
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__angular_core__ = __webpack_require__("./node_modules/@angular/core/esm5/core.js");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1__shared_form_field_simple_component__ = __webpack_require__("./redbox-portal/angular/shared/form/field-simple.component.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2__shared_form_field_base__ = __webpack_require__("./redbox-portal/angular/shared/form/field-base.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3__angular_forms__ = __webpack_require__("./node_modules/@angular/forms/esm5/forms.js");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4__omero_service__ = __webpack_require__("./src/app/omero.service.ts");
var __extends = (this && this.__extends) || (function () {
    var extendStatics = Object.setPrototypeOf ||
        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||
        function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };
    return function (d, b) {
        extendStatics(d, b);
        function __() { this.constructor = d; }
        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
    };
})();
var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {
    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
    if (typeof Reflect === "object" && typeof Reflect.decorate === "function") r = Reflect.decorate(decorators, target, key, desc);
    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;
    return c > 3 && r && Object.defineProperty(target, key, r), r;
};
var __metadata = (this && this.__metadata) || function (k, v) {
    if (typeof Reflect === "object" && typeof Reflect.metadata === "function") return Reflect.metadata(k, v);
};





/**
 * Contributor Model
 *
 *
 * @author <a target='_' href='https://github.com/moisbo'>moisbo</a>
 *
 */
var ListWorkspaceDataField = /** @class */ (function (_super) {
    __extends(ListWorkspaceDataField, _super);
    function ListWorkspaceDataField(options, injector) {
        var _this = _super.call(this, options, injector) || this;
        _this.currentPage = 1;
        _this.checkLoggedIn = new __WEBPACK_IMPORTED_MODULE_0__angular_core__["EventEmitter"]();
        _this.linkModal = new __WEBPACK_IMPORTED_MODULE_0__angular_core__["EventEmitter"]();
        _this.setWorkspaceUser = new __WEBPACK_IMPORTED_MODULE_0__angular_core__["EventEmitter"]();
        _this.omeroService = _this.getFromInjector(__WEBPACK_IMPORTED_MODULE_4__omero_service__["a" /* OMEROService */]);
        _this.relatedObjects = [];
        _this.accessDeniedObjects = [];
        _this.failedObjects = [];
        _this.columns = options['columns'] || [];
        _this.rdmpLinkLabel = options['rdmpLinkLabel'] || 'Plan';
        _this.syncLabel = options['syncLabel'] || 'Sync';
        var relatedObjects = _this.relatedObjects;
        _this.value = options['value'] || _this.setEmptyValue();
        _this.relatedObjects = [];
        _this.failedObjects = [];
        _this.accessDeniedObjects = [];
        _this.loading = true;
        _this.workspaceLink = options['workspaceLink'];
        _this.linkedLabel = options['linkedLabel'] || 'linked';
        _this.linkedAnotherLabel = options['linkedAnotherLabel'] || 'Linked to another workspace';
        _this.linkLabel = options['linkLabel'] || 'Link Workspace';
        _this.linkProblem = options['linkProblem'] || 'There was a problem checking the link';
        _this.limit = 10;
        _this.offset = 0;
        _this.workspacesMeta = {};
        return _this;
    }
    ListWorkspaceDataField.prototype.registerEvents = function () {
        this.fieldMap['LoginWorkspaceApp'].field['listWorkspaces'].subscribe(this.listWorkspaces.bind(this)); //TODO: this next line doesnt work because of when the form is being built
        this.fieldMap['CreateWorkspace'].field['listWorkspaces'].subscribe(this.listWorkspaces.bind(this));
        this.fieldMap['LinkModal'].field['listWorkspaces'].subscribe(this.listWorkspaces.bind(this));
        // this.fieldMap['RevokeLogin'].field['revokePermissions'].subscribe(this.revoke.bind(this));
    };
    ListWorkspaceDataField.prototype.init = function () {
        this.rdmp = this.fieldMap._rootComp.rdmp;
    };
    ListWorkspaceDataField.prototype.revoke = function () {
        this.loggedIn = false;
    };
    ListWorkspaceDataField.prototype.createFormModel = function (valueElem) {
        if (valueElem === void 0) { valueElem = undefined; }
        if (valueElem) {
            this.value = valueElem;
        }
        this.formModel = new __WEBPACK_IMPORTED_MODULE_3__angular_forms__["b" /* FormControl */](this.value || []);
        if (this.value) {
            this.setValue(this.value);
        }
        return this.formModel;
    };
    ListWorkspaceDataField.prototype.setValue = function (value) {
        this.formModel.patchValue(value, { emitEvent: false });
        this.formModel.markAsTouched();
    };
    ListWorkspaceDataField.prototype.setEmptyValue = function () {
        this.value = [];
        return this.value;
    };
    ListWorkspaceDataField.prototype.listWorkspaces = function () {
        var _this = this;
        this.loading = true;
        this.workspaces = [];
        return this.omeroService.projects(this.limit, this.offset)
            .then(function (response) {
            _this.loading = false;
            if (!response.status) {
                _this.loggedIn = _this.fieldMap._rootComp.loggedIn = false;
                _this.checkLoggedIn.emit(false);
            }
            else {
                _this.loggedIn = _this.fieldMap._rootComp.loggedIn = true;
                _this.workspacesMeta = response.projects.meta;
                _this.workspaces = response.projects.data;
                _this.checkLoggedIn.emit(true);
                _this.checkLinks();
            }
        })
            .catch(function (error) {
            _this.loading = false;
            _this.loggedIn = _this.fieldMap._rootComp.loggedIn = false;
            _this.checkLoggedIn.emit(false);
        });
    };
    ListWorkspaceDataField.prototype.linkWorkspace = function (item) {
        this.linkModal.emit({ rdmp: this.fieldMap._rootComp.rdmp, workspace: item });
    };
    ListWorkspaceDataField.prototype.checkLinks = function () {
        var _this = this;
        //this.workspaces[index]['linkedState'] == 'check'; // Possible values: linked, another, link
        this.workspaces.map(function (w, index) {
            _this.omeroService.checkLink({ rdmpId: _this.rdmp, omeroId: w['@id'] })
                .then(function (response) {
                if (!response.status) {
                    throw new Error('Error checking workspace');
                }
                else {
                    var check = response.check;
                    if (check && check.omero) {
                        _this.workspaces[index]['linkedState'] = 'linked';
                    }
                    else if (check && check.ws) {
                        _this.workspaces[index]['linkedState'] = 'another';
                    }
                    else {
                        _this.workspaces[index]['linkedState'] = 'link';
                    }
                }
            })
                .catch(function (error) {
                console.log(error);
                _this.workspaces[index]['linkedState'] = 'problem';
            });
        });
    };
    ListWorkspaceDataField.prototype.pageChanged = function (event) {
        this.limit = this.workspacesMeta.limit;
        this.offset = this.workspacesMeta.offset;
        var currentOffset = (event.page * this.limit) - this.limit;
        if (this.currentPage > event.page) {
            if (currentOffset <= this.limit) {
                this.offset = 0;
            }
            else {
                this.offset = currentOffset <= 0 ? 0 : currentOffset;
            }
        }
        else {
            this.offset = currentOffset;
        }
        this.listWorkspaces();
    };
    ListWorkspaceDataField.prototype.setPage = function (pageNo) {
        this.currentPage = pageNo;
    };
    __decorate([
        Object(__WEBPACK_IMPORTED_MODULE_0__angular_core__["Output"])(),
        __metadata("design:type", __WEBPACK_IMPORTED_MODULE_0__angular_core__["EventEmitter"])
    ], ListWorkspaceDataField.prototype, "checkLoggedIn", void 0);
    __decorate([
        Object(__WEBPACK_IMPORTED_MODULE_0__angular_core__["Output"])(),
        __metadata("design:type", __WEBPACK_IMPORTED_MODULE_0__angular_core__["EventEmitter"])
    ], ListWorkspaceDataField.prototype, "linkModal", void 0);
    __decorate([
        Object(__WEBPACK_IMPORTED_MODULE_0__angular_core__["Output"])(),
        __metadata("design:type", __WEBPACK_IMPORTED_MODULE_0__angular_core__["EventEmitter"])
    ], ListWorkspaceDataField.prototype, "setWorkspaceUser", void 0);
    return ListWorkspaceDataField;
}(__WEBPACK_IMPORTED_MODULE_2__shared_form_field_base__["a" /* FieldBase */]));

/**
 * Component to display information from related objects within ReDBox
 */
var ListWorkspaceDataComponent = /** @class */ (function (_super) {
    __extends(ListWorkspaceDataComponent, _super);
    function ListWorkspaceDataComponent() {
        return _super !== null && _super.apply(this, arguments) || this;
    }
    ListWorkspaceDataComponent.prototype.ngOnInit = function () {
        this.field.registerEvents();
        this.field.init();
    };
    ListWorkspaceDataComponent.prototype.ngAfterContentInit = function () {
        this.field.listWorkspaces();
    };
    ListWorkspaceDataComponent = __decorate([
        Object(__WEBPACK_IMPORTED_MODULE_0__angular_core__["Component"])({
            selector: 'ws-listworkspaces',
            template: __webpack_require__("./src/app/components/field-listworkspaces.html")
        })
    ], ListWorkspaceDataComponent);
    return ListWorkspaceDataComponent;
}(__WEBPACK_IMPORTED_MODULE_1__shared_form_field_simple_component__["l" /* SimpleComponent */]));



/***/ }),

/***/ "./src/app/components/login-workspaceapp.component.ts":
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "b", function() { return LoginWorkspaceAppField; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "a", function() { return LoginWorkspaceAppComponent; });
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__angular_core__ = __webpack_require__("./node_modules/@angular/core/esm5/core.js");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1__angular_forms__ = __webpack_require__("./node_modules/@angular/forms/esm5/forms.js");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2__shared_form_field_simple_component__ = __webpack_require__("./redbox-portal/angular/shared/form/field-simple.component.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3__shared_form_field_base__ = __webpack_require__("./redbox-portal/angular/shared/form/field-base.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4__omero_service__ = __webpack_require__("./src/app/omero.service.ts");
var __extends = (this && this.__extends) || (function () {
    var extendStatics = Object.setPrototypeOf ||
        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||
        function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };
    return function (d, b) {
        extendStatics(d, b);
        function __() { this.constructor = d; }
        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
    };
})();
var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {
    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
    if (typeof Reflect === "object" && typeof Reflect.decorate === "function") r = Reflect.decorate(decorators, target, key, desc);
    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;
    return c > 3 && r && Object.defineProperty(target, key, r), r;
};
var __metadata = (this && this.__metadata) || function (k, v) {
    if (typeof Reflect === "object" && typeof Reflect.metadata === "function") return Reflect.metadata(k, v);
};





/**
 * Contributor Model
 *
 * @author <a target='_' href='https://github.com/moisbo'>moisbo</a>
 *
 */
var LoginWorkspaceAppField = /** @class */ (function (_super) {
    __extends(LoginWorkspaceAppField, _super);
    function LoginWorkspaceAppField(options, injector) {
        var _this = _super.call(this, options, injector) || this;
        _this.listWorkspaces = new __WEBPACK_IMPORTED_MODULE_0__angular_core__["EventEmitter"]();
        _this.omeroService = _this.getFromInjector(__WEBPACK_IMPORTED_MODULE_4__omero_service__["a" /* OMEROService */]);
        _this.columns = options['columns'] || [];
        _this.usernameLabel = options['usernameLabel'] || 'username';
        _this.passwordLabel = options['passwordLabel'] || 'password';
        _this.loginLabel = options['loginLabel'] || 'login';
        _this.loginErrorMessage = options['loginErrorMessage'] || 'Please include username and password';
        _this.permissionStep = options['permissionStep'] || '';
        _this.permissionList = options['permissionList'] || {};
        _this.permissionLabel = options['permissionLabel'] || '';
        _this.allowLabel = options['allowLabel'] || 'Allow';
        _this.closeLabel = options['closeLabel'] || 'Close';
        _this.cannotLoginMessage = options['cannotLoginMessage'] || 'There was a problem login in, please try again';
        return _this;
    }
    LoginWorkspaceAppField.prototype.registerEvents = function () {
        this.fieldMap['ListWorkspaces'].field['checkLoggedIn'].subscribe(this.checkLogin.bind(this));
        //let that = this;
        //this.fieldMap._rootComp['loginMessage'].subscribe(that.displayLoginMessage);
    };
    LoginWorkspaceAppField.prototype.revoke = function () {
        this.checkLogin(false);
    };
    LoginWorkspaceAppField.prototype.checkLogin = function (status) {
        this.loggedIn = this.fieldMap._rootComp.loggedIn = status;
        this.isLoaded = true;
    };
    LoginWorkspaceAppField.prototype.createFormModel = function (valueElem) {
        if (valueElem === void 0) { valueElem = undefined; }
        if (valueElem) {
            this.value = valueElem;
        }
        this.formModel = new __WEBPACK_IMPORTED_MODULE_1__angular_forms__["b" /* FormControl */](this.value || []);
        if (this.value) {
            this.setValue(this.value);
        }
        return this.formModel;
    };
    LoginWorkspaceAppField.prototype.setValue = function (value) {
        this.formModel.patchValue(value, { emitEvent: false });
        this.formModel.markAsTouched();
    };
    LoginWorkspaceAppField.prototype.setEmptyValue = function () {
        this.value = [];
        return this.value;
    };
    LoginWorkspaceAppField.prototype.validate = function (form) {
        if (form.username && form.password) {
            jQuery('#loginPermissionModal').modal('show');
        }
        else {
            this.loginError = true;
        }
    };
    LoginWorkspaceAppField.prototype.allow = function (form) {
        var _this = this;
        //this.loginSubmitted.emit(userForm);
        jQuery('#loginPermissionModal').modal('hide');
        var formValues = {
            username: form.username,
            password: form.password
        };
        this.loading = true;
        this.omeroService.session(formValues).then(function (response) {
            _this.loading = false;
            if (!response.status) {
                if (!response.message) {
                    _this.displayLoginMessage({ error: true, value: _this.cannotLoginMessage });
                }
                else {
                    _this.displayLoginMessage({ error: true, value: response.message });
                }
                _this.loggedIn = false;
            }
            else {
                _this.displayLoginMessage({ error: false, value: '' });
                _this.listWorkspaces.emit();
            }
        });
    };
    LoginWorkspaceAppField.prototype.displayLoginMessage = function (message) {
        this.loginError = message.error;
        this.loginErrorMessage = message.value;
    };
    __decorate([
        Object(__WEBPACK_IMPORTED_MODULE_0__angular_core__["Output"])(),
        __metadata("design:type", __WEBPACK_IMPORTED_MODULE_0__angular_core__["EventEmitter"])
    ], LoginWorkspaceAppField.prototype, "listWorkspaces", void 0);
    return LoginWorkspaceAppField;
}(__WEBPACK_IMPORTED_MODULE_3__shared_form_field_base__["a" /* FieldBase */]));

/**
 * Component that log's in to a workspace app
 *
 */
var LoginWorkspaceAppComponent = /** @class */ (function (_super) {
    __extends(LoginWorkspaceAppComponent, _super);
    function LoginWorkspaceAppComponent() {
        return _super !== null && _super.apply(this, arguments) || this;
    }
    LoginWorkspaceAppComponent.prototype.ngOnInit = function () {
        this.field.registerEvents();
    };
    LoginWorkspaceAppComponent = __decorate([
        Object(__WEBPACK_IMPORTED_MODULE_0__angular_core__["Component"])({
            selector: 'ws-login',
            template: "\n    <div *ngIf=\"field.loading\" class=\"\">\n      <img class=\"center-block\" src=\"/images/loading.svg\">\n    </div>\n    <div *ngIf=\"!field.loggedIn && field.isLoaded && !field.loading\" class=\"padding-bottom-10\">\n      <div class=\"\">\n        <h4>{{ field.permissionStep }}</h4>\n        <form #form=\"ngForm\" novalidate autocomplete=\"off\">\n          <div class=\"form-group\">\n            <label>{{ field.usernameLabel }}</label>\n            <input type=\"text\" class=\"form-control\" name=\"username\" ngModel>\n          </div>\n          <div class=\"form-group\">\n            <label>{{ field.passwordLabel }}</label>\n            <input type=\"password\" class=\"form-control\" name=\"password\" ngModel>\n          </div>\n          <button (click)=\"field.validate(form.value)\" class=\"btn btn-primary\"\n                  type=\"submit\">{{ field.loginLabel }}\n          </button>\n          <div class=\"row\"><br/></div>\n          <div class=\"alert alert-danger\" *ngIf=\"field.loginError\">\n            {{field.loginErrorMessage}}\n          </div>\n        </form>\n      </div>\n      <div id=\"loginPermissionModal\" class=\"modal fade\">\n        <div class=\"modal-dialog\" role=\"document\">\n          <div class=\"modal-content\">\n            <div class=\"modal-header\">\n              <h4 class=\"modal-title\">{{ field.permissionLabel }}</h4>\n            </div>\n            <div class=\"modal-body\">\n              <p>{{ field.permissionStep }}</p>\n              <ul>\n                <li *ngFor=\"let permission of field.permissionList\">{{ permission }}</li>\n              </ul>\n            </div>\n            <div class=\"modal-footer\">\n              <button type=\"button\" class=\"btn btn-primary\" (click)=\"field.allow(form.value)\">{{ field.allowLabel }}\n              </button>\n              <button type=\"button\" class=\"btn btn-secondary\" data-dismiss=\"modal\">{{ field.closeLabel }}</button>\n            </div>\n          </div>\n        </div>\n      </div>\n    </div>\n  "
        })
    ], LoginWorkspaceAppComponent);
    return LoginWorkspaceAppComponent;
}(__WEBPACK_IMPORTED_MODULE_2__shared_form_field_simple_component__["l" /* SimpleComponent */]));



/***/ }),

/***/ "./src/app/components/shared.ts":
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "e", function() { return WorkspaceUser; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "a", function() { return Checks; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "b", function() { return Creation; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "c", function() { return CreationAlert; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "d", function() { return CurrentWorkspace; });
var WorkspaceUser = /** @class */ (function () {
    function WorkspaceUser() {
    }
    return WorkspaceUser;
}());

var Checks = /** @class */ (function () {
    function Checks() {
        this.link = undefined;
        this.rdmp = false;
        this.linkCreated = false;
        this.linkWithOther = false;
        this.master = false;
        this.comparing = false;
    }
    Checks.prototype.clear = function () {
        this.linkCreated = false;
        this.linkWithOther = false;
    };
    return Checks;
}());

var Creation = /** @class */ (function () {
    function Creation() {
        this.created = false;
        this.name = '';
        this.blank = true;
        this.description = '';
    }
    Creation.prototype.clear = function () {
        this.location = '';
        this.description = '';
        this.name = '';
        this.id = '';
    };
    Creation.prototype.nameHasSpaces = function () {
        return /\s/g.test(this.name);
    };
    return Creation;
}());

var CreationAlert = /** @class */ (function () {
    function CreationAlert() {
        this.message = '';
        this.className = 'danger';
        this.status = '';
    }
    CreationAlert.prototype.set = function (_a) {
        var message = _a.message, status = _a.status, className = _a.className;
        this.message = message;
        this.status = status;
        this.className = className;
    };
    CreationAlert.prototype.clear = function () {
        this.message = '';
        this.className = 'danger';
        this.status = '';
    };
    return CreationAlert;
}());

var CurrentWorkspace = /** @class */ (function () {
    function CurrentWorkspace() {
        this.path_with_namespace = '';
        this.web_url = '';
    }
    return CurrentWorkspace;
}());



/***/ }),

/***/ "./src/app/omero-form.component.ts":
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "a", function() { return OMEROFormComponent; });
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__angular_core__ = __webpack_require__("./node_modules/@angular/core/esm5/core.js");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1__angular_common__ = __webpack_require__("./node_modules/@angular/common/esm5/common.js");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2__shared_form_records_service__ = __webpack_require__("./redbox-portal/angular/shared/form/records.service.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3__omero_service__ = __webpack_require__("./src/app/omero.service.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4__shared_loadable_component__ = __webpack_require__("./redbox-portal/angular/shared/loadable.component.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5__shared_form_field_control_service__ = __webpack_require__("./redbox-portal/angular/shared/form/field-control.service.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_6__shared_translation_service__ = __webpack_require__("./redbox-portal/angular/shared/translation-service.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_7__components_login_workspaceapp_component__ = __webpack_require__("./src/app/components/login-workspaceapp.component.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_8__components_list_workspaces_component__ = __webpack_require__("./src/app/components/list-workspaces.component.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_9__components_linkmodal_workspace_component__ = __webpack_require__("./src/app/components/linkmodal-workspace.component.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_10__components_create_workspace_component__ = __webpack_require__("./src/app/components/create-workspace.component.ts");
var __extends = (this && this.__extends) || (function () {
    var extendStatics = Object.setPrototypeOf ||
        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||
        function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };
    return function (d, b) {
        extendStatics(d, b);
        function __() { this.constructor = d; }
        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
    };
})();
var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {
    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
    if (typeof Reflect === "object" && typeof Reflect.decorate === "function") r = Reflect.decorate(decorators, target, key, desc);
    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;
    return c > 3 && r && Object.defineProperty(target, key, r), r;
};
var __metadata = (this && this.__metadata) || function (k, v) {
    if (typeof Reflect === "object" && typeof Reflect.metadata === "function") return Reflect.metadata(k, v);
};
var __param = (this && this.__param) || function (paramIndex, decorator) {
    return function (target, key) { decorator(target, key, paramIndex); }
};











/**
* Main OMERO Edit component
*
* @author <a target='_' href='https://github.com/moisbo'>moisbo</a>
*
*/
var OMEROFormComponent = /** @class */ (function (_super) {
    __extends(OMEROFormComponent, _super);
    function OMEROFormComponent(elm, RecordsService, fcs, LocationService, OMEROService, translationService) {
        var _this = _super.call(this) || this;
        _this.RecordsService = RecordsService;
        _this.fcs = fcs;
        _this.LocationService = LocationService;
        _this.OMEROService = OMEROService;
        _this.translationService = translationService;
        /**
        * Fields for the form
        */
        _this.fields = [];
        _this.loading = false;
        _this.oid = elm.nativeElement.getAttribute('oid');
        _this.editMode = elm.nativeElement.getAttribute('editMode') == "true";
        _this.recordType = elm.nativeElement.getAttribute('recordType');
        _this.rdmp = elm.nativeElement.getAttribute('rdmp');
        //TODO: Find out what is this next line!
        _this.fieldMap = { _rootComp: _this };
        //TODO: do I have to wait for gitlabservice too?
        // this.initSubs = OMEROService.waitForInit((initStat:boolean) => {
        //   this.initSubs.unsubscribe();
        //   this.loadForm();
        // });
        _this.initSubs = RecordsService.waitForInit(function (initStat) {
            _this.initSubs.unsubscribe();
            _this.loadForm();
        });
        return _this;
    }
    OMEROFormComponent.prototype.registerEvents = function () {
        //this.fieldMap['ListWorkspaces'].field['setWorkspaceUser'].subscribe(this.setWorkspaceUser.bind(this));
    };
    OMEROFormComponent.prototype.loadForm = function () {
        var _this = this;
        this.fcs.addComponentClasses({
            'ListWorkspaceDataField': { 'meta': __WEBPACK_IMPORTED_MODULE_8__components_list_workspaces_component__["b" /* ListWorkspaceDataField */], 'comp': __WEBPACK_IMPORTED_MODULE_8__components_list_workspaces_component__["a" /* ListWorkspaceDataComponent */] },
            'LoginWorkspaceAppField': { 'meta': __WEBPACK_IMPORTED_MODULE_7__components_login_workspaceapp_component__["b" /* LoginWorkspaceAppField */], 'comp': __WEBPACK_IMPORTED_MODULE_7__components_login_workspaceapp_component__["a" /* LoginWorkspaceAppComponent */] },
            'LinkModalWorkspaceField': { 'meta': __WEBPACK_IMPORTED_MODULE_9__components_linkmodal_workspace_component__["b" /* LinkModalWorkspaceField */], 'comp': __WEBPACK_IMPORTED_MODULE_9__components_linkmodal_workspace_component__["a" /* LinkModalWorkspaceComponent */] },
            'CreateWorkspaceField': { 'meta': __WEBPACK_IMPORTED_MODULE_10__components_create_workspace_component__["b" /* CreateWorkspaceField */], 'comp': __WEBPACK_IMPORTED_MODULE_10__components_create_workspace_component__["a" /* CreateWorkspaceComponent */] }
        });
        this.RecordsService.getForm(this.oid, this.recordType, this.editMode).then(function (obs) {
            obs.subscribe(function (form) {
                _this.formDef = form;
                if (_this.editMode) {
                    _this.cssClasses = _this.formDef.editCssClasses;
                }
                else {
                    _this.cssClasses = _this.formDef.viewCssClasses;
                }
                _this.loggedIn = false;
                if (form.fieldsMeta) {
                    _this.fields = form.fieldsMeta;
                    _this.rebuildForm();
                    _this.watchForChanges();
                    _this.registerEvents();
                    _this.fieldMap['BackToPlan'].field.value = _this.fieldMap['BackToPlan'].field.value + _this.rdmp;
                }
            });
        }).catch(function (err) {
            console.log("Error loading form...");
            console.log(err);
            if (err.status == false) {
                _this.criticalError = err.message;
            }
            _this.setLoading(false);
        });
    };
    /**
     * Rebuild the form message.
     *
     * @return {[type]}
     */
    OMEROFormComponent.prototype.rebuildForm = function () {
        this.form = this.fcs.toFormGroup(this.fields, this.fieldMap);
    };
    /**
     * Enable form change monitor.
     *
     * @return {[type]}
     */
    OMEROFormComponent.prototype.watchForChanges = function () {
        this.setLoading(false);
        if (this.editMode) {
            this.form.valueChanges.subscribe(function (data) {
                //this.needsSave = true;
            });
        }
    };
    OMEROFormComponent.prototype.setWorkspaceUser = function (workspaceUser) {
        this.workspaceUser = workspaceUser;
    };
    __decorate([
        Object(__WEBPACK_IMPORTED_MODULE_0__angular_core__["Input"])(),
        __metadata("design:type", String)
    ], OMEROFormComponent.prototype, "oid", void 0);
    __decorate([
        Object(__WEBPACK_IMPORTED_MODULE_0__angular_core__["Input"])(),
        __metadata("design:type", Boolean)
    ], OMEROFormComponent.prototype, "editMode", void 0);
    __decorate([
        Object(__WEBPACK_IMPORTED_MODULE_0__angular_core__["Input"])(),
        __metadata("design:type", String)
    ], OMEROFormComponent.prototype, "recordType", void 0);
    OMEROFormComponent = __decorate([
        Object(__WEBPACK_IMPORTED_MODULE_0__angular_core__["Component"])({
            moduleId: module.i,
            selector: 'omero-form',
            template: __webpack_require__("./src/app/omero-form.html"),
            providers: [__WEBPACK_IMPORTED_MODULE_1__angular_common__["c" /* Location */], { provide: __WEBPACK_IMPORTED_MODULE_1__angular_common__["d" /* LocationStrategy */], useClass: __WEBPACK_IMPORTED_MODULE_1__angular_common__["e" /* PathLocationStrategy */] }]
        }),
        __param(1, Object(__WEBPACK_IMPORTED_MODULE_0__angular_core__["Inject"])(__WEBPACK_IMPORTED_MODULE_2__shared_form_records_service__["a" /* RecordsService */])),
        __param(2, Object(__WEBPACK_IMPORTED_MODULE_0__angular_core__["Inject"])(__WEBPACK_IMPORTED_MODULE_5__shared_form_field_control_service__["a" /* FieldControlService */])),
        __param(3, Object(__WEBPACK_IMPORTED_MODULE_0__angular_core__["Inject"])(__WEBPACK_IMPORTED_MODULE_1__angular_common__["c" /* Location */])),
        __param(4, Object(__WEBPACK_IMPORTED_MODULE_0__angular_core__["Inject"])(__WEBPACK_IMPORTED_MODULE_3__omero_service__["a" /* OMEROService */])),
        __metadata("design:paramtypes", [__WEBPACK_IMPORTED_MODULE_0__angular_core__["ElementRef"],
            __WEBPACK_IMPORTED_MODULE_2__shared_form_records_service__["a" /* RecordsService */],
            __WEBPACK_IMPORTED_MODULE_5__shared_form_field_control_service__["a" /* FieldControlService */],
            __WEBPACK_IMPORTED_MODULE_1__angular_common__["c" /* Location */],
            __WEBPACK_IMPORTED_MODULE_3__omero_service__["a" /* OMEROService */],
            __WEBPACK_IMPORTED_MODULE_6__shared_translation_service__["a" /* TranslationService */]])
    ], OMEROFormComponent);
    return OMEROFormComponent;
}(__WEBPACK_IMPORTED_MODULE_4__shared_loadable_component__["a" /* LoadableComponent */]));



/***/ }),

/***/ "./src/app/omero-form.html":
/***/ (function(module, exports) {

module.exports = "<div *ngIf=\"!criticalError\" class=\"row\">\n  <div class=\"col-xs-1\"></div>\n  <div class=\"col-xs-10\">\n    <ws-field *ngFor=\"let field of fields\" [field]=\"field\"\n      [form]=\"form\" class=\"form-row\" [fieldMap]=\"fieldMap\">\n    </ws-field>\n  </div>\n</div>\n<div *ngIf=\"criticalError\" class=\"row\">\n  <div class=\"col-xs-2\"></div>\n  <div class=\"col-xs-8\">\n    <div class=\"panel panel-danger\">\n      <div class=\"panel-heading\">\n        <h3 class=\"panel-title\">Error</h3>\n      </div>\n      <div class=\"panel-body\">\n        <code>\n          {{criticalError}}\n        </code>\n      </div>\n    </div>\n  </div>\n  <div class=\"col-xs-2\"></div>\n</div>\n"

/***/ }),

/***/ "./src/app/omero.module.ts":
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "a", function() { return OMEROModule; });
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__angular_core__ = __webpack_require__("./node_modules/@angular/core/esm5/core.js");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1__angular_platform_browser__ = __webpack_require__("./node_modules/@angular/platform-browser/esm5/platform-browser.js");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2__angular_forms__ = __webpack_require__("./node_modules/@angular/forms/esm5/forms.js");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3__angular_http__ = __webpack_require__("./node_modules/@angular/http/esm5/http.js");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4__omero_form_component__ = __webpack_require__("./src/app/omero-form.component.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5__omero_service__ = __webpack_require__("./src/app/omero.service.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_6__shared_shared_module__ = __webpack_require__("./redbox-portal/angular/shared/shared.module.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_7_ngx_bootstrap_pagination__ = __webpack_require__("./node_modules/ngx-bootstrap/pagination/index.js");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_8__components_login_workspaceapp_component__ = __webpack_require__("./src/app/components/login-workspaceapp.component.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_9__components_list_workspaces_component__ = __webpack_require__("./src/app/components/list-workspaces.component.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_10__components_linkmodal_workspace_component__ = __webpack_require__("./src/app/components/linkmodal-workspace.component.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_11__components_create_workspace_component__ = __webpack_require__("./src/app/components/create-workspace.component.ts");
var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {
    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
    if (typeof Reflect === "object" && typeof Reflect.decorate === "function") r = Reflect.decorate(decorators, target, key, desc);
    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;
    return c > 3 && r && Object.defineProperty(target, key, r), r;
};












var OMEROModule = /** @class */ (function () {
    function OMEROModule() {
    }
    OMEROModule = __decorate([
        Object(__WEBPACK_IMPORTED_MODULE_0__angular_core__["NgModule"])({
            imports: [__WEBPACK_IMPORTED_MODULE_1__angular_platform_browser__["a" /* BrowserModule */], __WEBPACK_IMPORTED_MODULE_3__angular_http__["c" /* HttpModule */], __WEBPACK_IMPORTED_MODULE_2__angular_forms__["h" /* ReactiveFormsModule */],
                __WEBPACK_IMPORTED_MODULE_6__shared_shared_module__["a" /* SharedModule */], __WEBPACK_IMPORTED_MODULE_2__angular_forms__["d" /* FormsModule */], __WEBPACK_IMPORTED_MODULE_7_ngx_bootstrap_pagination__["a" /* PaginationModule */].forRoot()
            ],
            declarations: [__WEBPACK_IMPORTED_MODULE_4__omero_form_component__["a" /* OMEROFormComponent */],
                __WEBPACK_IMPORTED_MODULE_9__components_list_workspaces_component__["a" /* ListWorkspaceDataComponent */], __WEBPACK_IMPORTED_MODULE_8__components_login_workspaceapp_component__["a" /* LoginWorkspaceAppComponent */],
                __WEBPACK_IMPORTED_MODULE_10__components_linkmodal_workspace_component__["a" /* LinkModalWorkspaceComponent */], __WEBPACK_IMPORTED_MODULE_11__components_create_workspace_component__["a" /* CreateWorkspaceComponent */]
            ],
            exports: [],
            providers: [__WEBPACK_IMPORTED_MODULE_5__omero_service__["a" /* OMEROService */]],
            bootstrap: [__WEBPACK_IMPORTED_MODULE_4__omero_form_component__["a" /* OMEROFormComponent */]],
            entryComponents: [__WEBPACK_IMPORTED_MODULE_8__components_login_workspaceapp_component__["a" /* LoginWorkspaceAppComponent */],
                __WEBPACK_IMPORTED_MODULE_9__components_list_workspaces_component__["a" /* ListWorkspaceDataComponent */], __WEBPACK_IMPORTED_MODULE_10__components_linkmodal_workspace_component__["a" /* LinkModalWorkspaceComponent */],
                __WEBPACK_IMPORTED_MODULE_11__components_create_workspace_component__["a" /* CreateWorkspaceComponent */]
            ]
        })
    ], OMEROModule);
    return OMEROModule;
}());



/***/ }),

/***/ "./src/app/omero.service.ts":
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "a", function() { return OMEROService; });
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__angular_core__ = __webpack_require__("./node_modules/@angular/core/esm5/core.js");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_rxjs_Subject__ = __webpack_require__("./node_modules/rxjs/_esm5/Subject.js");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2__angular_http__ = __webpack_require__("./node_modules/@angular/http/esm5/http.js");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_rxjs_add_operator_toPromise__ = __webpack_require__("./node_modules/rxjs/_esm5/add/operator/toPromise.js");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_rxjs_add_operator_toPromise___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_3_rxjs_add_operator_toPromise__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_rxjs_add_operator_delay__ = __webpack_require__("./node_modules/rxjs/_esm5/add/operator/delay.js");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5__shared_base_service__ = __webpack_require__("./redbox-portal/angular/shared/base-service.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_6__shared_config_service__ = __webpack_require__("./redbox-portal/angular/shared/config-service.ts");
var __extends = (this && this.__extends) || (function () {
    var extendStatics = Object.setPrototypeOf ||
        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||
        function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };
    return function (d, b) {
        extendStatics(d, b);
        function __() { this.constructor = d; }
        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
    };
})();
var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {
    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
    if (typeof Reflect === "object" && typeof Reflect.decorate === "function") r = Reflect.decorate(decorators, target, key, desc);
    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;
    return c > 3 && r && Object.defineProperty(target, key, r), r;
};
var __metadata = (this && this.__metadata) || function (k, v) {
    if (typeof Reflect === "object" && typeof Reflect.metadata === "function") return Reflect.metadata(k, v);
};
var __param = (this && this.__param) || function (paramIndex, decorator) {
    return function (target, key) { decorator(target, key, paramIndex); }
};







var OMEROService = /** @class */ (function (_super) {
    __extends(OMEROService, _super);
    function OMEROService(http, configService) {
        var _this = _super.call(this, http, configService) || this;
        _this.configService = configService;
        _this.recordURL = _this.brandingAndPortalUrl + '/record/view';
        _this.initSubject = new __WEBPACK_IMPORTED_MODULE_1_rxjs_Subject__["a" /* Subject */]();
        _this.emitInit();
        return _this;
    }
    OMEROService.prototype.waitForInit = function (handler) {
        var subs = this.initSubject.subscribe(handler);
        this.emitInit();
        return subs;
    };
    OMEROService.prototype.emitInit = function () {
        if (this.brandingAndPortalUrl) {
            this.initSubject.next('');
        }
    };
    OMEROService.prototype.session = function (login) {
        var _this = this;
        var wsUrl = this.brandingAndPortalUrl + '/ws/omero/login';
        return this.http.post(wsUrl, { username: login.username, password: login.password }, this.options)
            .toPromise()
            .then(function (res) {
            return _this.extractData(res);
        })
            .catch(function (res) {
            return _this.extractData(res);
        });
    };
    OMEROService.prototype.projects = function (limit, offset) {
        var _this = this;
        var wsUrl = this.brandingAndPortalUrl + "/ws/omero/projects/" + limit + "/" + offset;
        return this.http.get(wsUrl, this.options)
            .toPromise()
            .then(function (res) {
            return _this.extractData(res);
        })
            .catch(function (res) {
            return _this.extractData(res);
        });
    };
    OMEROService.prototype.createWorkspace = function (creation) {
        var _this = this;
        var wsUrl = this.brandingAndPortalUrl + '/ws/omero/create';
        return this.http.post(wsUrl, { creation: creation }, this.options)
            .toPromise()
            .then(function (res) {
            return _this.extractData(res);
        })
            .catch(function (res) {
            return _this.extractData(res);
        });
    };
    OMEROService.prototype.link = function (_a) {
        var _this = this;
        var rdmp = _a.rdmp, project = _a.project, recordMap = _a.recordMap;
        var wsUrl = this.brandingAndPortalUrl + '/ws/omero/link';
        return this.http.post(wsUrl, { rdmp: rdmp, project: project, recordMap: recordMap }, this.options)
            .toPromise()
            .then(function (res) {
            return _this.extractData(res);
        })
            .catch(function (res) {
            return _this.extractData(res);
        });
    };
    OMEROService.prototype.checkLink = function (_a) {
        var _this = this;
        var rdmpId = _a.rdmpId, omeroId = _a.omeroId;
        var wsUrl = this.brandingAndPortalUrl + '/ws/omero/checkLink';
        return this.http.post(wsUrl, { rdmpId: rdmpId, omeroId: omeroId }, this.options)
            .delay(500)
            .toPromise()
            .then(function (res) {
            return _this.extractData(res);
        })
            .catch(function (res) {
            return _this.extractData(res);
        });
    };
    OMEROService = __decorate([
        Object(__WEBPACK_IMPORTED_MODULE_0__angular_core__["Injectable"])(),
        __param(0, Object(__WEBPACK_IMPORTED_MODULE_0__angular_core__["Inject"])(__WEBPACK_IMPORTED_MODULE_2__angular_http__["b" /* Http */])),
        __param(1, Object(__WEBPACK_IMPORTED_MODULE_0__angular_core__["Inject"])(__WEBPACK_IMPORTED_MODULE_6__shared_config_service__["a" /* ConfigService */])),
        __metadata("design:paramtypes", [__WEBPACK_IMPORTED_MODULE_2__angular_http__["b" /* Http */],
            __WEBPACK_IMPORTED_MODULE_6__shared_config_service__["a" /* ConfigService */]])
    ], OMEROService);
    return OMEROService;
}(__WEBPACK_IMPORTED_MODULE_5__shared_base_service__["a" /* BaseService */]));



/***/ }),

/***/ "./src/environments/environment.ts":
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "a", function() { return environment; });
// The file contents for the current environment will overwrite these during build.
// The build system defaults to the dev environment which uses `environment.ts`, but if you do
// `ng build --env=prod` then `environment.prod.ts` will be used instead.
// The list of which env maps to which file can be found in `.angular-cli.json`.
var environment = {
    production: false
};


/***/ }),

/***/ "./src/main.ts":
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
Object.defineProperty(__webpack_exports__, "__esModule", { value: true });
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__angular_core__ = __webpack_require__("./node_modules/@angular/core/esm5/core.js");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1__angular_platform_browser_dynamic__ = __webpack_require__("./node_modules/@angular/platform-browser-dynamic/esm5/platform-browser-dynamic.js");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2__app_omero_module__ = __webpack_require__("./src/app/omero.module.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3__environments_environment__ = __webpack_require__("./src/environments/environment.ts");




if (__WEBPACK_IMPORTED_MODULE_3__environments_environment__["a" /* environment */].production) {
    Object(__WEBPACK_IMPORTED_MODULE_0__angular_core__["enableProdMode"])();
}
Object(__WEBPACK_IMPORTED_MODULE_1__angular_platform_browser_dynamic__["a" /* platformBrowserDynamic */])().bootstrapModule(__WEBPACK_IMPORTED_MODULE_2__app_omero_module__["a" /* OMEROModule */]);


/***/ }),

/***/ 0:
/***/ (function(module, exports, __webpack_require__) {

module.exports = __webpack_require__("./src/main.ts");


/***/ }),

/***/ 1:
/***/ (function(module, exports) {

/* (ignored) */

/***/ })

},[0]);
//# sourceMappingURL=main.bundle.js.map